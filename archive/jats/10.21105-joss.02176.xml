<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">2176</article-id>
<article-id pub-id-type="doi">10.21105/joss.02176</article-id>
<title-group>
<article-title>PorousFlow: a multiphysics simulation code for coupled
problems in porous media</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0001-6472-9560</contrib-id>
<string-name>Andy Wilkins</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-7315-6597</contrib-id>
<string-name>Christopher P. Green</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-4016-390X</contrib-id>
<string-name>Jonathan Ennis-King</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>CSIRO (Commonwealth Scientific and Industrial Research
Organisation)</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2020-02-13">
<day>13</day>
<month>2</month>
<year>2020</year>
</pub-date>
<volume>5</volume>
<issue>55</issue>
<fpage>2176</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2021</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>porous flow</kwd>
<kwd>multiphysics</kwd>
<kwd>THMC</kwd>
<kwd>Darcy flow</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary-and-applications">
  <title>Summary and applications</title>
  <p><monospace>PorousFlow</monospace> enables simulation of transport
  and flow in porous media. These are important in many practical fields
  of research. For instance, <monospace>PorousFlow</monospace> has been
  used in the following applications.</p>
  <list list-type="bullet">
    <list-item>
      <p>Groundwater studies
      (<xref alt="Crosbie et al., 2017" rid="ref-crosbie" ref-type="bibr">Crosbie
      et al., 2017</xref>;
      <xref alt="Herron et al., 2018" rid="ref-herron" ref-type="bibr">Herron
      et al., 2018</xref>). This often involves assessing the impacts of
      human interventions on groundwater resources, and the consequences
      on the biosphere. It is frequently necessary to use large and
      complex models that include the effect of rainfall patterns,
      spatially and temporally varying evaporation and transpiration,
      seasonal river flows, realistic topography and hydrogeology, as
      well as human factors such as mines, water bores, dams, etc. In
      certain situations, such as assessing the impact of mining on
      groundwater, it is vital that the model includes the deformation
      of the porous material (the rock) since this greatly impacts
      groundwater flow. In other situations, it is useful to be able to
      track the transport of tracers and pollutants through the system,
      or to model the unsaturated (vadose) zone, where air and
      groundwater coexist in the subsurface.</p>
    </list-item>
    <list-item>
      <p>Geothermal modelling: the simulation of natural and man-made
      geothermal systems, typically in order to quantify heat energies
      that may be extracted
      (<xref alt="Birdsell &amp; Saar, 2020" rid="ref-birdsall" ref-type="bibr">Birdsell
      &amp; Saar, 2020</xref>;
      <xref alt="Guglielmetti et al., 2020" rid="ref-guglielmetti" ref-type="bibr">Guglielmetti
      et al., 2020</xref>;
      <xref alt="Lima et al., 2019" rid="ref-lima" ref-type="bibr">Lima
      et al., 2019</xref>;
      <xref alt="Niederau et al., 2020" rid="ref-niederau" ref-type="bibr">Niederau
      et al., 2020</xref>). Models in this field involve the coupled
      transport of heat and fluid. Many models are often large-scale,
      but some focus on small regions close to wellbores to investigate
      wellbore integrity. In this field, it often is useful to assess
      the impacts of subsurface heterogeneity, realistic pumping
      regimes, geochemical effects, fracture flow, and the creation of
      new fractures through deliberate or unintentional hydrofracturing,
      as well as potential microseismicity.</p>
    </list-item>
    <list-item>
      <p>Multiphase modelling, such as the simulation of
      CO<inline-formula><alternatives>
      <tex-math><![CDATA[_{2}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi></mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
      sequestration
      (<xref alt="Green et al., 2018" rid="ref-green2018" ref-type="bibr">Green
      et al., 2018</xref>;
      <xref alt="Lima et al., 2019" rid="ref-lima" ref-type="bibr">Lima
      et al., 2019</xref>), H<inline-formula><alternatives>
      <tex-math><![CDATA[_{2}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi></mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
      storage, or methane flows around coal mines
      (<xref alt="Qu, Wilkins, et al., 2019" rid="ref-c26050" ref-type="bibr">Qu,
      Wilkins, et al., 2019</xref>;
      <xref alt="Qu, Balusu, et al., 2019" rid="ref-c25065" ref-type="bibr">Qu,
      Balusu, et al., 2019</xref>). These simulations involve the
      interaction and flow of at least two fluid phases (e.g.Â gas and
      water). Changes in temperature often impact these flows, and
      realistic equations of state for the fluids involved are
      necessary. For instance, CO<inline-formula><alternatives>
      <tex-math><![CDATA[_{2}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi></mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
      sequestration typically involves pumping high-pressure, cold
      CO<inline-formula><alternatives>
      <tex-math><![CDATA[_{2}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi></mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
      into a warmer aquifer filled with brine: the
      CO<inline-formula><alternatives>
      <tex-math><![CDATA[_{2}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi></mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
      dissolves into the brine, cooling it and changing its density and
      flow characteristics. In many of these models, the altered
      pressure and temperature can potentially cause mechanical failure
      of the subsurface, and hence the creation of new flow paths and
      microseismicity
      (<xref alt="Lima et al., 2019" rid="ref-lima" ref-type="bibr">Lima
      et al., 2019</xref>).</p>
    </list-item>
    <list-item>
      <p>Understanding mineralization
      (<xref alt="Schaubs et al., 2019" rid="ref-heather" ref-type="bibr">Schaubs
      et al., 2019</xref>) in the subsurface often involves fluid flow,
      heat flow and coupled 3D deformation, simulating over millennia of
      real time and using realistic, and therefore complicated,
      basin-scale geology.</p>
    </list-item>
  </list>
  <p>Other situations where <monospace>PorousFlow</monospace> could be
  used include oil and gas production, nuclear waste repositories and
  chemical leaching.</p>
  <p>In many of these cases it is not enough to only solve traditional
  flow and transport physics. Coupling with other physics is necessary:
  solid mechanical deformations and stresses can be important;
  geochemistry can alter the flow characteristics of the subsurface;
  high-precision equations of state are required; the evolution of fluid
  components (tracers, pollutants, reactants) is of interest;
  unsaturated physics is crucial. The flow and transport often impacts
  the subsurface structure, and conversely, the effects of these
  structure-changes impact the flow and transport.</p>
  <p>Simulating these situations can be challenging in practice. Many
  widely-used simulation codes typically focus on only a subset of
  physical processes, and therefore accurate modelling often requires
  the use of several loosely-coupled software packages. Such an approach
  can be useful in many problems of interest, particularly where the
  characteristic time scales for each physical process are sufficiently
  different. In other instances, however, the ability to tightly couple
  different physical processes is necessary due to comparable
  characteristic time scales for the different physical processes.
  <monospace>PorousFlow</monospace> allows simulation of all the
  relevant thermal-hydraulic-mechanical-chemical (THMC) physical
  phenomenon in a tightly-coupled framework.</p>
</sec>
<sec id="core-equations">
  <title>Core equations</title>
  <p>The core equations solved by <monospace>PorousFlow</monospace> are
  fluid mass conservation, heat-energy conservation and conservation of
  solid-mechanical momentum.</p>
  <p>Fluid mass conservation for fluid species
  <inline-formula><alternatives>
  <tex-math><![CDATA[\kappa]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Îº</mml:mi></mml:math></alternatives></inline-formula>
  reads <disp-formula><alternatives>
  <tex-math><![CDATA[0 = \frac{\partial M^{\kappa}}{\partial t} + M^{\kappa}\nabla\cdot{\mathbf
    v}_{s} + \nabla\cdot \mathbf{F}^{\kappa} + \Lambda M^{\kappa} - \phi I_{\mathrm{chem}} - q^{\kappa} \ .]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>â</mml:mi><mml:msup><mml:mi>M</mml:mi><mml:mi>Îº</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>â</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msup><mml:mi>M</mml:mi><mml:mi>Îº</mml:mi></mml:msup><mml:mi>â</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>ð¯</mml:mi></mml:mstyle><mml:mi>s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>â</mml:mi><mml:mo>â</mml:mo><mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ð</mml:mi></mml:mstyle><mml:mi>Îº</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:mi>Î</mml:mi><mml:msup><mml:mi>M</mml:mi><mml:mi>Îº</mml:mi></mml:msup><mml:mo>â</mml:mo><mml:mi>Ï</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mstyle></mml:msub><mml:mo>â</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mi>Îº</mml:mi></mml:msup><mml:mspace width="0.222em"></mml:mspace><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula>
  Here <inline-formula><alternatives>
  <tex-math><![CDATA[t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>
  denotes time and <inline-formula><alternatives>
  <tex-math><![CDATA[\nabla]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>â</mml:mi></mml:math></alternatives></inline-formula>
  is a vector of spatial derivatives; <inline-formula><alternatives>
  <tex-math><![CDATA[M]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>M</mml:mi></mml:math></alternatives></inline-formula>
  is the mass of fluid per bulk volume (which involves a sum over all
  fluid phases present in the system); <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{v}_{s}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>ð¯</mml:mi></mml:mstyle><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is the velocity of the porous solid skeleton (so the second term
  ensures mass conservation under an evolving skeleton);
  <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{F}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mstyle mathvariant="bold"><mml:mi>ð</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula>
  is the fluid flux vector (that includes advection by Darcyâs law as
  well as diffusion and hydrodynamic dispersion);
  <inline-formula><alternatives>
  <tex-math><![CDATA[\Lambda]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Î</mml:mi></mml:math></alternatives></inline-formula>
  is a radioactive decay rate; <inline-formula><alternatives>
  <tex-math><![CDATA[\phi I_{\mathrm{chem}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Ï</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mstyle></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
  represents chemical precipitation or dissolution
  (<inline-formula><alternatives>
  <tex-math><![CDATA[\phi]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Ï</mml:mi></mml:math></alternatives></inline-formula>
  is the porosity); and <inline-formula><alternatives>
  <tex-math><![CDATA[q]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>
  is a source.</p>
  <p>Heat-energy conservation reads <disp-formula><alternatives>
  <tex-math><![CDATA[0 = \frac{\partial\mathcal{E}}{\partial t} + \mathcal{E}\nabla\cdot{\mathbf
    v}_{s} + \nabla\cdot \mathbf{F}^{T} -
  \nu
    (1-\phi)\sigma^{\mathrm{eff}}_{ij}\frac{\partial}{\partial
      t}\epsilon_{ij}^{\mathrm{plastic}}
   - q^{T} \ .]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>â</mml:mi><mml:mstyle mathvariant="script"><mml:mi>â°</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>â</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mstyle mathvariant="script"><mml:mi>â°</mml:mi></mml:mstyle><mml:mi>â</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>ð¯</mml:mi></mml:mstyle><mml:mi>s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>â</mml:mi><mml:mo>â</mml:mo><mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ð</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mo>â</mml:mo><mml:mi>Î½</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>â</mml:mo><mml:mi>Ï</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>Ï</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi></mml:mstyle></mml:msubsup><mml:mfrac><mml:mi>â</mml:mi><mml:mrow><mml:mi>â</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mi>Ïµ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:mstyle></mml:msubsup><mml:mo>â</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mspace width="0.222em"></mml:mspace><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula>
  Here <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{E}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mstyle mathvariant="script"><mml:mi>â°</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula>
  is the heat energy per unit volume in the rock-fluid system (which
  involves the porous skeletonâs heat energy as well as the fluidsâ heat
  energy, accounting for their saturations);
  <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{F}^{T}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ð</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup></mml:math></alternatives></inline-formula>
  is the heat flux (which involves heat conduction and advection by the
  fluid); <inline-formula><alternatives>
  <tex-math><![CDATA[\nu]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Î½</mml:mi></mml:math></alternatives></inline-formula>
  describes the ratio of plastic-deformation energy that gets
  transferred to heat energy during plastic deformation of the solid
  skeleton, <inline-formula><alternatives>
  <tex-math><![CDATA[\sigma^{\mathrm{eff}}_{ij}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>Ï</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi></mml:mstyle></mml:msubsup></mml:math></alternatives></inline-formula>
  is the effective stress, <inline-formula><alternatives>
  <tex-math><![CDATA[\epsilon_{ij}^{\mathrm{plastic}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>Ïµ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:mstyle></mml:msubsup></mml:math></alternatives></inline-formula>
  is the plastic strain, and <inline-formula><alternatives>
  <tex-math><![CDATA[q^{T}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>q</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:math></alternatives></inline-formula>
  is a heat source.</p>
  <p>Conservation of momentum reads <disp-formula><alternatives>
  <tex-math><![CDATA[\rho_{\mathrm{mat}}\frac{\partial v_{s}^{j}}{\partial t} =
  \nabla_{i}\sigma_{ij}^{\mathrm{eff}} - \alpha_{B}\nabla_{j} P_{f} + \rho_{\mathrm{mat}}b_{j} \ .]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>Ï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mstyle></mml:msub><mml:mfrac><mml:mrow><mml:mi>â</mml:mi><mml:msubsup><mml:mi>v</mml:mi><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi>â</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>â</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>Ï</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi></mml:mstyle></mml:msubsup><mml:mo>â</mml:mo><mml:msub><mml:mi>Î±</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:msub><mml:mi>â</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Ï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mstyle></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mspace width="0.222em"></mml:mspace><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula>
  Here <inline-formula><alternatives>
  <tex-math><![CDATA[i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
  are spatial indices; <inline-formula><alternatives>
  <tex-math><![CDATA[v_{s}^{j}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>
  is the <inline-formula><alternatives>
  <tex-math><![CDATA[j^{\mathrm{th}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>j</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mstyle></mml:msup></mml:math></alternatives></inline-formula>
  component of the velocity <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{v}_{s}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>ð¯</mml:mi></mml:mstyle><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>;
  <inline-formula><alternatives>
  <tex-math><![CDATA[\rho_{\mathrm{mat}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>Ï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mstyle></mml:msub></mml:math></alternatives></inline-formula>
  is the mass-density of the material (including solid and fluid
  contributions); and <inline-formula><alternatives>
  <tex-math><![CDATA[b_{j}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  are the components of the external force density (for example, the
  gravitational acceleration). The effective stress
  <inline-formula><alternatives>
  <tex-math><![CDATA[\sigma^{\mathrm{eff}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>Ï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi></mml:mstyle></mml:msup></mml:math></alternatives></inline-formula>
  obeys a constitutive equation, <inline-formula><alternatives>
  <tex-math><![CDATA[\alpha_{B}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>Î±</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is the Biot coefficient, and <inline-formula><alternatives>
  <tex-math><![CDATA[P_{f}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>P</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  an effective fluid porepressure.</p>
  <p>A comprehensive listing of equations, including fluid equations of
  state, the evolution of porosity and permeability,
  relative-permeability functions, capillary relationships, chemical
  reactions, etc, may be found at
  https://mooseframework.org/modules/porous_flow/index.html.</p>
</sec>
<sec id="software-details-and-comparisons">
  <title>Software details and comparisons</title>
  <p><monospace>PorousFlow</monospace> is built upon the open-source,
  massively parallel, fully implicit multiphysics simulation framework
  MOOSE (Multiphysics Object-Oriented Simulation Environment)
  (<xref alt="Permann et al., 2020" rid="ref-permann2020moose" ref-type="bibr">Permann
  et al., 2020</xref>). MOOSE is an open-source library from Idaho
  National Laboratory that provides a high-level interface to the
  libMesh finite element library
  (<xref alt="Kirk et al., 2006" rid="ref-libmesh" ref-type="bibr">Kirk
  et al., 2006</xref>) and PETSc nonlinear solvers
  (<xref alt="Balay et al., 2019" rid="ref-petsc" ref-type="bibr">Balay
  et al., 2019</xref>). MOOSE and <monospace>PorousFlow</monospace>
  follow
  <ext-link ext-link-type="uri" xlink:href="https://mooseframework.org/sqa/index.html">strict
  quality controls</ext-link>.</p>
  <p>Other open-source codes that can also perform tightly-coupled THMC
  simulations to some degree include OpenGeoSys
  (<xref alt="Kolditz et al., 2012" rid="ref-opengeosys" ref-type="bibr">Kolditz
  et al., 2012</xref>), PFLOTRAN
  (<xref alt="Lichtner et al., 2019" rid="ref-pflotran" ref-type="bibr">Lichtner
  et al., 2019</xref>) and work under the Open Porous Media initiative
  (<xref alt="Open Porous Media: http://www.opm-project.org, 2019" rid="ref-opm" ref-type="bibr"><italic><named-content content-type="nocase">Open
  Porous Media: http://www.opm-project.org</named-content></italic>,
  2019</xref>).</p>
  <p>One aspect that makes <monospace>PorousFlow</monospace> different
  to these codes is the ease of coupling additional physics to the base
  flow and transport capabilities, and the relative speed and simplicity
  of developing new capability using the APIs provided by MOOSE.
  Harnessing the power of MOOSE means that
  <monospace>PorousFlow</monospace> simulations efficiently use
  multiprocessors and automatically utilize threading/OpenMP, without
  developers or users having to worry about the software technicalities.
  From the userâs perspective, mesh adaptivity with a variety of
  integration schemes and unstructured meshes may be used. Various
  time-stepping schemes may be employed. A variety of I/O formats are
  available, such as Exodus and VTK files as well as CSV plaintext.
  Users may utilize the âMultiAppâ system that allows simulations to be
  embedded inside other simulations. A GUI helps users create, run and
  analyse models. An example <monospace>PorousFlow</monospace> result is
  shown in
  <xref alt="FigureÂ 1" rid="figU003Aexample">FigureÂ 1</xref>.</p>
  <fig>
    <caption><p>As CO<inline-formula><alternatives>
    <tex-math><![CDATA[_{2}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi></mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
    dissolves into brine, the brineâs density increases, resulting in
    beautiful density-driven convective flows that resemble a âlava
    lampâ. The top figure shows the initial condition with
    CO<inline-formula><alternatives>
    <tex-math><![CDATA[_{2}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi></mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
    injected at the top of a brine-filled reservoir. The lower figures
    show the CO<inline-formula><alternatives>
    <tex-math><![CDATA[_{2}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi></mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
    concentration as time
    evolves.<styled-content id="figU003Aexample"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="paper.png" xlink:title="" />
  </fig>
  <p>For convenience, the source code for
  <monospace>PorousFlow</monospace>,
  https://github.com/idaholab/moose/tree/master/modules/porous_flow, is
  bundled within the MOOSE framework, https://github.com/idaholab/moose,
  and detailed documentation found at
  https://mooseframework.org/modules/porous_flow/index.html.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>The authors wish to acknowledge other developers who have
  contributed to the <monospace>PorousFlow</monospace> module,
  especially Heather Sheldon and Philipp Schaedle. Funding for the
  development was obtained through CSIRO strategic funds, sourced by
  Jonathan Ennis-King, Deepak Adhikary and Qingdong Qu, as well as funds
  from the Idaho National Laboratory through Robert Podgorney. The
  authors thank the MOOSE framework team, past and present, for
  providing the MOOSE framework and auxiliary functionality (quality
  control, test harnesses, documentation scaffolds, build scripts,
  etc).</p>
</sec>
</body>
<back>
<ref-list>
  <ref-list>
    <ref id="ref-herron">
      <element-citation publication-type="report">
        <person-group person-group-type="author">
          <name><surname>Herron</surname><given-names>N. F.</given-names></name>
          <name><surname>Peeters</surname><given-names>L.</given-names></name>
          <name><surname>Crosbie</surname><given-names>R.</given-names></name>
          <name><surname>Marvanek</surname><given-names>S. P.</given-names></name>
          <name><surname>Pagendam</surname><given-names>D.</given-names></name>
          <name><surname>Ramage</surname><given-names>A.</given-names></name>
          <name><surname>Rachakonda</surname><given-names>P. K.</given-names></name>
          <name><surname>Wilkins</surname><given-names>A.</given-names></name>
        </person-group>
        <article-title>Groundwater numerical modelling for the Hunter subregion. Product 2.6.2 for the Hunter subregion from the Northern Sydney Basin Bioregional Assessment</article-title>
        <publisher-name>Department of the Environment; Energy, Bureau of Meteorology, CSIRO; Geoscience Australia, Canberra</publisher-name>
        <year iso-8601-date="2018">2018</year>
        <uri>http://data.bioregionalassessments.gov.au/product/NSB/HUN/2.6.2</uri>
      </element-citation>
    </ref>
    <ref id="ref-opengeosys">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Kolditz</surname><given-names>Olaf</given-names></name>
          <name><surname>Bauer</surname><given-names>Sebastian</given-names></name>
          <name><surname>Bilke</surname><given-names>Lars</given-names></name>
          <name><surname>BÃ¶ttcher</surname><given-names>Norbert</given-names></name>
          <name><surname>Delfs</surname><given-names>Jens-Olaf</given-names></name>
          <name><surname>Fischer</surname><given-names>Thomas</given-names></name>
          <name><surname>GÃ¶rke</surname><given-names>Uwe J</given-names></name>
          <name><surname>Kalbacher</surname><given-names>Thomas</given-names></name>
          <name><surname>Kosakowski</surname><given-names>Georg</given-names></name>
          <name><surname>McDermott</surname><given-names>CI</given-names></name>
          <string-name>others</string-name>
        </person-group>
        <article-title>OpenGeoSys: an open-source initiative for numerical simulation of thermo-hydro-mechanical/chemical (THM/C) processes in porous media</article-title>
        <source>Environ. Earth Sci.</source>
        <publisher-name>Springer</publisher-name>
        <year iso-8601-date="2012">2012</year>
        <volume>67</volume>
        <issue>2</issue>
        <pub-id pub-id-type="doi">10.1007/s12665-012-1546-x</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-pflotran">
      <element-citation publication-type="report">
        <person-group person-group-type="author">
          <name><surname>Lichtner</surname><given-names>Peter C.</given-names></name>
          <name><surname>Hammond</surname><given-names>Glenn E.</given-names></name>
          <name><surname>Lu</surname><given-names>Chuan</given-names></name>
          <name><surname>Karra</surname><given-names>Satish</given-names></name>
          <name><surname>Bisht</surname><given-names>Gautam</given-names></name>
          <name><surname>Andre</surname><given-names>Benjamin</given-names></name>
          <name><surname>Mills</surname><given-names>Richard T.</given-names></name>
          <name><surname>Kumar</surname><given-names>Jitendra</given-names></name>
          <name><surname>Frederick</surname><given-names>Jennifer M.</given-names></name>
        </person-group>
        <article-title>PFLOTRAN User Manual</article-title>
        <publisher-name>Sandia National Laboratories</publisher-name>
        <year iso-8601-date="2019">2019</year>
      </element-citation>
    </ref>
    <ref id="ref-opm">
      <element-citation>
        <article-title>Open Porous Media: http://www.opm-project.org</article-title>
        <year iso-8601-date="2019">2019</year>
        <uri>http://www.opm-project.org</uri>
      </element-citation>
    </ref>
    <ref id="ref-permann2020moose">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Permann</surname><given-names>Cody J.</given-names></name>
          <name><surname>Gaston</surname><given-names>Derek R.</given-names></name>
          <name><surname>AndrÅ¡</surname><given-names>David</given-names></name>
          <name><surname>Carlsen</surname><given-names>Robert W.</given-names></name>
          <name><surname>Kong</surname><given-names>Fande</given-names></name>
          <name><surname>Lindsay</surname><given-names>Alexander D.</given-names></name>
          <name><surname>Miller</surname><given-names>Jason M.</given-names></name>
          <name><surname>Peterson</surname><given-names>John W.</given-names></name>
          <name><surname>Slaughter</surname><given-names>Andrew E.</given-names></name>
          <name><surname>Stogner</surname><given-names>Roy H.</given-names></name>
          <name><surname>Martineau</surname><given-names>Richard C.</given-names></name>
        </person-group>
        <article-title>MOOSE: Enabling massively parallel multiphysics simulation</article-title>
        <source>SoftwareX</source>
        <year iso-8601-date="2020">2020</year>
        <volume>11</volume>
        <issn>2352-7110</issn>
        <uri>http://www.sciencedirect.com/science/article/pii/S2352711019302973</uri>
        <pub-id pub-id-type="doi">https://doi.org/10.1016/j.softx.2020.100430</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-libmesh">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Kirk</surname><given-names>Benjamin S</given-names></name>
          <name><surname>Peterson</surname><given-names>John W</given-names></name>
          <name><surname>Stogner</surname><given-names>Roy H</given-names></name>
          <name><surname>Carey</surname><given-names>Graham F</given-names></name>
        </person-group>
        <article-title>libMesh: a C++ library for parallel adaptive mesh refinement/coarsening simulations</article-title>
        <source>Eng. Comp.</source>
        <publisher-name>Springer</publisher-name>
        <year iso-8601-date="2006">2006</year>
        <volume>22</volume>
        <issue>3-4</issue>
        <pub-id pub-id-type="doi">10.1007/s00366-006-0049-3</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-petsc">
      <element-citation publication-type="report">
        <person-group person-group-type="author">
          <name><surname>Balay</surname><given-names>Satish</given-names></name>
          <name><surname>Abhyankar</surname><given-names>Shrirang</given-names></name>
          <name><surname>Adams</surname><given-names>Mark</given-names></name>
          <name><surname>Brown</surname><given-names>Jed</given-names></name>
          <name><surname>Brune</surname><given-names>Peter</given-names></name>
          <name><surname>Buschelman</surname><given-names>Kris</given-names></name>
          <name><surname>Dalcin</surname><given-names>LD</given-names></name>
          <name><surname>Eijkhout</surname><given-names>Victor</given-names></name>
          <name><surname>Gropp</surname><given-names>W</given-names></name>
          <name><surname>Kaushik</surname><given-names>Dinesh</given-names></name>
          <string-name>others</string-name>
        </person-group>
        <article-title>PETSc Users Manual</article-title>
        <publisher-name>Argonne National Lab. (ANL), Argonne, IL (United States)</publisher-name>
        <year iso-8601-date="2019">2019</year>
      </element-citation>
    </ref>
    <ref id="ref-c26050">
      <element-citation publication-type="report">
        <person-group person-group-type="author">
          <name><surname>Qu</surname><given-names>Qingdong</given-names></name>
          <name><surname>Wilkins</surname><given-names>Andy</given-names></name>
          <name><surname>Balusu</surname><given-names>Rao</given-names></name>
          <name><surname>Qin</surname><given-names>Johnny</given-names></name>
          <name><surname>Khanal</surname><given-names>Manoj</given-names></name>
        </person-group>
        <article-title>Floor seam gas emission characterisation and optimal drainage strategies for longwall mining</article-title>
        <publisher-name>CSIRO, ACARP project C26050</publisher-name>
        <year iso-8601-date="2019">2019</year>
        <uri>https://www.acarp.com.au/abstracts.aspx?repId=C26050</uri>
      </element-citation>
    </ref>
    <ref id="ref-c25065">
      <element-citation publication-type="report">
        <person-group person-group-type="author">
          <name><surname>Qu</surname><given-names>Qingdong</given-names></name>
          <name><surname>Balusu</surname><given-names>Rao</given-names></name>
          <name><surname>Wilkins</surname><given-names>Andy</given-names></name>
          <name><surname>Moreby</surname><given-names>Roy</given-names></name>
        </person-group>
        <article-title>Specific gas emission patterns from different coal seams</article-title>
        <publisher-name>CSIRO, ACARP project C25065</publisher-name>
        <year iso-8601-date="2019">2019</year>
        <uri>https://www.acarp.com.au/abstracts.aspx?repId=C25065</uri>
      </element-citation>
    </ref>
    <ref id="ref-green2018">
      <element-citation publication-type="paper-conference">
        <person-group person-group-type="author">
          <name><surname>Green</surname><given-names>Christopher P.</given-names></name>
          <name><surname>Ennis-King</surname><given-names>Jonathan</given-names></name>
          <name><surname>La Force</surname><given-names>Tara</given-names></name>
          <name><surname>Wilkins</surname><given-names>Andy</given-names></name>
        </person-group>
        <article-title>Community code for simulating CO_2 storage: Modelling multiphase flow with coupled geomechanics and geochemistry using the open-source multiphysics framework MOOSE</article-title>
        <source>14th Greenhouse Gas Control Technologies Conference Melbourne</source>
        <year iso-8601-date="2018">2018</year>
      </element-citation>
    </ref>
    <ref id="ref-birdsall">
      <element-citation publication-type="paper-conference">
        <person-group person-group-type="author">
          <name><surname>Birdsell</surname><given-names>Daniel T.</given-names></name>
          <name><surname>Saar</surname><given-names>Martin O.</given-names></name>
        </person-group>
        <article-title>Modeling ground surface deformation at the Swiss HEATSTORE underground thermal energy storage sites</article-title>
        <source>Proceedings World Geothermal Congress 2020, Reykjavik, Iceland April 26 â May 2, 2020</source>
        <year iso-8601-date="2020">2020</year>
      </element-citation>
    </ref>
    <ref id="ref-guglielmetti">
      <element-citation publication-type="paper-conference">
        <person-group person-group-type="author">
          <name><surname>Guglielmetti</surname><given-names>L.</given-names></name>
          <name><surname>Alt-Epping</surname><given-names>P.</given-names></name>
          <name><surname>Birdsell</surname><given-names>D.</given-names></name>
          <name><surname>Oliveira</surname><given-names>F. de</given-names></name>
          <name><surname>Diamond</surname><given-names>L.</given-names></name>
          <name><surname>Driesner</surname><given-names>T.</given-names></name>
          <name><surname>Eruteya</surname><given-names>O.</given-names></name>
          <name><surname>Hollmuller</surname><given-names>P. et al.</given-names></name>
          <name><surname>Saar</surname><given-names>M. O.</given-names></name>
        </person-group>
        <article-title>HEATSTORE Switzerland: New opportunities of geothermal district heating network sustainable growth by high temperature aquifer thermal energy storage development</article-title>
        <source>Proceedings World Geothermal Congress 2020, Reykjavik, Iceland April 26 â May 2, 2020</source>
        <year iso-8601-date="2020">2020</year>
      </element-citation>
    </ref>
    <ref id="ref-niederau">
      <element-citation publication-type="paper-conference">
        <person-group person-group-type="author">
          <name><surname>Niederau</surname><given-names>Jan</given-names></name>
          <name><surname>Ebigbo</surname><given-names>Anozie</given-names></name>
          <name><surname>Saar</surname><given-names>Martin O.</given-names></name>
        </person-group>
        <article-title>Characterization of subsurface heat-transport processes in the Canton of Aargau using an integrative workflow</article-title>
        <source>Proceedings World Geothermal Congress 2020, Reykjavik, Iceland April 26 â May 2, 2020</source>
        <year iso-8601-date="2020">2020</year>
      </element-citation>
    </ref>
    <ref id="ref-lima">
      <element-citation publication-type="paper-conference">
        <person-group person-group-type="author">
          <name><surname>Lima</surname><given-names>Marina</given-names></name>
          <name><surname>SchÃ¤dle</surname><given-names>Philipp</given-names></name>
          <name><surname>Vogler</surname><given-names>Daniel</given-names></name>
          <name><surname>Saar</surname><given-names>Martin</given-names></name>
          <name><surname>Kong</surname><given-names>Xiangzhao</given-names></name>
        </person-group>
        <article-title>Impact of effective normal stress on capillary pressure in a single natural fracture</article-title>
        <source>European Geothermal Congress, 11â14 June, 2019, The Hague, The Netherlands</source>
        <year iso-8601-date="2019-06">2019</year><month>06</month>
        <pub-id pub-id-type="doi">10.21203/rs.2.17644/v1</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-heather">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Schaubs</surname><given-names>Peter</given-names></name>
          <name><surname>Sheldon</surname><given-names>Heather</given-names></name>
          <name><surname>Blaikie</surname><given-names>Teagan</given-names></name>
          <name><surname>Kunzmann</surname><given-names>Marcus</given-names></name>
          <name><surname>Schmid</surname><given-names>Susanne</given-names></name>
          <name><surname>Spinks</surname><given-names>Sam</given-names></name>
        </person-group>
        <article-title>Basin-scale fluid-flow models of the McArthur River mineral system: Constraints from geochemistry, geophysics and sequence stratigraphy</article-title>
        <source>ASEG Extended Abstracts</source>
        <publisher-name>Taylor &amp; Francis</publisher-name>
        <year iso-8601-date="2019">2019</year>
        <volume>2019</volume>
        <issue>1</issue>
        <pub-id pub-id-type="doi">10.1080/22020586.2019.12073198</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-crosbie">
      <element-citation publication-type="paper-conference">
        <person-group person-group-type="author">
          <name><surname>Crosbie</surname></name>
          <name><surname>Peeters</surname></name>
          <name><surname>Janardhanan</surname></name>
          <name><surname>Cui</surname></name>
          <name><surname>Pickett</surname></name>
          <name><surname>Wilkins</surname></name>
          <name><surname>Dawes</surname></name>
          <name><surname>Post</surname></name>
        </person-group>
        <article-title>Lessons learned from modelling the changes in groundwater due to large coal mines and CSG in the Bioregional Assessments Programme</article-title>
        <source>Australasian Groundwater Conference 2017, Sydney, Australia, 11-13 July 2017. International Association of Hydrogeologists</source>
        <year iso-8601-date="2017">2017</year>
      </element-citation>
    </ref>
  </ref-list>
</ref-list>
</back>
</article>
