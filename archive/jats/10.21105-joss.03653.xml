<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">3653</article-id>
<article-id pub-id-type="doi">10.21105/joss.03653</article-id>
<title-group>
<article-title>SiSyPHE: A Python package for the Simulation of Systems
of interacting mean-field Particles with High Efficiency</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<string-name>Antoine Diez</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Mathematics, Imperial College London, South
Kensington Campus, London, SW7 2AZ, UK</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2021-06-27">
<day>27</day>
<month>6</month>
<year>2021</year>
</pub-date>
<volume>6</volume>
<issue>65</issue>
<fpage>3653</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2021</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>GPU</kwd>
<kwd>particles</kwd>
<kwd>mean-field</kwd>
<kwd>self-organization</kwd>
<kwd>swarming</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Over the past decades, the study of systems of particles has become
  an important part of many research areas, from theoretical physics to
  applied biology and computational mathematics. One of the main
  motivations in mathematical biology is the modelling of large animal
  societies and the emergence of complex patterns from simple behavioral
  rules, e.g., flocks of birds, fish schools, ant colonies, etc. In the
  microscopic world, particle systems are used to model a wide range of
  phenomena, from the collective motion of spermatozoa to the anarchical
  development of cancer cells. Within this perspective, there are at
  least three important reasons to conduct large scale computer
  simulations of particle systems. First, numerical experiments are
  essential to calibrate the models and test the influence of each
  parameter in a controlled environment. For instance, the renowned
  Vicsek model
  (<xref alt="Vicsek et al., 1995" rid="ref-vicsek_novel_1995" ref-type="bibr">Vicsek
  et al., 1995</xref>) is a minimal model of <italic>flocking</italic>,
  which exhibits a complex behavior, studied numerically in particular
  in
  (<xref alt="Chaté et al., 2008" rid="ref-chate_collective_2008" ref-type="bibr">Chaté
  et al., 2008</xref>). Secondly, particle simulations are used to check
  the validity of <italic>macroscopic</italic> models that describe the
  statistical behavior of particle systems. These models are usually
  based on partial differential equations (PDE) derived using
  phenomenological considerations that are often difficult to justify
  mathematically
  (<xref alt="Degond et al., 2021" rid="ref-degond_bulk_2021" ref-type="bibr">Degond
  et al., 2021</xref>;
  <xref alt="Degond &amp; Motsch, 2008" rid="ref-degond_continuum_2008" ref-type="bibr">Degond
  &amp; Motsch, 2008</xref>;
  <xref alt="Dimarco &amp; Motsch, 2016" rid="ref-dimarco_self-alignment_2016" ref-type="bibr">Dimarco
  &amp; Motsch, 2016</xref>). Finally, inspired by models in biology,
  there is an ever growing literature on the design of algorithms based
  on the simulation of <italic>artificial</italic> particle systems to
  solve tough optimization problems
  (<xref alt="Grassi &amp; Pareschi, 2020" rid="ref-grassi_particle_2020" ref-type="bibr">Grassi
  &amp; Pareschi, 2020</xref>;
  <xref alt="Kennedy &amp; Eberhart, 1995" rid="ref-kennedy_particle_1995" ref-type="bibr">Kennedy
  &amp; Eberhart, 1995</xref>;
  <xref alt="Pinnau et al., 2017" rid="ref-pinnau_consensus-based_2017" ref-type="bibr">Pinnau
  et al., 2017</xref>;
  <xref alt="Totzeck, 2021" rid="ref-totzeck_trends_2021" ref-type="bibr">Totzeck,
  2021</xref>) and to construct new more efficient Markov Chain Monte
  Carlo methods
  (<xref alt="Cappé et al., 2004" rid="ref-cappe_population_2004" ref-type="bibr">Cappé
  et al., 2004</xref>;
  <xref alt="Clarté et al., 2021" rid="ref-clarte_collective_2021" ref-type="bibr">Clarté
  et al., 2021</xref>;
  <xref alt="Del Moral, 1998" rid="ref-del_moral_measure-valued_1998" ref-type="bibr">Del
  Moral, 1998</xref>,
  <xref alt="2013" rid="ref-del_moral_mean_2013" ref-type="bibr">2013</xref>;
  <xref alt="Doucet et al., 2001" rid="ref-doucet_sequential_2001" ref-type="bibr">Doucet
  et al., 2001</xref>). The simulation of systems of particles is also
  at the core of molecular dynamics
  (<xref alt="Leimkuhler &amp; Matthews, 2015" rid="ref-leihmkuhler" ref-type="bibr">Leimkuhler
  &amp; Matthews, 2015</xref>), although the present library is not
  specifically written for this purpose. The
  <monospace>SiSyPHE</monospace> library builds on recent advances in
  hardware and software for the efficient simulation of large scale
  interacting <italic>mean-field</italic> particle systems, both on the
  GPU and on the CPU. The versatile object-oriented Python interface of
  the library is designed for the simulation and comparison of new and
  classical many-particle models of collective dynamics in mathematics
  and active matter physics, enabling ambitious numerical experiments
  and leading to novel conjectures and results.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>A major difficulty in the simulation of systems of particles is the
  high computational cost, typically quadratic in the number of
  particles, which prevents large scale experiments. The implementation
  of <monospace>SiSyPHE</monospace> is based on recent libraries
  originally developed for machine learning purposes to significantly
  accelerate tensor (array) computations, namely the
  <monospace>PyTorch</monospace> package
  (<xref alt="Paszke et al., 2019" rid="ref-paszke_pytorch_2019" ref-type="bibr">Paszke
  et al., 2019</xref>) and the <monospace>KeOps</monospace> library
  (<xref alt="Charlier et al., 2021" rid="ref-charlier_kernel_2021" ref-type="bibr">Charlier
  et al., 2021</xref>). On a GPU, the <monospace>SiSyPHE</monospace>
  library speeds up both traditional Python and low-level
  implementations by one to three orders of magnitude for systems with
  up to several millions of particles.</p>
  <p>In addition, to the best of our knowledge, only model-specific
  packages such as Motsch
  (<xref alt="2016" rid="ref-motsch_vicsek_microflat_2016" ref-type="bibr">2016</xref>)
  are available. The <monospace>SiSyPHE</monospace> library includes,
  within a common framework, the implementation of many classical models
  and their variants as well as recent models for which no
  implementation was previously available. All the models detailed in
  the Example gallery of the documentation are directly taken from the
  literature on collective dynamics in mathematics and active matter
  physics. Moreover, the <monospace>SiSyPHE</monospace> library is
  designed in such a way that new custom models can easily be added in
  order to facilite the study and comparison of models from a research
  perspective.</p>
  <p>The development of the <monospace>SiSyPHE</monospace> library was
  initially motivated by the study of <italic>body-oriented
  particles</italic>
  (<xref alt="Degond et al., 2019" rid="ref-giacomin_alignment_2019" ref-type="bibr">Degond
  et al., 2019</xref>). The (formal) derivation of a macroscopic PDE
  model from the particle system has lead to a novel conjecture which
  postulates the existence of a class of so-called <italic>bulk
  topological states</italic> in
  (<xref alt="Degond et al., 2021" rid="ref-degond_bulk_2021" ref-type="bibr">Degond
  et al., 2021</xref>). The quantitative comparison between this
  theoretical prediction and the numerical simulation of the particle
  system in a suitable regime (with more than
  <inline-formula><alternatives>
  <tex-math><![CDATA[10^6]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:math></alternatives></inline-formula>
  particles) has confirmed the existence of these new states of matter.
  The study of their physical properties which are observed in the
  numerical experiments but not readily explained by the PDE model is an
  ongoing work.</p>
</sec>
<sec id="a-typical-example">
  <title>A typical example</title>
  <p>A typical model that is implemented in the
  <monospace>SiSyPHE</monospace> library is the variant of the Vicsek
  model introduced by Degond &amp; Motsch
  (<xref alt="2008" rid="ref-degond_continuum_2008" ref-type="bibr">2008</xref>)
  and defined by the system of <inline-formula><alternatives>
  <tex-math><![CDATA[2N]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>2</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  Stratonovich Stochastic Differential Equations
  <named-content id="eqU003Asde" content-type="equation"><disp-formula><alternatives>
  <tex-math><![CDATA[\label{eq:sde}
  \mathrm{d}X^i_t = c_0 V^i_t \mathrm{d}t, \quad \mathrm{d}V^i_t = \sigma \mathsf{P}(V^i_t)\circ(J^i_t\mathrm{d}t+\mathrm{d}B^i_t),]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1.0em"></mml:mspace><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:msubsup><mml:mi>V</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mstyle mathvariant="sans-serif"><mml:mi>𝖯</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>∘</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>J</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:msubsup><mml:mi>B</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></named-content>
  where the position at time <inline-formula><alternatives>
  <tex-math><![CDATA[t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>
  of a particle indexed by <inline-formula><alternatives>
  <tex-math><![CDATA[i\in\{1,\ldots,N\}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false" form="postfix">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  is a vector <inline-formula><alternatives>
  <tex-math><![CDATA[X^i_t\in\mathbb{R}^d]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mstyle mathvariant="double-struck"><mml:mi>ℝ</mml:mi></mml:mstyle><mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
  and its orientation (or velocity) is a unit vector
  <inline-formula><alternatives>
  <tex-math><![CDATA[V^i_t\in\mathbb{R}^d]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mstyle mathvariant="double-struck"><mml:mi>ℝ</mml:mi></mml:mstyle><mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
  with <inline-formula><alternatives>
  <tex-math><![CDATA[|V^i_t|=1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.
  The coefficient <inline-formula><alternatives>
  <tex-math><![CDATA[c_0>0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  is the speed of the particles (assumed to be constant), the matrix
  <inline-formula><alternatives>
  <tex-math><![CDATA[\mathsf{P}(V^i_t)= I_d - V^i_t\otimes V^i_t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mstyle mathvariant="sans-serif"><mml:mi>𝖯</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>⊗</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>
  is the orthogonal projection matrix on the plane orthgonal to
  <inline-formula><alternatives>
  <tex-math><![CDATA[V^i_t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>V</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[(B^i_t)^{}_t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>t</mml:mi><mml:mrow></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>
  is an independent Brownian motion, and <inline-formula><alternatives>
  <tex-math><![CDATA[\sigma>0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  is a diffusion coefficient which models the level of noise. The
  quantity <inline-formula><alternatives>
  <tex-math><![CDATA[J^i_t\in\mathbb{R}^d]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mstyle mathvariant="double-struck"><mml:mi>ℝ</mml:mi></mml:mstyle><mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
  is called a <italic>target</italic>; it is the orientation that
  particle <inline-formula><alternatives>
  <tex-math><![CDATA[i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
  is trying to adopt. In the Vicsek model introduced by Degond &amp;
  Motsch
  (<xref alt="2008" rid="ref-degond_continuum_2008" ref-type="bibr">2008</xref>),
  <named-content id="eqU003Atarget" content-type="equation"><disp-formula><alternatives>
  <tex-math><![CDATA[\label{eq:target}
  J^i_t = \frac{\sum_{j=1}^N K(|X^j_t-X^i_t|)V^j_t}{\big|\sum_{j=1}^N K(|X^j_t-X^i_t|)V^j_t\big|},]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mi>K</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">|</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mi>K</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">|</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></named-content>
  where the <italic>kernel</italic> <inline-formula><alternatives>
  <tex-math><![CDATA[K:[0,+\infty)\to[0,+\infty)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>K</mml:mi><mml:mo>:</mml:mo><mml:mo stretchy="false" form="prefix">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mi>∞</mml:mi><mml:mo stretchy="false" form="postfix">)</mml:mo><mml:mo>→</mml:mo><mml:mo stretchy="false" form="prefix">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mi>∞</mml:mi><mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  is a smooth nonnegative function vanishing at infinity which models
  the visual perception of the particles; in the Vicsek model, the
  vision of the particles depends on the distance between them. With the
  target given by
  <xref alt="Equation 2" rid="eqU003Atarget">Equation 2</xref>, each
  particle tries to adopt the average orientation of its neighbors,
  which is a typical <italic>flocking</italic> behavior.</p>
  <p>On a computer, the time-continuous system given by
  <xref alt="Equation 1" rid="eqU003Asde">Equation 1</xref> needs to be
  discretized first. For the Vicsek model, a natural discretization
  method is the (geometric) Euler-Maruyama scheme
  (<xref alt="Kloeden &amp; Platen, 1992" rid="ref-kloeden" ref-type="bibr">Kloeden
  &amp; Platen, 1992</xref>;
  <xref alt="Piggott &amp; Solo, 2016" rid="ref-piggott" ref-type="bibr">Piggott
  &amp; Solo, 2016</xref>). In general, the discretization method
  depends on the model considered as illustrated in the Example gallery.
  Then, at each time step, the most expensive operation is the
  computation of the target given by
  <xref alt="Equation 2" rid="eqU003Atarget">Equation 2</xref>, which
  requires <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{O}(N)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mstyle mathvariant="script"><mml:mi>𝒪</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  operations for each of the <inline-formula><alternatives>
  <tex-math><![CDATA[N]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>N</mml:mi></mml:math></alternatives></inline-formula>
  particles. The total simulation cost is thus
  <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{O}(N^2T)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mstyle mathvariant="script"><mml:mi>𝒪</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[T]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>
  is the total number of iterations. Within the framework of the
  <monospace>KeOps</monospace> library on which
  <monospace>SiSyPHE</monospace> is based, the computation of the target
  <xref alt="Equation 2" rid="eqU003Atarget">Equation 2</xref> is called
  a <italic>kernel operation</italic>, which is efficiently carried out
  using a <italic>symbolic</italic> definition of the
  <inline-formula><alternatives>
  <tex-math><![CDATA[N\times N]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  interaction matrix whose <inline-formula><alternatives>
  <tex-math><![CDATA[(i,j)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>-entry
  is <inline-formula><alternatives>
  <tex-math><![CDATA[K(|X^j_t-X^i_t|)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
  The computation of the target is then understood as a symbolic
  matrix-vector product between the interaction matrix and the vector of
  orientations.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>The development of this library would not have been possible
  without the help of Jean Feydy, his constant support and precious
  advice. This project was initiated by Pierre Degond and has grown out
  of many discussions with him.</p>
</sec>
</body>
<back>
<ref-list>
  <ref-list>
    <ref id="ref-piggott">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Piggott</surname><given-names>M. J.</given-names></name>
          <name><surname>Solo</surname><given-names>V.</given-names></name>
        </person-group>
        <article-title>Geometric Euler–Maruyama schemes for stochastic differential equations in SO(n) and SE(n)</article-title>
        <source>SIAM J. Numer. Anal.</source>
        <year iso-8601-date="2016">2016</year>
        <volume>54</volume>
        <issue>4</issue>
        <pub-id pub-id-type="doi">10.1137/15M1019726</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-kloeden">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name><surname>Kloeden</surname><given-names>Peter E.</given-names></name>
          <name><surname>Platen</surname><given-names>Eckhard</given-names></name>
        </person-group>
        <source>Numerical solution of stochastic differential equations</source>
        <publisher-name>Springer, Berlin, Heidelberg</publisher-name>
        <year iso-8601-date="1992">1992</year>
        <isbn>978-3-540-54062-5</isbn>
        <pub-id pub-id-type="doi">10.1007/978-3-662-12616-5</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-leihmkuhler">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name><surname>Leimkuhler</surname><given-names>Ben</given-names></name>
          <name><surname>Matthews</surname><given-names>Charles</given-names></name>
        </person-group>
        <source>Molecular dynamics with deterministic and stochastic numerical methods</source>
        <publisher-name>Springer International Publishing</publisher-name>
        <year iso-8601-date="2015">2015</year>
        <isbn>978-3-319-16374-1</isbn>
        <pub-id pub-id-type="doi">10.1007/978-3-319-16375-8</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-vicsek_novel_1995">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Vicsek</surname><given-names>T.</given-names></name>
          <name><surname>Czirók</surname><given-names>A.</given-names></name>
          <name><surname>Ben-Jacob</surname><given-names>E.</given-names></name>
          <name><surname>Cohen</surname><given-names>I.</given-names></name>
          <name><surname>Shochet</surname><given-names>O.</given-names></name>
        </person-group>
        <article-title>Novel Type of Phase Transition in a System of Self-Driven Particles</article-title>
        <source>Phys. Rev. Lett.</source>
        <year iso-8601-date="1995">1995</year>
        <volume>75</volume>
        <issue>6</issue>
        <uri>https://link.aps.org/doi/10.1103/PhysRevLett.75.1226</uri>
        <pub-id pub-id-type="doi">10.1103/PhysRevLett.75.1226</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-degond_continuum_2008">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Degond</surname><given-names>P.</given-names></name>
          <name><surname>Motsch</surname><given-names>S.</given-names></name>
        </person-group>
        <article-title>Continuum limit of self-driven particles with orientation interaction</article-title>
        <source>Math. Models Methods Appl. Sci.</source>
        <year iso-8601-date="2008">2008</year>
        <volume>18</volume>
        <issue>Suppl.</issue>
        <uri>https://www.worldscientific.com/doi/abs/10.1142/S0218202508003005</uri>
        <pub-id pub-id-type="doi">10.1142/S0218202508003005</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-del_moral_mean_2013">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name><surname>Del Moral</surname><given-names>P.</given-names></name>
        </person-group>
        <source>Mean field simulation for Monte Carlo integration</source>
        <publisher-name>CRC Press, Taylor &amp; Francis Group</publisher-name>
        <year iso-8601-date="2013">2013</year>
        <isbn>9781466504059</isbn>
      </element-citation>
    </ref>
    <ref id="ref-dimarco_self-alignment_2016">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Dimarco</surname><given-names>G.</given-names></name>
          <name><surname>Motsch</surname><given-names>S.</given-names></name>
        </person-group>
        <article-title>Self-alignment driven by jump processes: Macroscopic limit and numerical investigation</article-title>
        <source>Math. Models Methods Appl. Sci.</source>
        <year iso-8601-date="2016">2016</year>
        <volume>26</volume>
        <issue>07</issue>
        <uri>https://www.worldscientific.com/doi/abs/10.1142/S0218202516500330</uri>
        <pub-id pub-id-type="doi">10.1142/S0218202516500330</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-giacomin_alignment_2019">
      <element-citation publication-type="chapter">
        <person-group person-group-type="author">
          <name><surname>Degond</surname><given-names>P.</given-names></name>
          <name><surname>Frouvelle</surname><given-names>A.</given-names></name>
          <name><surname>Merino-Aceituno</surname><given-names>S.</given-names></name>
          <name><surname>Trescases</surname><given-names>A.</given-names></name>
        </person-group>
        <article-title>Alignment of Self-propelled Rigid Bodies: From Particle Systems to Macroscopic Equations</article-title>
        <source>Stochastic Dynamics Out of Equilibrium, Institut Henri Poincaré, Paris, France, 2017</source>
        <person-group person-group-type="editor">
          <name><surname>Giacomin</surname><given-names>G.</given-names></name>
          <name><surname>Olla</surname><given-names>S.</given-names></name>
          <name><surname>Saada</surname><given-names>E.</given-names></name>
          <name><surname>Spohn</surname><given-names>H.</given-names></name>
          <name><surname>Stoltz</surname><given-names>G.</given-names></name>
        </person-group>
        <publisher-name>Springer, Cham</publisher-name>
        <year iso-8601-date="2019">2019</year>
        <uri>http://link.springer.com/10.1007/978-3-030-15096-9_2</uri>
        <pub-id pub-id-type="doi">10.1007/978-3-030-15096-9_2</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-clarte_collective_2021">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Clarté</surname><given-names>G.</given-names></name>
          <name><surname>Diez</surname><given-names>A.</given-names></name>
          <name><surname>Feydy</surname><given-names>J.</given-names></name>
        </person-group>
        <article-title>Collective Proposal Distributions for Nonlinear MCMC samplers: Mean-Field Theory and Fast Implementation</article-title>
        <source>arXiv preprint: arXiv:1909.08988</source>
        <year iso-8601-date="2021">2021</year>
        <uri>http://arxiv.org/abs/1909.08988</uri>
      </element-citation>
    </ref>
    <ref id="ref-totzeck_trends_2021">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Totzeck</surname><given-names>C.</given-names></name>
        </person-group>
        <article-title>Trends in Consensus-based optimization</article-title>
        <source>arXiv preprint: arXiv:2104.01383</source>
        <year iso-8601-date="2021">2021</year>
        <uri>http://arxiv.org/abs/2104.01383</uri>
      </element-citation>
    </ref>
    <ref id="ref-pinnau_consensus-based_2017">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Pinnau</surname><given-names>R.</given-names></name>
          <name><surname>Totzeck</surname><given-names>C.</given-names></name>
          <name><surname>Tse</surname><given-names>O.</given-names></name>
          <name><surname>Martin</surname><given-names>S.</given-names></name>
        </person-group>
        <article-title>A consensus-based model for global optimization and its mean-field limit</article-title>
        <source>Math. Models Methods Appl. Sci.</source>
        <year iso-8601-date="2017">2017</year>
        <volume>27</volume>
        <issue>01</issue>
        <uri>https://www.worldscientific.com/doi/abs/10.1142/S0218202517400061</uri>
        <pub-id pub-id-type="doi">10.1142/S0218202517400061</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-grassi_particle_2020">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Grassi</surname><given-names>S.</given-names></name>
          <name><surname>Pareschi</surname><given-names>L.</given-names></name>
        </person-group>
        <article-title>From particle swarm optimization to consensus based optimization: Stochastic modeling and mean-field limit</article-title>
        <source>Math. Models Methods Appl. Sci.</source>
        <year iso-8601-date="2020">2020</year>
        <volume>31</volume>
        <issue>8</issue>
        <uri>http://arxiv.org/abs/2012.05613</uri>
        <pub-id pub-id-type="doi">10.1142/s0218202521500342</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-degond_bulk_2021">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Degond</surname><given-names>P.</given-names></name>
          <name><surname>Diez</surname><given-names>A.</given-names></name>
          <name><surname>Na</surname><given-names>M.</given-names></name>
        </person-group>
        <article-title>Bulk topological states in a new collective dynamics model</article-title>
        <source>arXiv preprint: arXiv:2101.10864</source>
        <year iso-8601-date="2021">2021</year>
        <uri>http://arxiv.org/abs/2101.10864</uri>
      </element-citation>
    </ref>
    <ref id="ref-charlier_kernel_2021">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Charlier</surname><given-names>B.</given-names></name>
          <name><surname>Feydy</surname><given-names>J.</given-names></name>
          <name><surname>Glaunès</surname><given-names>J. A.</given-names></name>
          <name><surname>Collin</surname><given-names>F.-D.</given-names></name>
          <name><surname>Durif</surname><given-names>G.</given-names></name>
        </person-group>
        <article-title>Kernel Operations on the GPU, with Autodiff, without Memory Overflows</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year iso-8601-date="2021">2021</year>
        <volume>22</volume>
        <issue>74</issue>
      </element-citation>
    </ref>
    <ref id="ref-del_moral_measure-valued_1998">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Del Moral</surname><given-names>P.</given-names></name>
        </person-group>
        <article-title>Measure-valued processes and interacting particle systems. Application to nonlinear filtering problems</article-title>
        <source>Ann. Appl. Probab.</source>
        <year iso-8601-date="1998">1998</year>
        <volume>8</volume>
        <pub-id pub-id-type="doi">10.1214/aoap/1028903535</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-kennedy_particle_1995">
      <element-citation publication-type="paper-conference">
        <person-group person-group-type="author">
          <name><surname>Kennedy</surname><given-names>J.</given-names></name>
          <name><surname>Eberhart</surname><given-names>R.</given-names></name>
        </person-group>
        <article-title>Particle swarm optimization</article-title>
        <source>Proceedings of ICNN’95 - International Conference on Neural Networks</source>
        <publisher-name>IEEE</publisher-name>
        <publisher-loc>Perth, WA, Australia</publisher-loc>
        <year iso-8601-date="1995">1995</year>
        <volume>4</volume>
        <isbn>978-0-7803-2768-9</isbn>
        <uri>http://ieeexplore.ieee.org/document/488968/</uri>
        <pub-id pub-id-type="doi">10.1109/ICNN.1995.488968</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-chate_collective_2008">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Chaté</surname><given-names>H.</given-names></name>
          <name><surname>Ginelli</surname><given-names>F.</given-names></name>
          <name><surname>Grégoire</surname><given-names>G.</given-names></name>
          <name><surname>Raynaud</surname><given-names>F.</given-names></name>
        </person-group>
        <article-title>Collective motion of self-propelled particles interacting without cohesion</article-title>
        <source>Phys. Rev. E</source>
        <year iso-8601-date="2008">2008</year>
        <volume>77</volume>
        <issue>4</issue>
        <issn>1539-3755, 1550-2376</issn>
        <uri>https://link.aps.org/doi/10.1103/PhysRevE.77.046113</uri>
        <pub-id pub-id-type="doi">10.1103/PhysRevE.77.046113</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-doucet_sequential_2001">
      <element-citation publication-type="book">
        <source>Sequential Monte Carlo Methods in Practice</source>
        <person-group person-group-type="editor">
          <name><surname>Doucet</surname><given-names>Arnaud</given-names></name>
          <name><surname>Freitas</surname><given-names>Nando</given-names></name>
          <name><surname>Gordon</surname><given-names>Neil</given-names></name>
        </person-group>
        <publisher-name>Springer-Verlag New York</publisher-name>
        <year iso-8601-date="2001">2001</year>
        <date-in-citation content-type="access-date"><year iso-8601-date="2021-05-13">2021</year><month>05</month><day>13</day></date-in-citation>
        <isbn>978-0-387-95146-1</isbn>
        <uri>http://link.springer.com/10.1007/978-1-4757-3437-9</uri>
        <pub-id pub-id-type="doi">10.1007/978-1-4757-3437-9</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-cappe_population_2004">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Cappé</surname><given-names>O.</given-names></name>
          <name><surname>Guillin</surname><given-names>A.</given-names></name>
          <name><surname>Marin</surname><given-names>J. M.</given-names></name>
          <name><surname>Robert</surname><given-names>C. P.</given-names></name>
        </person-group>
        <article-title>Population Monte Carlo</article-title>
        <source>J. Comput. Graph. Statist.</source>
        <year iso-8601-date="2004">2004</year>
        <volume>13</volume>
        <issue>4</issue>
        <issn>1061-8600, 1537-2715</issn>
        <uri>http://www.tandfonline.com/doi/abs/10.1198/106186004X12803</uri>
        <pub-id pub-id-type="doi">10.1198/106186004X12803</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-motsch_vicsek_microflat_2016">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Motsch</surname><given-names>S.</given-names></name>
        </person-group>
        <article-title>Vicsek_microFlat</article-title>
        <source>GitHub repository</source>
        <year iso-8601-date="2016">2016</year>
        <uri>https://github.com/smotsch/Vicsek_microFlat</uri>
      </element-citation>
    </ref>
    <ref id="ref-paszke_pytorch_2019">
      <element-citation publication-type="paper-conference">
        <person-group person-group-type="author">
          <name><surname>Paszke</surname><given-names>A.</given-names></name>
          <name><surname>Gross</surname><given-names>S.</given-names></name>
          <name><surname>Massa</surname><given-names>F.</given-names></name>
          <name><surname>Lerer</surname><given-names>A.</given-names></name>
          <name><surname>Bradbury</surname><given-names>J.</given-names></name>
          <name><surname>Chanan</surname><given-names>G.</given-names></name>
          <name><surname>Killeen</surname><given-names>T.</given-names></name>
          <name><surname>Lin</surname><given-names>Z.</given-names></name>
          <name><surname>Gimelshein</surname><given-names>N.</given-names></name>
          <name><surname>Antiga</surname><given-names>L.</given-names></name>
          <name><surname>Desmaison</surname><given-names>A.</given-names></name>
          <name><surname>Kopf</surname><given-names>A.</given-names></name>
          <name><surname>Yang</surname><given-names>E.</given-names></name>
          <name><surname>DeVito</surname><given-names>Z.</given-names></name>
          <name><surname>Raison</surname><given-names>M.</given-names></name>
          <name><surname>Tejani</surname><given-names>A.</given-names></name>
          <name><surname>Chilamkurthy</surname><given-names>S.</given-names></name>
          <name><surname>Steiner</surname><given-names>B.</given-names></name>
          <name><surname>Fang</surname><given-names>L.</given-names></name>
          <name><surname>Bai</surname><given-names>J.</given-names></name>
          <name><surname>Chintala</surname><given-names>S.</given-names></name>
        </person-group>
        <article-title>PyTorch: An Imperative Style, High-Performance Deep Learning Library</article-title>
        <source>Advances in Neural Information Processing Systems</source>
        <person-group person-group-type="editor">
          <name><surname>Wallach</surname><given-names>H.</given-names></name>
          <name><surname>Larochelle</surname><given-names>H.</given-names></name>
          <name><surname>Beygelzimer</surname><given-names>A.</given-names></name>
          <name><surname>Alché-Buc</surname><given-names>F.</given-names></name>
          <name><surname>Fox</surname><given-names>E.</given-names></name>
          <name><surname>Garnett</surname><given-names>R.</given-names></name>
        </person-group>
        <publisher-name>Curran Associates, Inc.</publisher-name>
        <year iso-8601-date="2019">2019</year>
        <volume>32</volume>
        <uri>https://proceedings.neurips.cc/paper/2019/file/bdbca288fee7f92f2bfa9f7012727740-Paper.pdf</uri>
      </element-citation>
    </ref>
  </ref-list>
</ref-list>
</back>
</article>
