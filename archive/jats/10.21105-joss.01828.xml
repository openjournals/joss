<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">1828</article-id>
<article-id pub-id-type="doi">10.21105/joss.01828</article-id>
<title-group>
<article-title>fathon: A Python package for a fast computation of
detrendend fluctuation analysis and related algorithms</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0001-6729-8655</contrib-id>
<string-name>Stefano Bianchi</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Mathematics and Physics, Roma Tre
University</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2019-11-10">
<day>10</day>
<month>11</month>
<year>2019</year>
</pub-date>
<volume>5</volume>
<issue>45</issue>
<fpage>1828</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2021</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Cython</kwd>
<kwd>Detrended fluctuation analysis</kwd>
<kwd>Multifractal spectrum</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p><monospace>fathon</monospace> is a Python package for DFA
  (detrended fluctuation analysis) and related algorithms.</p>
  <p>DFA
  (<ext-link ext-link-type="uri" xlink:href="https://fathon.readthedocs.io/en/latest/fun_class/fathon.DFA.html">fathon.DFA</ext-link>)
  was first developed by Peng to study memory effects in sequences of
  DNA
  (<xref alt="Peng et al., 1993" rid="ref-peng_1993" ref-type="bibr">Peng
  et al., 1993</xref>). DFA is useful in recognising long memory
  processes by means of the scaling properties of the fluctuation
  function <inline-formula><alternatives>
  <tex-math><![CDATA[F (n)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
  <inline-formula><alternatives>
  <tex-math><![CDATA[F (n)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is calculated starting from the cumulative sum of the process
  <inline-formula><alternatives>
  <tex-math><![CDATA[X(t)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  (most likely a time series), <inline-formula><alternatives>
  <tex-math><![CDATA[Y(t) = \sum_{t' = 1}^t [ X(t') - \langle X \rangle ]]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mi>′</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mi>′</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false" form="prefix">⟨</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false" form="postfix">⟩</mml:mo><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  with <inline-formula><alternatives>
  <tex-math><![CDATA[\langle X \rangle]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="false" form="prefix">⟨</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false" form="postfix">⟩</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  the mean of <inline-formula><alternatives>
  <tex-math><![CDATA[X(t)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
  <inline-formula><alternatives>
  <tex-math><![CDATA[Y(t)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is then divided into <inline-formula><alternatives>
  <tex-math><![CDATA[N_n = \lfloor N / n \rfloor]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false" form="prefix">⌊</mml:mo><mml:mi>N</mml:mi><mml:mi>/</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false" form="postfix">⌋</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  non-overlapping time intervals of length
  <inline-formula><alternatives>
  <tex-math><![CDATA[n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>.
  Since the length of the time series is often not a multiple of
  <inline-formula><alternatives>
  <tex-math><![CDATA[n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>,
  some data at the end of <inline-formula><alternatives>
  <tex-math><![CDATA[Y(t)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  could be excluded. In order to not neglect them, the same procedure
  can be repeated starting from the end of
  <inline-formula><alternatives>
  <tex-math><![CDATA[Y(t)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  and the total number of time intervals will amount to
  <inline-formula><alternatives>
  <tex-math><![CDATA[2N_n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.
  The data in each interval <inline-formula><alternatives>
  <tex-math><![CDATA[s]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>s</mml:mi></mml:math></alternatives></inline-formula>
  are fitted with a polynomial <inline-formula><alternatives>
  <tex-math><![CDATA[Y_s^{fit}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>,
  and the variance is computed, <inline-formula><alternatives>
  <tex-math><![CDATA[F^2 ( n,s ) = \frac{1}{n} \sum_{i = 1}^n \ [ Y ( ( s - 1 ) n + i ) - Y_s^{fit} (i) ]^2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mspace width="0.222em"></mml:mspace><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
  for <inline-formula><alternatives>
  <tex-math><![CDATA[s = 1, \dots , N_n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
  and <inline-formula><alternatives>
  <tex-math><![CDATA[F^2 ( n,s ) = \frac{1}{n} \sum_{i = 1}^n \  [ Y ( N - ( s - N_n ) n + i ) - Y_s^{fit} (i) ]^2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mspace width="0.222em"></mml:mspace><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
  for <inline-formula><alternatives>
  <tex-math><![CDATA[s = N_n + 1, \dots , 2N_n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.
  Finally, the fluctuation function is defined as
  <disp-formula><alternatives>
  <tex-math><![CDATA[
  F ( n ) = \biggl[ \frac{1}{2 N_n} \sum_{s = 1}^{2 N_n} F^2 ( n,s ) \biggr]^{1 / 2}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">[</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:msup><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msup><mml:mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">]</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></disp-formula>
  <inline-formula><alternatives>
  <tex-math><![CDATA[F(n)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is expected to scale as <inline-formula><alternatives>
  <tex-math><![CDATA[n^H]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>n</mml:mi><mml:mi>H</mml:mi></mml:msup></mml:math></alternatives></inline-formula>.
  <inline-formula><alternatives>
  <tex-math><![CDATA[H]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>H</mml:mi></mml:math></alternatives></inline-formula>
  is the Hurst exponent, and its value can indicate if a process is
  persistent or anti-persistent:</p>
  <list list-type="bullet">
    <list-item>
      <p><inline-formula><alternatives>
      <tex-math><![CDATA[H \in [0.0, 0.5) \rightarrow]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>H</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false" form="prefix">[</mml:mo><mml:mn>0.0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false" form="postfix">)</mml:mo><mml:mo>→</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
      anti-persistency. The process under study is anti-persistent and
      tends to decrease (increase) after a previous increase (decrease).
      An anti-persistent process appears very noisy;</p>
    </list-item>
    <list-item>
      <p><inline-formula><alternatives>
      <tex-math><![CDATA[H = 0.5 \rightarrow]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mo>→</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
      uncorrelated process;</p>
    </list-item>
    <list-item>
      <p><inline-formula><alternatives>
      <tex-math><![CDATA[H \in (0.5, 1.0] \rightarrow]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>H</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>1.0</mml:mn><mml:mo stretchy="false" form="postfix">]</mml:mo><mml:mo>→</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
      persistency. If a process has been increasing (decreasing) for a
      period <inline-formula><alternatives>
      <tex-math><![CDATA[T]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>,
      then it is expected to continue to increase (decrease) for a
      similar period. Persistent processes show long-range correlations
      and exhibit relatively little noise;</p>
    </list-item>
    <list-item>
      <p><inline-formula><alternatives>
      <tex-math><![CDATA[H > 1.0 \rightarrow]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>H</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1.0</mml:mn><mml:mo>→</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
      nonstationary process, stronger long-range correlations are
      present.</p>
    </list-item>
  </list>
  <p>DFA has found various applications in different fields, such as
  geophysics
  (<xref alt="Fraedrich &amp; Blender, 2003" rid="ref-fraedrich_2003" ref-type="bibr">Fraedrich
  &amp; Blender, 2003</xref>;
  <xref alt="Varotsos et al., 2007" rid="ref-varotsos_2007" ref-type="bibr">Varotsos
  et al., 2007</xref>) and economics
  (<xref alt="Ivanov et al., 2004" rid="ref-ivanov_2004" ref-type="bibr">Ivanov
  et al., 2004</xref>;
  <xref alt="Liu et al., 1999" rid="ref-liu_1999" ref-type="bibr">Liu et
  al., 1999</xref>). In the the geophysics references, DFA has been
  applied to study the persistency of deseasonalized
  CO<inline-formula><alternatives>
  <tex-math><![CDATA[_2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi></mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
  data and the difference in persistency between temperature records
  over land and ocean in order to validate climate models. In the
  economics references, DFA has been applied to find a common scaling
  behavior in the temporal organization of trading, and to study the
  persistency of economic records within different time periods (hours,
  days, months).</p>
  <p>DFA has since evolved to multifractal detrended fluctuation
  analysis (MFDFA,
  <ext-link ext-link-type="uri" xlink:href="https://fathon.readthedocs.io/en/latest/fun_class/fathon.MFDFA.html">fathon.MFDFA</ext-link>)
  (<xref alt="Kantelhardt et al., 2003" rid="ref-kantelhardt_2002" ref-type="bibr">Kantelhardt
  et al., 2003</xref>) to take into account the variability of time
  series and the possible multiple scaling properties of the fluctuation
  function. <inline-formula><alternatives>
  <tex-math><![CDATA[F(n)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  can be generalised and computed at different orders
  <inline-formula><alternatives>
  <tex-math><![CDATA[q]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>,
  <disp-formula><alternatives>
  <tex-math><![CDATA[
  F_q ( n ) = \biggl[ \frac{1}{2 N_n} \sum_{s = 1}^{2 N_n} [F^2 ( n , s )]^{q/2} \biggr]^{1 / q} \sim n^{h ( q )}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">[</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">]</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></disp-formula>
  DFA corresponds to MFDFA with <inline-formula><alternatives>
  <tex-math><![CDATA[q]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>
  = 2, and <inline-formula><alternatives>
  <tex-math><![CDATA[h ( 2 )]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  = <inline-formula><alternatives>
  <tex-math><![CDATA[H]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>H</mml:mi></mml:math></alternatives></inline-formula>.
  <inline-formula><alternatives>
  <tex-math><![CDATA[q]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>
  can take any real value. For positive values of
  <inline-formula><alternatives>
  <tex-math><![CDATA[q]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>,
  time intervals <inline-formula><alternatives>
  <tex-math><![CDATA[s]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>s</mml:mi></mml:math></alternatives></inline-formula>
  with a large variance <inline-formula><alternatives>
  <tex-math><![CDATA[F^2 (n,s)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  will dominate. Thus, for positive values of
  <inline-formula><alternatives>
  <tex-math><![CDATA[q]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[h(q)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  describes the scaling behavior of time intervals with large
  fluctuations. Instead, for negative values of
  <inline-formula><alternatives>
  <tex-math><![CDATA[q]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>,
  time intervals with a small variance <inline-formula><alternatives>
  <tex-math><![CDATA[F^2 (n,s)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  will dominate. Hence, for negative values of
  <inline-formula><alternatives>
  <tex-math><![CDATA[q]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[h(q)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  describes the scaling behavior of time intervals with small
  fluctuations. For <inline-formula><alternatives>
  <tex-math><![CDATA[q = 0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[F_q(n)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is divergent and can be replaced by an exponential of a logarithmic
  sum <disp-formula><alternatives>
  <tex-math><![CDATA[
  F_0 ( n ) = \exp \biggl[ \frac{1}{4 N_n} \sum_{s = 1}^{2 N_n} \ln ( F^2 ( n , s ) ) \biggr] \sim n^{h ( 0 )}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">[</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mo>ln</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">]</mml:mo><mml:mo>∼</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></disp-formula>
  If <inline-formula><alternatives>
  <tex-math><![CDATA[h(q)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is approximately constant for all the values of
  <inline-formula><alternatives>
  <tex-math><![CDATA[q]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>,
  the time series is said to be monofractal, i.e., it exhibits the same
  scaling at all scales. If <inline-formula><alternatives>
  <tex-math><![CDATA[h(q)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  instead varies significantly, the time series is multifractal, i.e.,
  it exhibits different scalings at different scales. The different
  scalings are better described by the multifractal spectrum, defined as
  <disp-formula><alternatives>
  <tex-math><![CDATA[
  f(\alpha) = q[\alpha - h(q)] + 1
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></disp-formula>
  with <inline-formula><alternatives>
  <tex-math><![CDATA[\alpha = h(q) + q\frac{dh(q)}{dq}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>.
  The spectrum is concave down, and the wider it is, the more
  multifractal the time series is.</p>
  <p>Other algorithms have been further developed, such as the time
  dependent Hurst exponent
  (<ext-link ext-link-type="uri" xlink:href="https://fathon.readthedocs.io/en/latest/fun_class/fathon.HT.html">fathon.HT</ext-link>)
  (<xref alt="Ihlen, 2012" rid="ref-ihlen_2012" ref-type="bibr">Ihlen,
  2012</xref>) that examines the changes of persistency as a function of
  time intervals. The square root of the variance
  <inline-formula><alternatives>
  <tex-math><![CDATA[F^2(n, s)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is computed in every interval of length <inline-formula><alternatives>
  <tex-math><![CDATA[n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>.
  However, now the time intervals overlap, spanning the whole time
  series, and the fluctuations in every window are given by
  <disp-formula><alternatives>
  <tex-math><![CDATA[
  F ( n,s ) = \sqrt{ \frac{1}{n} \sum_{i = 1}^n \ [ Y ( (s - 1) + i ) - Y_s^{fit} (i) ]^2 }
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mspace width="0.222em"></mml:mspace><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></disp-formula>
  with <inline-formula><alternatives>
  <tex-math><![CDATA[s = 1, \dots , N - n + 1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.
  Then, each value of the fluctuations and the value of
  <inline-formula><alternatives>
  <tex-math><![CDATA[F_q ( N )]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  (that is the same for every order <inline-formula><alternatives>
  <tex-math><![CDATA[q]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>)
  can be connected with a straight line to obtain a local Hurst exponent
  <inline-formula><alternatives>
  <tex-math><![CDATA[H_t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  as the slope of the line, i.e., the Hurst exponent for a single time
  interval.</p>
  <p>Another recent algorithm is the detrended cross-correlation
  analysis (DCCA,
  <ext-link ext-link-type="uri" xlink:href="https://fathon.readthedocs.io/en/latest/fun_class/fathon.DCCA.html">fathon.DCCA</ext-link>)
  (<xref alt="Podobnik &amp; Stanley, 2008" rid="ref-podobnik_2008" ref-type="bibr">Podobnik
  &amp; Stanley, 2008</xref>) that studies cross-correlations in terms
  of persistency between non-linear time series. It needs two time
  series to be calculated, <inline-formula><alternatives>
  <tex-math><![CDATA[X_a(t)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[X_b(t)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
  They are divided into <inline-formula><alternatives>
  <tex-math><![CDATA[N - n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  overlapping time intervals, each one containing
  <inline-formula><alternatives>
  <tex-math><![CDATA[n + 1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  values. The covariance is then computed,
  <inline-formula><alternatives>
  <tex-math><![CDATA[F^2_{ab} (n,s) = \frac{1}{n - 1} \sum_{k = s}^{n + s} \ [ Y_{as}(k) - Y_{as}^{fit}(k) ] [ Y_{bs}(k) - Y_{bs}^{fit}(k) ]]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.222em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  where <inline-formula><alternatives>
  <tex-math><![CDATA[a]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>a</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[b]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>b</mml:mi></mml:math></alternatives></inline-formula>
  refer to the first and the second time series, respectively, and
  <inline-formula><alternatives>
  <tex-math><![CDATA[s = 1, \dots , N-n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.
  Finally, the fluctuation function is calculated summing over all the
  overlapping <inline-formula><alternatives>
  <tex-math><![CDATA[N - n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  time intervals of size <inline-formula><alternatives>
  <tex-math><![CDATA[n+1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
  <disp-formula><alternatives>
  <tex-math><![CDATA[
  F_{ab} ( n ) = \biggl[ \frac{1}{N - n} \sum_{s = 1}^{N -n} F^2_{ab} (n,s) \biggr]^{1 / 2}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">[</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msup><mml:mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">]</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></disp-formula>
  Recently, a cross-correlation index <inline-formula><alternatives>
  <tex-math><![CDATA[\rho(n)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  has been introduced in order to make the interpretation of DCCA
  clearer
  (<xref alt="Zebende, 2011" rid="ref-zebende_2011" ref-type="bibr">Zebende,
  2011</xref>), <disp-formula><alternatives>
  <tex-math><![CDATA[
  \rho ( n ) = \frac{F^2_{ab} ( n )}{F_{aa} ( n ) F_{bb} ( n )}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula>
  Similar to the standard cross-correlation coefficient,
  <inline-formula><alternatives>
  <tex-math><![CDATA[\rho(n) = 1.0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  indicates a perfect cross-correlation, while
  <inline-formula><alternatives>
  <tex-math><![CDATA[\rho(n) = -1.0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  means a perfect anti-cross-correlation. If
  <inline-formula><alternatives>
  <tex-math><![CDATA[\rho(n) = 0.0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
  there is no cross-correlation between the two time series at the scale
  <inline-formula><alternatives>
  <tex-math><![CDATA[n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>.</p>
  <p><monospace>fathon</monospace> implements common operations for all
  the algorithms described above, such as the computation of the
  fluctuation function and its fit in different ranges, the multifractal
  spectrum, and the detrended cross-correlation index and its confidence
  intervals. <monospace>fathon</monospace> aims at providing a simple
  and interactive interface to perform multiple analyses on multiple
  time series. The Python interface is class-based and user-friendly,
  while the underlying code is written in Cython and C, allowing a fast
  computation of the algorithms.</p>
  <p><monospace>fathon</monospace> can be useful to all researchers and
  data analysts who utilize the methods listed above, especially in the
  fields of geophysics, economics, and biophysics. Its purpose is to
  gather all the algorithms together, in order to have a single package
  that includes different methodologies. They are easy to use in their
  basic or advanced versions, and the user can easily switch between
  them. Undoubtedly, codes for each method have already been
  individually developed, see for instance
  <ext-link ext-link-type="uri" xlink:href="https://github.com/yoshiso/mf-dfa/blob/master/mfdfa.py">mf-dfa</ext-link>,
  <ext-link ext-link-type="uri" xlink:href="https://github.com/dokato/dfa">dfa</ext-link>,
  and
  <ext-link ext-link-type="uri" xlink:href="https://raphaelvallat.com/entropy/build/html/generated/entropy.detrended_fluctuation.html">detrended_fluctuation</ext-link>.
  These packages implement only a single algorithm of
  <monospace>fathon</monospace> and are less flexible. The most
  comprehensive package is the Ihlen’s Matlab package for multifractal
  detrended fluctuation analysis
  (<xref alt="Ihlen, 2012" rid="ref-ihlen_2012" ref-type="bibr">Ihlen,
  2012</xref>). It does not cover DCCA and the computation of the
  cross-correlation index, is less flexible, and some functions’
  parameters are not considered, like the possibility of calculating the
  fluctuation function only forward or both forward and backward. The
  <monospace>fathon</monospace> package is intended to be more complete,
  gathering different algorithms under a single package. Moreover,
  <monospace>fathon</monospace> offers more functions and more
  flexibility in parameters choice.</p>
</sec>
</body>
<back>
<ref-list>
  <ref-list>
    <ref id="ref-zebende_2011">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Zebende</surname><given-names>G. F.</given-names></name>
        </person-group>
        <article-title>DCCA cross-correlation coefficient: Quantifying level of cross-correlation.</article-title>
        <source>Physica A: Statistical Mechanics and its Applications</source>
        <year iso-8601-date="2011">2011</year>
        <volume>390</volume>
        <issue>4</issue>
        <pub-id pub-id-type="doi">http://dx.doi.org/10.1016/j.physa.2010.10.022</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-podobnik_2008">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Podobnik</surname><given-names>B.</given-names></name>
          <name><surname>Stanley</surname><given-names>H. E.</given-names></name>
        </person-group>
        <article-title>Detrended cross-correlation analysis: A new method for analyzing two nonstationary time series.</article-title>
        <source>Physical Review Letters</source>
        <year iso-8601-date="2008">2008</year>
        <volume>100</volume>
        <issue>8</issue>
        <pub-id pub-id-type="doi">http://dx.doi.org/10.1103/PhysRevLett.100.084102</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-ihlen_2012">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Ihlen</surname><given-names>E. A.</given-names></name>
        </person-group>
        <article-title>Introduction to multifractal detrended fluctuation analysis in Matlab.</article-title>
        <source>Fractal analysis</source>
        <year iso-8601-date="2012">2012</year>
        <volume>3</volume>
        <pub-id pub-id-type="doi">http://dx.doi.org/10.3389/fphys.2012.00141</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-kantelhardt_2002">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Kantelhardt</surname><given-names>J. W.</given-names></name>
          <name><surname>Zschiegner</surname><given-names>S. A.</given-names></name>
          <name><surname>Koscielny-Bunde</surname><given-names>E.</given-names></name>
          <name><surname>Bunde</surname><given-names>A.</given-names></name>
          <name><surname>Havlin</surname><given-names>S.</given-names></name>
          <name><surname>Stanley</surname><given-names>H. E.</given-names></name>
        </person-group>
        <article-title>Multifractal detrended fluctuation analysis of nonstationary time series.</article-title>
        <source>Physica A: Statistical Mechanics and its Applications</source>
        <year iso-8601-date="2003">2003</year>
        <volume>316</volume>
        <issue>1</issue>
        <pub-id pub-id-type="doi">http://dx.doi.org/10.1016/S0378-4371(02)01383-3</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-ivanov_2004">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Ivanov</surname><given-names>P. C.</given-names></name>
          <name><surname>Yuen</surname><given-names>A.</given-names></name>
          <name><surname>Podobnik</surname><given-names>B.</given-names></name>
          <name><surname>Lee</surname><given-names>Y.</given-names></name>
        </person-group>
        <article-title>Common scaling patterns in intertrade times of US stocks.</article-title>
        <source>Physical Review E</source>
        <year iso-8601-date="2004">2004</year>
        <volume>69</volume>
        <issue>5</issue>
        <pub-id pub-id-type="doi">http://dx.doi.org/10.1103/PhysRevE.69.056107</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-liu_1999">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Liu</surname><given-names>Y.</given-names></name>
          <name><surname>Gopikrishnan</surname><given-names>P.</given-names></name>
          <name><surname>Stanley</surname><given-names>H. E.</given-names></name>
        </person-group>
        <article-title>Statistical properties of the volatility of price fluctuations.</article-title>
        <source>Physical Review E</source>
        <year iso-8601-date="1999">1999</year>
        <volume>60</volume>
        <issue>2</issue>
        <pub-id pub-id-type="doi">http://dx.doi.org/10.1103/PhysRevE.60.1390</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-fraedrich_2003">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Fraedrich</surname><given-names>K.</given-names></name>
          <name><surname>Blender</surname><given-names>R.</given-names></name>
        </person-group>
        <article-title>Scaling of atmosphere and ocean temperature correlations in observations and climate models.</article-title>
        <source>Physical Review Letters</source>
        <year iso-8601-date="2003">2003</year>
        <volume>90</volume>
        <issue>10</issue>
        <pub-id pub-id-type="doi">http://dx.doi.org/10.1103/PhysRevLett.90.108501</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-varotsos_2007">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Varotsos</surname><given-names>C.</given-names></name>
          <name><surname>Assimakopoulos</surname><given-names>M. N.</given-names></name>
          <name><surname>Efstathiou</surname><given-names>M.</given-names></name>
        </person-group>
        <article-title>Long-term memory effect in the atmospheric CO_2 concentration at Mauna Loa.</article-title>
        <source>Atmospheric Chemistry and Physics</source>
        <year iso-8601-date="2007">2007</year>
        <volume>7</volume>
        <issue>3</issue>
        <pub-id pub-id-type="doi">https://doi.org/10.5194/acp-7-629-2007</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-peng_1993">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Peng</surname><given-names>C. K.</given-names></name>
          <name><surname>Buldyrev</surname><given-names>S. V.</given-names></name>
          <name><surname>Goldberger</surname><given-names>A. L.</given-names></name>
          <name><surname>Havlin</surname><given-names>S.</given-names></name>
          <name><surname>Simons</surname><given-names>M.</given-names></name>
          <name><surname>Stanley</surname><given-names>H. E.</given-names></name>
        </person-group>
        <article-title>Finite-size effects on long-range correlations: Implications for analyzing DNA sequences</article-title>
        <source>Physical Review E</source>
        <year iso-8601-date="1993">1993</year>
        <volume>47</volume>
        <issue>5</issue>
        <pub-id pub-id-type="doi">http://dx.doi.org/10.1103/PhysRevE.47.3730</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</ref-list>
</back>
</article>
