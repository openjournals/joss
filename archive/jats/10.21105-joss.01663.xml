<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">1663</article-id>
<article-id pub-id-type="doi">10.21105/joss.01663</article-id>
<title-group>
<article-title>SleepPy: A python package for sleep analysis from
accelerometer data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0003-3371-8935</contrib-id>
<string-name>Yiorgos Christakis</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0003-0257-9311</contrib-id>
<string-name>Nikhil Mahadevan</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-4369-3033</contrib-id>
<string-name>Shyamal Patel</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Pfizer, Inc.</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2019-07-12">
<day>12</day>
<month>7</month>
<year>2019</year>
</pub-date>
<volume>4</volume>
<issue>44</issue>
<fpage>1663</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2021</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>SleepPy</kwd>
<kwd>Accelerometer</kwd>
<kwd>Actigraphy</kwd>
<kwd>Algorithms</kwd>
<kwd>Wrist</kwd>
<kwd>GeneActiv</kwd>
<kwd>Digital Medicine</kwd>
<kwd>Wearable Sensors</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="introduction">
  <title>Introduction</title>
  <p>Measures of sleep quality and quantity can provide valuable
  insights into the health and well-being of an individual.
  Traditionally, sleep assessments are performed in the clinic/hospital
  setting using polysomnography tests. Recent advances in wearable
  sensor technology have enabled objective assessment of sleep at home.
  Actigraphy has been widely used for this purpose and several
  algorithms have been published in the literature over the years.
  However, implementation of these algorithms is not widely available,
  which creates a barrier for wider adoption of wearable devices in
  clinical research.</p>
  <p><monospace>SleepPy</monospace> is an open source python package
  incorporating several published algorithms in a modular framework and
  providing a suite of measures for the assessment of sleep quantity and
  quality. The package can process multi-day streams of raw
  accelerometer data (X, Y &amp; Z) from wrist-worn wearable devices to
  produce sleep reports and visualizations for each recording day
  (24-hour period). The reports are formatted to facilitate statistical
  analysis of sleep measures. Visualization acts as a quick debugging
  tool, provides insights into sleep patterns of individual subjects and
  can be used for presentation of data to diverse audiences.</p>
</sec>
<sec id="processing-pipeline">
  <title>Processing Pipeline</title>
  <p><monospace>SleepPy</monospace> has been developed with the goal of
  making it easy for researchers to derive measures of sleep from
  accelerometer data collected during daily life. While it currently
  provides out-of-the-box support for data files generated by the
  GeneActiv wrist-worn devices, it can be easily extended to support
  data files generated by other wrist-worn wearable devices. The package
  can work with both GeneActiv .bin files, as well as raw .csv outputs
  generated by GeneActiv’s software. Each .bin file needs to be manually
  processed with the GeneActiv software to generate a .csv file. So
  while it takes longer for <monospace>SleepPy</monospace> to process
  .bin files, it is highly advisable to do so for large datasets.</p>
  <p><monospace>SleepPy</monospace> follows seven steps when processing
  data:</p>
  <list list-type="order">
    <list-item>
      <p>Split data by day: Load raw accelerometer data from input file
      and split it into 24-hour segments (noon to noon).</p>
    </list-item>
    <list-item>
      <p>Derive activity index
      (<xref alt="Bai et al., 2016" rid="ref-Bai2016" ref-type="bibr">Bai
      et al., 2016</xref>): Calculate activity index for each 1 minute
      epoch of the day.</p>
    </list-item>
    <list-item>
      <p>Perform off-body detection
      (<xref alt="Vincent T. van Hees et al., 2014" rid="ref-VanHees2014" ref-type="bibr">Vincent
      T. van Hees et al.,
      2014</xref>),(<xref alt="Van Hees et al., 2015" rid="ref-VanHees2015" ref-type="bibr">Van
      Hees et al.,
      2015</xref>),(<xref alt="V. T. V. Hees et al., 2019" rid="ref-VanHees2019" ref-type="bibr">V.
      T. V. Hees et al., 2019</xref>): Run off-body detection algorithm
      and generate a label (on or off body) for each 15 minute epoch of
      the day.</p>
    </list-item>
    <list-item>
      <p>Identify major rest period
      (<xref alt="Vincent Theodoor van Hees et al., 2018" rid="ref-VanHees2018" ref-type="bibr">Vincent
      Theodoor van Hees et al., 2018</xref>): Estimate the major rest
      period (i.e. sleep window) for each day.</p>
    </list-item>
    <list-item>
      <p>Perform sleep/wake classification
      (<xref alt="Cole et al., 1992" rid="ref-Cole1992" ref-type="bibr">Cole
      et al., 1992</xref>): Run sleep/wake classification algorithm to
      generate sleep/wake labels for each 1 minute epoch of the day.</p>
    </list-item>
    <list-item>
      <p>Calculate sleep measures: Calculate sleep measures based on
      sleep/wake states only during the major rest period for each
      day.</p>
    </list-item>
    <list-item>
      <p>Generate reports and visualizations: Create a set of tables and
      charts for analysis and presentation of processed outputs and
      sleep measures for each day.</p>
    </list-item>
  </list>
</sec>
<sec id="outputs">
  <title>Outputs</title>
  <p>The user has access to all intermediate data, a table of sleep
  measures, and two kinds of visual reports.</p>
  <fig>
    <caption><p>Visual report showing various raw and processed data
    streams</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="https://raw.githubusercontent.com/elyiorgos/sleeppy/master/images/Visual_Results_Day_1_paper.png" xlink:title="" />
  </fig>
</sec>
<sec id="data-streams-report">
  <title>Data Streams Report</title>
  <p>Raw and processed data streams generated at each stage of the
  processing pipeline are visualized in this report for each day (24
  hour period, noon to noon). As shown in Figure 1, the report includes
  a source file name, number of the day in the sequence of days
  provided, start date of the data being shown, and a table of all
  calculated sleep measures for that day. Below the table are plots of
  raw and processed data streams.</p>
  <p>The plots are laid out as follows:</p>
  <list list-type="order">
    <list-item>
      <p>XYZ: The first chart is a plot of the raw tri-axial
      accelerometer signals (X, Y, and Z).</p>
    </list-item>
    <list-item>
      <p>Activity index: The second chart is a plot of minute-by-minute
      activity index values, which reflect the intensity of activity for
      each minute.</p>
    </list-item>
    <list-item>
      <p>Arm-angle: The third chart is a plot of the arm-angle over 24
      hours, this data stream is used to determine the major rest
      period.</p>
    </list-item>
    <list-item>
      <p>Wake: The fourth chart represents sleep/wake classification for
      the entire day. However, sleep measures are computed during the
      major rest period only.</p>
    </list-item>
    <list-item>
      <p>Rest periods: The fifth chart is a plot of all rest periods
      detected by the algorithm. Only the longest rest period
      (i.e. major rest period) is used for calculating sleep
      measures.</p>
    </list-item>
    <list-item>
      <p>On-body: The sixth chart is a plot of all periods identified by
      the on-body detection algorithm (without filtering or
      re-scoring).</p>
    </list-item>
    <list-item>
      <p>On-body (re-scored): The seventh chart is a plot of the on-body
      periods after re-scoring has been applied.</p>
    </list-item>
  </list>
</sec>
<sec id="sleep-measures-report">
  <title>Sleep Measures Report</title>
  <p>Sleep measures derived from the sleep/wake classifications for each
  day are provided in a table as well as a visual report (Figure 2).</p>
  <fig>
    <caption><p>Visual report showing a plot of sleep measures across
    all days.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="https://raw.githubusercontent.com/elyiorgos/sleeppy/master/images/summary_example_paper.png" xlink:title="" />
  </fig>
  <p>Sleep measures table (.csv file) contains the following sleep
  measures for each night:</p>
  <list list-type="order">
    <list-item>
      <p>Total sleep time (minutes): Total time spent asleep during the
      major rest period.</p>
    </list-item>
    <list-item>
      <p>Percent time asleep (%): Percentage of the major rest period
      spent in the sleep state.</p>
    </list-item>
    <list-item>
      <p>Wake after sleep onset (WASO, minutes): The amount of time
      spent awake after the first sleep state.</p>
    </list-item>
    <list-item>
      <p>Sleep onset latency (SOL, minutes): The time it took for the
      subject to fall asleep.</p>
    </list-item>
    <list-item>
      <p>Number of wake bouts: The number of times the subject
      transitioned from sleep to wake, after the first sleep state.</p>
    </list-item>
  </list>
</sec>
<sec id="availability">
  <title>Availability</title>
  <p>The software is available as a pip installable package, as well as
  on GitHub at:
  <ext-link ext-link-type="uri" xlink:href="https://github.com/elyiorgos/sleeppy">https://github.com/elyiorgos/sleeppy</ext-link></p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>The Digital Medicine &amp; Translational Imaging group at Pfizer,
  Inc supported the development of this package.</p>
</sec>
<sec id="license">
  <title>License</title>
  <p>This project is licensed under the MIT License - see the
  <ext-link ext-link-type="uri" xlink:href="LICENSE.md">LICENSE</ext-link>
  file for details</p>
</sec>
</body>
<back>
<ref-list>
  <ref-list>
    <ref id="ref-VanHees2014">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Hees</surname><given-names>Vincent T. van</given-names></name>
          <name><surname>Fang</surname><given-names>Zhou</given-names></name>
          <name><surname>Langford</surname><given-names>Joss</given-names></name>
          <name><surname>Assah</surname><given-names>Felix</given-names></name>
          <name><surname>Mohammad</surname><given-names>Anwar</given-names></name>
          <name><surname>Silva</surname><given-names>Inacio C. M. da</given-names></name>
          <name><surname>Trenell</surname><given-names>Michael I.</given-names></name>
          <name><surname>White</surname><given-names>Tom</given-names></name>
          <name><surname>Wareham</surname><given-names>Nicholas J.</given-names></name>
          <name><surname>Brage</surname><given-names>Søren</given-names></name>
        </person-group>
        <article-title>Autocalibration of accelerometer data for free-living physical activity assessment using local gravity and temperature: an evaluation on four continents</article-title>
        <source>Journal of Applied Physiology</source>
        <year iso-8601-date="2014-10">2014</year><month>10</month>
        <volume>117</volume>
        <issue>7</issue>
        <issn>8750-7587</issn>
        <uri>http://www.physiology.org/doi/10.1152/japplphysiol.00421.2014</uri>
        <pub-id pub-id-type="doi">10.1152/japplphysiol.00421.2014</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-VanHees2015">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Van Hees</surname><given-names>Vincent T.</given-names></name>
          <name><surname>Sabia</surname><given-names>Séverine</given-names></name>
          <name><surname>Anderson</surname><given-names>Kirstie N.</given-names></name>
          <name><surname>Denton</surname><given-names>Sarah J.</given-names></name>
          <name><surname>Oliver</surname><given-names>James</given-names></name>
          <name><surname>Catt</surname><given-names>Michael</given-names></name>
          <name><surname>Abell</surname><given-names>Jessica G.</given-names></name>
          <name><surname>Kivimäki</surname><given-names>Mika</given-names></name>
          <name><surname>Trenell</surname><given-names>Michael I.</given-names></name>
          <name><surname>Singh-Manoux</surname><given-names>Archana</given-names></name>
        </person-group>
        <article-title>A novel, open access method to assess sleep duration using a wrist-worn accelerometer</article-title>
        <source>PLoS ONE</source>
        <publisher-name>Public Library of Science</publisher-name>
        <year iso-8601-date="2015-11">2015</year><month>11</month>
        <volume>10</volume>
        <issue>11</issue>
        <issn>19326203</issn>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0142533</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Bai2016">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Bai</surname><given-names>Jiawei</given-names></name>
          <name><surname>Di</surname><given-names>Chongzhi</given-names></name>
          <name><surname>Xiao</surname><given-names>Luo</given-names></name>
          <name><surname>Evenson</surname><given-names>Kelly R.</given-names></name>
          <name><surname>LaCroix</surname><given-names>Andrea Z.</given-names></name>
          <name><surname>Crainiceanu</surname><given-names>Ciprian M.</given-names></name>
          <name><surname>Buchner</surname><given-names>David M.</given-names></name>
        </person-group>
        <article-title>An activity index for raw accelerometry data and its comparison with other activity metrics</article-title>
        <source>PLoS ONE</source>
        <publisher-name>Public Library of Science</publisher-name>
        <year iso-8601-date="2016-08">2016</year><month>08</month>
        <volume>11</volume>
        <issue>8</issue>
        <issn>19326203</issn>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0160644</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Cole1992">
      <element-citation publication-type="report">
        <person-group person-group-type="author">
          <name><surname>Cole</surname><given-names>Roger J</given-names></name>
          <name><surname>Kripke</surname><given-names>Daniel F</given-names></name>
          <name><surname>Gruen</surname><given-names>Twilliam</given-names></name>
          <name><surname>Mullaney</surname><given-names>Daniel J</given-names></name>
          <name><surname>Gillin</surname><given-names>J Christian</given-names></name>
        </person-group>
        <article-title>Automatic Sleep/Wake Identification From Wrist Activity</article-title>
        <year iso-8601-date="1992">1992</year>
        <volume>15</volume>
        <isbn>15/5/461/2749332</isbn>
        <uri>https://academic.oup.com/sleep/article-abstract/15/5/461/2749332</uri>
        <pub-id pub-id-type="doi">10.1093/sleep/15.5.461</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-VanHees2018">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Hees</surname><given-names>Vincent Theodoor van</given-names></name>
          <name><surname>Sabia</surname><given-names>S.</given-names></name>
          <name><surname>Jones</surname><given-names>S. E.</given-names></name>
          <name><surname>Wood</surname><given-names>A. R.</given-names></name>
          <name><surname>Anderson</surname><given-names>K. N.</given-names></name>
          <name><surname>Kivimäki</surname><given-names>M.</given-names></name>
          <name><surname>Frayling</surname><given-names>T. M.</given-names></name>
          <name><surname>Pack</surname><given-names>A. I.</given-names></name>
          <name><surname>Bucan</surname><given-names>M.</given-names></name>
          <name><surname>Trenell</surname><given-names>M. I.</given-names></name>
          <name><surname>Mazzotti</surname><given-names>Diego R.</given-names></name>
          <name><surname>Gehrman</surname><given-names>P. R.</given-names></name>
          <name><surname>Singh-Manoux</surname><given-names>B. A.</given-names></name>
          <name><surname>Weedon</surname><given-names>M. N.</given-names></name>
        </person-group>
        <article-title>Estimating sleep parameters using an accelerometer without sleep diary</article-title>
        <source>Scientific Reports</source>
        <publisher-name>Nature Publishing Group</publisher-name>
        <year iso-8601-date="2018-12">2018</year><month>12</month>
        <volume>8</volume>
        <issue>1</issue>
        <issn>20452322</issn>
        <pub-id pub-id-type="doi">10.1038/s41598-018-31266-z</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-VanHees2019">
      <element-citation>
        <person-group person-group-type="author">
          <name><surname>Hees</surname><given-names>V. T. Van</given-names></name>
          <name><surname>Fang</surname><given-names>Z.</given-names></name>
          <name><surname>Zhao</surname><given-names>J.</given-names></name>
          <name><surname>Heywood</surname><given-names>J.</given-names></name>
          <name><surname>Mirkes</surname><given-names>E.</given-names></name>
          <name><surname>Sabia</surname><given-names>S.</given-names></name>
          <name><surname>Migueles</surname><given-names>J.</given-names></name>
        </person-group>
        <article-title>GGIR: Raw Accelerometer Data Analysis</article-title>
        <year iso-8601-date="2019">2019</year>
        <uri>https://crantastic.org/packages/GGIR</uri>
        <pub-id pub-id-type="doi">10.5281/zenodo.1051064</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</ref-list>
</back>
</article>
