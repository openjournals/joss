<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">1693</article-id>
<article-id pub-id-type="doi">10.21105/joss.01693</article-id>
<title-group>
<article-title>kramersmoyal: Kramers--Moyal coefficients for stochastic
processes</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0001-5513-0580</contrib-id>
<string-name>Leonardo Rydin GorjÃ£o</string-name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
<xref ref-type="aff" rid="aff-4"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-3864-7569</contrib-id>
<string-name>Francisco Meirinhos</string-name>
<xref ref-type="aff" rid="aff-5"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Epileptology, University of Bonn, Venusberg
Campus 1, 53127 Bonn, Germany</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Helmholtz Institute for Radiation and Nuclear Physics,
University of Bonn, NuÃŸallee 14â€“16, 53115 Bonn, Germany</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Forschungszentrum JÃ¼lich, Institute for Energy and Climate
Research - Systems Analysis and Technology Evaluation (IEK-STE), 52428
JÃ¼lich, Germany</institution>
</institution-wrap>
</aff>
<aff id="aff-4">
<institution-wrap>
<institution>Institute for Theoretical Physics, University of Cologne,
50937 KÃ¶ln, Germany</institution>
</institution-wrap>
</aff>
<aff id="aff-5">
<institution-wrap>
<institution>Physikalisches Institut and Bethe Center for Theoretical
Physics, UniversitÃ¤t Bonn, Nussallee 12, 53115 Bonn,
Germany</institution>
</institution-wrap>
</aff>
</contrib-group>
<volume>4</volume>
<issue>44</issue>
<fpage>1693</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2021</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Kramers--Moyal coefficents</kwd>
<kwd>Kernel-density estimators</kwd>
<kwd>N-dimensional stochastic processes</kwd>
<kwd>Markovian processes</kwd>
<kwd>Master equation</kwd>
<kwd>Fokker--Planck</kwd>
<kwd>Ornstein--Uhlenbeck process</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>A general problem for evaluating Markovian stochastic processes is
  the retrieval of the moments or the Kramersâ€“Moyal coefficients
  <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{M}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mstyle mathvariant="script"><mml:mi>â„³</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula>
  from data or time-series. The Kramersâ€“Moyal coefficients are derived
  from an Taylor expansion of the master equation that describes the
  probability evolution of a Markovian stochastic process.</p>
  <p>Given a set of stochastic data, ergodic or quasi-stationary, the
  extensive literature of stochastic processes awards a set of measures,
  such as the Kramersâ€“Moyal coefficients or its moments, which link
  stochastic processes to a probabilistic description of the process or
  of the family of processes
  (<xref alt="Risken, 1996" rid="ref-Risken" ref-type="bibr">Risken,
  1996</xref>). Most commonly known is the Fokkerâ€“Planck equation or
  truncated forward Kolmogorov equation, partial differential equations,
  obtained from the Taylor expansion of the master equation.</p>
  <p>Of particular relevance is the growing evidence that real-world
  data displays higher-order (<inline-formula><alternatives>
  <tex-math><![CDATA[n>2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>)
  Kramersâ€“Moyal coefficients, which has a two-fold consequence: The
  common truncation at third order of the forward Kolmogorov equation,
  giving rise to the Fokkerâ€“Planck equation, is no longer valid. The
  existence of higher-order (<inline-formula><alternatives>
  <tex-math><![CDATA[n>2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>)
  Kramersâ€“Moyal coefficients in recorded data thus invalidates the
  aforementioned common argument for truncation, thus rendering the
  Fokkerâ€“Planck description insufficient
  (<xref alt="Tabar, 2019" rid="ref-Tabar" ref-type="bibr">Tabar,
  2019</xref>). A clear and common example is the presence of
  discontinuous jumps in data
  (<xref alt="AÃ¯t-Sahalia, 2002" rid="ref-Sahalia" ref-type="bibr">AÃ¯t-Sahalia,
  2002</xref>;
  <xref alt="Anvari et al., 2016" rid="ref-Anvari" ref-type="bibr">Anvari
  et al., 2016</xref>), which can give rise to higher-order
  Kramersâ€“Moyal coefficients, as are evidenced in GorjÃ£o et al.
  (<xref alt="2019" rid="ref-Rydin" ref-type="bibr">2019</xref>) and
  references within.</p>
  <p>Calculating the moments or Kramersâ€“Moyal coefficients strictly from
  data can be computationally heavy for long data series and is prone to
  innaccuracy especially where the density of data points is scarce, for
  example, usually at the boundaries on the domain of the process. The
  most straightforward approach is to perform a histogram-based
  estimation to evaluate the moments of the system at hand. This has two
  main drawbacks: it requires a discrete space of examination of the
  process and is shown to be less accurate than using kernel-based
  estimators
  (<xref alt="Lamouroux &amp; Lehnertz, 2009" rid="ref-Lamouroux" ref-type="bibr">Lamouroux
  &amp; Lehnertz, 2009</xref>).</p>
  <p>This library is based on a kernel-based estimation,
  <italic>i.e.</italic>, the Nadarayaâ€“Watson kernel estimator
  (<xref alt="Nadaraya, 1964" rid="ref-Nadaraya" ref-type="bibr">Nadaraya,
  1964</xref>;
  <xref alt="Watson, 1964" rid="ref-Watson" ref-type="bibr">Watson,
  1964</xref>), which allows for more robust results given both a wider
  range of possible kernel shapes to perform the calculation, as well as
  retrieving the results in a non-binned coordinate space, unlike
  histogram regressions
  (<xref alt="Silverman, 2018" rid="ref-Silverman" ref-type="bibr">Silverman,
  2018</xref>). It further employs a convolution of the time series with
  the selected kernel, circumventing the computational issue of
  sequential array summation, the most common bottleneck in integration
  time and computer memory.</p>
  <p>The package presented here contains several options: A general
  open-source toolbox for the calculation of Kramersâ€“Moyal coefficients
  for any given data series of any dimension and to any order, with a
  selection of commonly-used kernel estimators.</p>
</sec>
<sec id="mathematics">
  <title>Mathematics</title>
  <p>For a general <inline-formula><alternatives>
  <tex-math><![CDATA[N]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>N</mml:mi></mml:math></alternatives></inline-formula>-dimensional
  Markovian process <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{x}(t)\in\mathbb{R}^N]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>ğ±</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>âˆˆ</mml:mo><mml:msup><mml:mstyle mathvariant="double-struck"><mml:mi>â„</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
  the Kramersâ€“Moyal yields all orders of the cumulants of the
  conditional probability distribution <inline-formula><alternatives>
  <tex-math><![CDATA[P(\boldsymbol{x}',t+\Delta T | \boldsymbol{x}, t)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ğ±</mml:mi></mml:mstyle><mml:mi>â€²</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Î”</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ğ±</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  as <disp-formula><alternatives>
  <tex-math><![CDATA[
  \mathcal{M}^{\sigma}(\boldsymbol{x},t)=\lim_{\Delta t\to 0}\frac{1}{\Delta t}\int  d\boldsymbol{x}'[\boldsymbol{x}(t)'-\boldsymbol{x}(t)]^\sigma P(\boldsymbol{x}',t+\Delta T | \boldsymbol{x}, t),\nonumber \tag{1}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mstyle mathvariant="script"><mml:mi>â„³</mml:mi></mml:mstyle><mml:mi>Ïƒ</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ğ±</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>lim</mml:mo><mml:mrow><mml:mi>Î”</mml:mi><mml:mi>t</mml:mi><mml:mo>â†’</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>Î”</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>âˆ«</mml:mo><mml:mi>d</mml:mi><mml:mstyle mathvariant="bold"><mml:mi>ğ±</mml:mi></mml:mstyle><mml:mi>â€²</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ğ±</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>â€²</mml:mi><mml:mo>âˆ’</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ğ±</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mi>Ïƒ</mml:mi></mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ğ±</mml:mi></mml:mstyle><mml:mi>â€²</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Î”</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ğ±</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
  with <inline-formula><alternatives>
  <tex-math><![CDATA[[\dots]^\sigma]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>â€¦</mml:mi><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mi>Ïƒ</mml:mi></mml:msup></mml:math></alternatives></inline-formula>
  a dyadic multiplication and the power <inline-formula><alternatives>
  <tex-math><![CDATA[\sigma]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Ïƒ</mml:mi></mml:math></alternatives></inline-formula>
  allowing for a set of powers depending on the dimensionality of the
  process
  (<xref alt="Risken, 1996" rid="ref-Risken" ref-type="bibr">Risken,
  1996</xref>).</p>
  <p>The exact evaluation of the Kramersâ€“Moyal coefficients for discrete
  or discretised datasets <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{y}(t)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>ğ²</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>â€”any
  human measure of a process is discrete, as well as any computer
  generated dataâ€”is bounded by the timewise limit imposed. Taking as an
  example a two-dimensional case with <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{y}(t)=(y_1(t),y_2(t))\in\mathbb{R}^{2}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>ğ²</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>âˆˆ</mml:mo><mml:msup><mml:mstyle mathvariant="double-struck"><mml:mi>â„</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>,
  the Kramersâ€“Moyal coefficients <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{M}^{[\ell, m]}\in\mathbb{R}^{2}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mstyle mathvariant="script"><mml:mi>â„³</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>â„“</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow></mml:msup><mml:mo>âˆˆ</mml:mo><mml:msup><mml:mstyle mathvariant="double-struck"><mml:mi>â„</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
  take the form</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
  \begin{aligned}
  &\mathcal{M}^{[\ell, m]}(x_1,x_2,t)=\nonumber\\&\lim_{\Delta t\to 0}\!\frac{1}{\Delta t}\!\int\!\! \mathrm{d} y_1 \mathrm{d} y_2 (y_1(t\!+\!\Delta t)\!-\!y_1(t))^\ell(y_2(t\!+\!\Delta t)\!-\!y_2(t))^m P(y_1,y_2, t\!+\!\Delta t|x_1,x_2,t), \nonumber
  \end{aligned} \tag{2}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtable><mml:mtr><mml:mtd columnalign="right"></mml:mtd><mml:mtd columnalign="left"><mml:msup><mml:mstyle mathvariant="script"><mml:mi>â„³</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>â„“</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"></mml:mtd><mml:mtd columnalign="left"><mml:munder><mml:mo>lim</mml:mo><mml:mrow><mml:mi>Î”</mml:mi><mml:mi>t</mml:mi><mml:mo>â†’</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mspace width="-0.167em"></mml:mspace><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>Î”</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="-0.167em"></mml:mspace><mml:mo>âˆ«</mml:mo><mml:mspace width="-0.167em"></mml:mspace><mml:mspace width="-0.167em"></mml:mspace><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mspace width="-0.167em"></mml:mspace><mml:mo>+</mml:mo><mml:mspace width="-0.167em"></mml:mspace><mml:mi>Î”</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mspace width="-0.167em"></mml:mspace><mml:mo>âˆ’</mml:mo><mml:mspace width="-0.167em"></mml:mspace><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>â„“</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mspace width="-0.167em"></mml:mspace><mml:mo>+</mml:mo><mml:mspace width="-0.167em"></mml:mspace><mml:mi>Î”</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mspace width="-0.167em"></mml:mspace><mml:mo>âˆ’</mml:mo><mml:mspace width="-0.167em"></mml:mspace><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mspace width="-0.167em"></mml:mspace><mml:mo>+</mml:mo><mml:mspace width="-0.167em"></mml:mspace><mml:mi>Î”</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
  <p>at a certain measure point <inline-formula><alternatives>
  <tex-math><![CDATA[(x_1,x_2)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.
  The order of the Kramersâ€“Moyal coefficients is given here by the
  superscripts <inline-formula><alternatives>
  <tex-math><![CDATA[\ell]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>â„“</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[m]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>m</mml:mi></mml:math></alternatives></inline-formula>.</p>
  <p>Theoretically, there are still two details to attend to: Firstly,
  there is an explicit dependence on time <inline-formula><alternatives>
  <tex-math><![CDATA[t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>.
  For the case of stationary (or quasi-stationary) data discussed here,
  <inline-formula><alternatives>
  <tex-math><![CDATA[P(\boldsymbol{x}',t+\Delta T | \boldsymbol{x}, t) = P(\boldsymbol{x}',\Delta T | \boldsymbol{x})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ğ±</mml:mi></mml:mstyle><mml:mi>â€²</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Î”</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ğ±</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ğ±</mml:mi></mml:mstyle><mml:mi>â€²</mml:mi><mml:mo>,</mml:mo><mml:mi>Î”</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ğ±</mml:mi></mml:mstyle><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
  This entails time-independent Kramersâ€“Moyal coefficients
  <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{M}^{\sigma}(\boldsymbol{x})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mstyle mathvariant="script"><mml:mi>â„³</mml:mi></mml:mstyle><mml:mi>Ïƒ</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ğ±</mml:mi></mml:mstyle><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
  Secondly, <inline-formula><alternatives>
  <tex-math><![CDATA[\Delta t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Î”</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  should take the limiting case of <inline-formula><alternatives>
  <tex-math><![CDATA[\Delta t \to 0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Î”</mml:mi><mml:mi>t</mml:mi><mml:mo>â†’</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  but the restriction of any measuring or storing deviceâ€”or the nature
  of the observables themselvesâ€”permits only time-sampled or discrete
  recordings. In the limiting case where <inline-formula><alternatives>
  <tex-math><![CDATA[\Delta t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Î”</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  is equivalent to the minimal sampling rate of the data, the
  Kramersâ€“Moyal coefficients take the form, in our two-dimensional
  example, as</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
  \mathcal{M}^{[\ell, m]}(x_1, x_2) = \frac{1}{\Delta t} \langle \Delta y_1^{\ell} \Delta y_2^{m} |_{y_1(t)=x_1, y_2(t)=x_2}\rangle,~\mathrm{with}~\Delta y_i =  y_i(t+ \Delta t) - y_i(t).\nonumber \tag{3}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mstyle mathvariant="script"><mml:mi>â„³</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>â„“</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>Î”</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false" form="prefix">âŸ¨</mml:mo><mml:mi>Î”</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mn>1</mml:mn><mml:mi>â„“</mml:mi></mml:msubsup><mml:mi>Î”</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:msubsup><mml:msub><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false" form="postfix">âŸ©</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.222em"></mml:mspace><mml:mstyle mathvariant="normal"><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mstyle><mml:mspace width="0.222em"></mml:mspace><mml:mi>Î”</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Î”</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>âˆ’</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>It is straightforward to generalise this to any number of
  dimensions. The relevance and importance of adequate time-sampling was
  extensively studied and discussed in Lehnertz et al.
  (<xref alt="2018" rid="ref-Lehnertz" ref-type="bibr">2018</xref>).</p>
  <p>The Kramersâ€“Moyal coefficients exist on an underlying probabilistic
  space, that is, there exists a probabilistic measure assigned to the
  process, stemming from the master equation describing the family of
  such processes. The conventional procedure, as mentioned previously,
  is to utilise a histogram regression of the observed process and
  retrieve, via approximation or fitting, the Kramersâ€“Moyal coefficient.
  The choice of a histogram measure for the Kramersâ€“Moyal coefficient
  results in an acceptable measure of the probability density functions
  of the process but requires a new mathematical space (a distribution
  space). The employment of a kernel-estimation approach, the
  Nadarayaâ€“Watson estimator, implemented in this library, permits an
  identical overview without the necessity of a new (discretised)
  distribution space, given that the equivalent space of the observable
  can be taken.</p>
  <p>Like the histogram approach for the measure of the Kramersâ€“Moyal
  coefficients, each single measure of the observable
  <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{y}(t)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>ğ²</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is averaged, with a designated weight, into the distribution space.
  The standing difference, in comparison to the histogram approach, is
  the removal of a (discrete) binning system. All points are averaged,
  in a weighted fashion, into the distribution spaceâ€”aiding especially
  in cases where the number of point in a dataset is smallâ€”and awarding
  a continuous measurable space (easier for fitting, for example)
  (<xref alt="Lamouroux &amp; Lehnertz, 2009" rid="ref-Lamouroux" ref-type="bibr">Lamouroux
  &amp; Lehnertz, 2009</xref>).</p>
</sec>
<sec id="exemplary-one-dimensional-ornsteinuhlenbeck-process">
  <title>Exemplary one-dimensional Ornsteinâ€“Uhlenbeck process</title>
  <p>A one-dimensional Ornsteinâ€“Uhlenbeck process
  <inline-formula><alternatives>
  <tex-math><![CDATA[y(t)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  takes the form <disp-formula><alternatives>
  <tex-math><![CDATA[
      d y(t) = - \theta y(t) dt + \sigma d W(t), \nonumber \tag{4}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>d</mml:mi><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>âˆ’</mml:mo><mml:mi>Î¸</mml:mi><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Ïƒ</mml:mi><mml:mi>d</mml:mi><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
  with <inline-formula><alternatives>
  <tex-math><![CDATA[\theta]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Î¸</mml:mi></mml:math></alternatives></inline-formula>
  denoted as the <italic>drift</italic> or mean-reverting term,
  <inline-formula><alternatives>
  <tex-math><![CDATA[\sigma]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Ïƒ</mml:mi></mml:math></alternatives></inline-formula>
  the <italic>diffusion</italic>, <italic>volatility</italic>, or
  stochastic amplitude, and <inline-formula><alternatives>
  <tex-math><![CDATA[W(t)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is a Brownian motion, <italic>i.e.</italic>, a Wiener process. For
  this particular example set <inline-formula><alternatives>
  <tex-math><![CDATA[\theta = 0.3]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Î¸</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\sigma=0.1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Ïƒ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p>
  <p>To be able to test the library and the retrieval on the
  Kramersâ€“Moyal coefficients, and subsequently recover the drift and
  diffusion term, one can numerically integrate the process. We employ a
  Eulerâ€“Maruyama integrator, for simplicity. There are more reliable and
  faster integrators, for example <monospace>JiTCSDE</monospace>
  (<xref alt="Ansmann, 2018" rid="ref-Ansmann" ref-type="bibr">Ansmann,
  2018</xref>).</p>
  <p><inline-graphic mimetype="application" mime-subtype="pdf" xlink:href="Fig_1.pdf" />
  Fig. 1: Trajectory of Eq.(4) for <inline-formula><alternatives>
  <tex-math><![CDATA[\theta = 0.3]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Î¸</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\sigma=0.1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Ïƒ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
  for a total time of <inline-formula><alternatives>
  <tex-math><![CDATA[500]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>500</mml:mn></mml:math></alternatives></inline-formula>
  time units, with a time step of <inline-formula><alternatives>
  <tex-math><![CDATA[0.001]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>0.001</mml:mn></mml:math></alternatives></inline-formula>,
  i.e., comprising <inline-formula><alternatives>
  <tex-math><![CDATA[5\times10^5]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>5</mml:mn><mml:mo>Ã—</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
  data points.</p>
  <p>For the present case, with an integration over
  <inline-formula><alternatives>
  <tex-math><![CDATA[500]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>500</mml:mn></mml:math></alternatives></inline-formula>
  time units and with a timestep of <inline-formula><alternatives>
  <tex-math><![CDATA[0.001]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>0.001</mml:mn></mml:math></alternatives></inline-formula>,
  which can be seen in Fig. 1. The first and second Kramersâ€“Moyal
  coefficients are presented in Fig. 2, where as well the conventional
  histogram-based estimation, a non-convolution based kernel estimation,
  and this library implementing a convolution of the kernel with the
  terms the right-hand side in Eq.(3). An Epanechnikov kernel was chosen
  for both kernel-based estimations.</p>
  <p><inline-graphic mimetype="application" mime-subtype="pdf" xlink:href="Fig_2.pdf" />
  Fig. 2: Comparison of exemplary results of obtaining the Kramersâ€“Moyal
  coefficients with a histogram-based approach, a conventional
  kernel-based approach, and the <monospace>kramersmoyal</monospace>
  library, sequentially left to right, from the numerical integration of
  Eq.(4). The top row displays the <italic>drift</italic> coefficient,
  i.e., the first Kramersâ€“Moyal coefficients. The bottom row displays
  the <italic>diffusion</italic> coefficient, i.e., the second
  Kramersâ€“Moyal coefficients. For the histogram
  <inline-formula><alternatives>
  <tex-math><![CDATA[40]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>40</mml:mn></mml:math></alternatives></inline-formula>
  bins were used, for the conventional kernel and this library a space
  with <inline-formula><alternatives>
  <tex-math><![CDATA[5500]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>5500</mml:mn></mml:math></alternatives></inline-formula>
  numerical points were used, with a bandwidth of
  <inline-formula><alternatives>
  <tex-math><![CDATA[0.05]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>0.05</mml:mn></mml:math></alternatives></inline-formula>.
  The total number of points of the numerically integrated data is
  <inline-formula><alternatives>
  <tex-math><![CDATA[5\times10^5]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>5</mml:mn><mml:mo>Ã—</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="library">
  <title>Library</title>
  <p>The presented <monospace>kramersmoyal</monospace> library is
  comprised of two separate blocks, <monospace>kernels</monospace> and
  <monospace>km</monospace>, and is a standalone package for a
  non-parametric retrieval of Kramersâ€“Moyal coefficients, solely
  dependent on <monospace>numpy</monospace> and
  <monospace>scipy</monospace>. The sub-module
  <monospace>kernels</monospace> comprises the kernels for the
  kernel-based estimation, similarly available in
  <monospace>sklearn</monospace>, and <monospace>km</monospace> performs
  the desired Kramersâ€“Moyal calculations to any desired power
  (<xref alt="Pedregosa et al., 2011" rid="ref-scikitlearn" ref-type="bibr">Pedregosa
  et al., 2011</xref>). There exists a library to retrieve Kramersâ€“Moyal
  coefficents in <monospace>R</monospace>
  (<xref alt="Rinn et al., 2016" rid="ref-rinn2016" ref-type="bibr">Rinn
  et al., 2016</xref>).</p>
  <p>In order compare the computational speed up of the library the
  aforementioned Ornsteinâ€“Uhlenbeck Eq.(4) was used (with
  <inline-formula><alternatives>
  <tex-math><![CDATA[\theta = 0.3]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Î¸</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\sigma=0.1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Ïƒ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>),
  and the total time of integration of the process was increased
  iteratively. In Fig. 3 the comparative results of employing a
  histogram estimation with <inline-formula><alternatives>
  <tex-math><![CDATA[200]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>200</mml:mn></mml:math></alternatives></inline-formula>
  bins, a conventional kernel-based regression in a space with
  <inline-formula><alternatives>
  <tex-math><![CDATA[5500]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>5500</mml:mn></mml:math></alternatives></inline-formula>
  numerical points, and this libraryâ€™s kernel-convolution method, over
  similarly <inline-formula><alternatives>
  <tex-math><![CDATA[5500]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>5500</mml:mn></mml:math></alternatives></inline-formula>
  numerical points.</p>
  <p><inline-graphic mimetype="application" mime-subtype="pdf" xlink:href="Fig_3.pdf" />
  Fig. 3: Comparison of speed performance of obtaining the Kramersâ€“Moyal
  coefficients with a histogram-based approach, a conventional
  kernel-based approach, and the <monospace>kramersmoyal</monospace>
  library, of a numerical integration of Eq.(4) over increasing number
  of data points. For the histogram <inline-formula><alternatives>
  <tex-math><![CDATA[200]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>200</mml:mn></mml:math></alternatives></inline-formula>
  bins were used, for the conventional kernel and this library a space
  with <inline-formula><alternatives>
  <tex-math><![CDATA[5500]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>5500</mml:mn></mml:math></alternatives></inline-formula>
  numerical points was used. The total number of points of numerical
  integration was varied between <inline-formula><alternatives>
  <tex-math><![CDATA[5\times10^3]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>5</mml:mn><mml:mo>Ã—</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[5\times10^6]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>5</mml:mn><mml:mo>Ã—</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.
  The horizontal line indicates a total of
  <inline-formula><alternatives>
  <tex-math><![CDATA[1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>
  second. Integration performed on a laptop with an Intel Core i5 CPU
  @<inline-formula><alternatives>
  <tex-math><![CDATA[2.20]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>2.20</mml:mn></mml:math></alternatives></inline-formula>~GHz
  (@<inline-formula><alternatives>
  <tex-math><![CDATA[2.56]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>2.56</mml:mn></mml:math></alternatives></inline-formula>~GHz
  turbo).</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>L. R. G. and F. M. contributed equally to this project with their
  respective expertise. L. R. G. thanks Jan Heysel, Klaus Lehnertz, and
  M. Reza Rahimi Tabar for all the help in understanding stochastic
  processes and developing this package, Dirk Witthaut for the support
  during the process of writing and reviewing, Gerrit Ansmann for the
  help in understanding pythonâ€™s intricacies, and Marieke Helmich for
  the text reviews. L. R. G. gratefully acknowledges support by the
  Helmholtz Association, via the joint initiative <italic>Energy System
  2050 - A Contribution of the Research Field Energy</italic>, the grant
  No.Â VH-NG-1025, the scholarship funding from <italic>E.ON
  Stipendienfonds</italic>, and the <italic>STORM - Stochastics for
  Time-Space Risk Models</italic> project of the Research Council of
  Norway (RCN) No.Â 274410, under the supervision of Giulia di Nunno. F.
  M. gratefully acknowledges the fund, in part, by the Deutsche
  Forschungsgemeinschaft (DFG, German Research Foundation), project
  number 277625399 - CRC 185.</p>
</sec>
</body>
<back>
<ref-list>
  <ref-list>
    <ref id="ref-scikitlearn">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Pedregosa</surname><given-names>F.</given-names></name>
          <name><surname>Varoquaux</surname><given-names>G.</given-names></name>
          <name><surname>Gramfort</surname><given-names>A.</given-names></name>
          <name><surname>Michel</surname><given-names>V.</given-names></name>
          <name><surname>Thirion</surname><given-names>B.</given-names></name>
          <name><surname>Grisel</surname><given-names>O.</given-names></name>
          <name><surname>Blondel</surname><given-names>M.</given-names></name>
          <name><surname>Prettenhofer</surname><given-names>P.</given-names></name>
          <name><surname>Weiss</surname><given-names>R.</given-names></name>
          <name><surname>Dubourg</surname><given-names>V.</given-names></name>
          <name><surname>Vanderplas</surname><given-names>J.</given-names></name>
          <name><surname>Passos</surname><given-names>A.</given-names></name>
          <name><surname>Cournapeau</surname><given-names>D.</given-names></name>
          <name><surname>Brucher</surname><given-names>M.</given-names></name>
          <name><surname>Perrot</surname><given-names>M.</given-names></name>
          <name><surname>Duchesnay</surname><given-names>E.</given-names></name>
        </person-group>
        <article-title>Scikit-learn: Machine learning in Python</article-title>
        <source>Journal of Machine Learning Research</source>
        <year iso-8601-date="2011">2011</year>
        <volume>12</volume>
        <uri>http://www.jmlr.org/papers/v12/pedregosa11a.html</uri>
      </element-citation>
    </ref>
    <ref id="ref-Lehnertz">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Lehnertz</surname><given-names>K.</given-names></name>
          <name><surname>Zabawa</surname><given-names>L.</given-names></name>
          <name><surname>Tabar</surname><given-names>M. R. R.</given-names></name>
        </person-group>
        <article-title>Characterizing abrupt transitions in stochastic dynamics</article-title>
        <source>New Journal of Physics</source>
        <year iso-8601-date="2018">2018</year>
        <volume>20</volume>
        <issue>11</issue>
        <uri>https://doi.org/10.1088%2F1367-2630%2Faaf0d7</uri>
        <pub-id pub-id-type="doi">10.1088/1367-2630/aaf0d7</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Anvari">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Anvari</surname><given-names>M.</given-names></name>
          <name><surname>Tabar</surname><given-names>M. R. R.</given-names></name>
          <name><surname>Peinke</surname><given-names>J.</given-names></name>
          <name><surname>Lehnertz</surname><given-names>K.</given-names></name>
        </person-group>
        <article-title>Disentangling the stochastic behavior of complex time series</article-title>
        <source>Scientific reports</source>
        <year iso-8601-date="2016">2016</year>
        <volume>6</volume>
        <uri>https://doi.org/10.1038/srep35435</uri>
        <pub-id pub-id-type="doi">10.1038/srep35435</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Lamouroux">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Lamouroux</surname><given-names>D.</given-names></name>
          <name><surname>Lehnertz</surname><given-names>K.</given-names></name>
        </person-group>
        <article-title>Kernel-based regression of drift and diffusion coefficients of stochastic processes</article-title>
        <source>Physics Letters A</source>
        <publisher-name>Elsevier</publisher-name>
        <year iso-8601-date="2009">2009</year>
        <volume>373</volume>
        <issue>39</issue>
        <uri>https://doi.org/10.1016/j.physleta.2009.07.073</uri>
        <pub-id pub-id-type="doi">10.1016/j.physleta.2009.07.073</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Ansmann">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Ansmann</surname><given-names>G.</given-names></name>
        </person-group>
        <article-title>Efficiently and easily integrating differential equations with JiTCODE, JiTCDDE, and JiTCSDE</article-title>
        <source>Chaos: An Interdisciplinary Journal of Nonlinear Science</source>
        <year iso-8601-date="2018">2018</year>
        <volume>28</volume>
        <issue>4</issue>
        <uri>https://doi.org/10.1063/1.5019320</uri>
        <pub-id pub-id-type="doi">10.1063/1.5019320</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Sahalia">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>AÃ¯t-Sahalia</surname><given-names>Y.</given-names></name>
        </person-group>
        <article-title>Telling from discrete data whether the underlying continuous-time model is a diffusion</article-title>
        <source>The Journal of Finance</source>
        <year iso-8601-date="2002">2002</year>
        <volume>57</volume>
        <uri>https://doi.org/10.1111/1540-6261.00489</uri>
        <pub-id pub-id-type="doi">10.1111/1540-6261.00489</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Rydin">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>GorjÃ£o</surname><given-names>L. R.</given-names></name>
          <name><surname>Heysel</surname><given-names>J.</given-names></name>
          <name><surname>Lehnertz</surname><given-names>K.</given-names></name>
          <name><surname>Tabar</surname><given-names>M. R. R.</given-names></name>
        </person-group>
        <article-title>Analysis and data-driven reconstruction of bivariate jump-diffusion processes</article-title>
        <source>Physical Review E</source>
        <year iso-8601-date="2019">2019</year>
        <volume>(in press)</volume>
        <uri>https://arxiv.org/abs/1907.05371</uri>
      </element-citation>
    </ref>
    <ref id="ref-rinn2016">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Rinn</surname><given-names>P.</given-names></name>
          <name><surname>Lind</surname><given-names>P.</given-names></name>
          <name><surname>WÃ¤chter</surname><given-names>M.</given-names></name>
          <name><surname>Peinke</surname><given-names>J.</given-names></name>
        </person-group>
        <article-title>The Langevin approach: An R package for modeling Markov processes</article-title>
        <source>Journal of Open Research Software</source>
        <year iso-8601-date="2016">2016</year>
        <volume>4</volume>
        <pub-id pub-id-type="doi">10.5334/jors.123</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Silverman">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name><surname>Silverman</surname><given-names>B. W.</given-names></name>
        </person-group>
        <source>Density estimation for statistics and data analysis</source>
        <publisher-name>Routledge, New York</publisher-name>
        <year iso-8601-date="2018">2018</year>
        <isbn>9781315140919</isbn>
        <pub-id pub-id-type="doi">10.1201/9781315140919</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Tabar">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name><surname>Tabar</surname><given-names>M. R. R.</given-names></name>
        </person-group>
        <source>Analysis and data-based reconstruction of complex nonlinear dynamical systems</source>
        <publisher-name>Springer International Publishing</publisher-name>
        <year iso-8601-date="2019">2019</year>
        <isbn>978-3-030-18471-1</isbn>
        <uri>https://www.springer.com/gp/book/9783030184711</uri>
        <pub-id pub-id-type="doi">10.1007/978-3-030-18472-8</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Risken">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name><surname>Risken</surname><given-names>H.</given-names></name>
        </person-group>
        <source>The Fokkerâ€“Planck Equation</source>
        <publisher-name>Springer, Berlin</publisher-name>
        <year iso-8601-date="1996">1996</year>
        <isbn>978-3-540-61530-9</isbn>
        <pub-id pub-id-type="doi">10.1007/978-3-642-61544-3</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Nadaraya">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Nadaraya</surname><given-names>E. A.</given-names></name>
        </person-group>
        <article-title>On estimating regression</article-title>
        <source>Theory of Probability &amp; Its Applications</source>
        <year iso-8601-date="1964">1964</year>
        <volume>9</volume>
        <issue>1</issue>
        <uri>https://doi.org/10.1137/1109020</uri>
        <pub-id pub-id-type="doi">10.1137/1109020</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Watson">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Watson</surname><given-names>Geoffrey S.</given-names></name>
        </person-group>
        <article-title>Smooth regression analysis</article-title>
        <source>SankhyÄ: The Indian Journal of Statistics, Series A</source>
        <publisher-name>Springer</publisher-name>
        <year iso-8601-date="1964">1964</year>
        <volume>26</volume>
        <issue>4</issue>
        <issn>0581572X</issn>
        <uri>http://www.jstor.org/stable/25049340</uri>
      </element-citation>
    </ref>
  </ref-list>
</ref-list>
</back>
</article>
