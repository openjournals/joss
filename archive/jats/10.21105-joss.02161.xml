<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">2161</article-id>
<article-id pub-id-type="doi">10.21105/joss.02161</article-id>
<title-group>
<article-title>graphsim: An R package for simulating gene expression
data from graph structures of biological pathways</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0003-3904-6690</contrib-id>
<string-name>S. Thomas Kelly</string-name>
<email>tom.kelly@postgrad.otago.ac.nz</email>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0003-1174-6054</contrib-id>
<string-name>Michael A. Black</string-name>
<email>mik.black@otago.ac.nz</email>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Biochemistry, University of Otago, PO Box 56,
Dunedin 9054, New Zealand</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>RIKEN Center for Integrative Medical Sciences,
Suehiro-cho-1-7-22, Tsurumi Ward, Yokohama, Kanagawa 230-0045,
Japan</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2020-06-24">
<day>24</day>
<month>6</month>
<year>2020</year>
</pub-date>
<volume>5</volume>
<issue>51</issue>
<fpage>2161</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2021</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>gene-expression</kwd>
<kwd>simulation</kwd>
<kwd>genomics</kwd>
<kwd>pathway</kwd>
<kwd>network</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Transcriptomic analysis is used to capture the molecular state of a
  cell or sample in many biological and medical applications. In
  addition to identifying alterations in activity at the level of
  individual genes, understanding changes in the gene networks that
  regulate fundamental biological mechanisms is also an important
  objective of molecular analysis. As a result, databases that describe
  biological pathways are increasingly uesad to assist with the
  interpretation of results from large-scale genomics studies.
  Incorporating information from biological pathways and gene regulatory
  networks into a genomic data analysis is a popular strategy, and there
  are many methods that provide this functionality for gene expression
  data. When developing or comparing such methods, it is important to
  gain an accurate assessment of their performance. Simulation-based
  validation studies are frequently used for this. This necessitates the
  use of simulated data that correctly accounts for pathway
  relationships and correlations. Here we present a versatile
  statistical framework to simulate correlated gene expression data from
  biological pathways, by sampling from a multivariate normal
  distribution derived from a graph structure. This procedure has been
  released as the <monospace>graphsim</monospace> R package on CRAN and
  GitHub
  (<ext-link ext-link-type="uri" xlink:href="https://github.com/TomKellyGenetics/graphsim">https://github.com/TomKellyGenetics/graphsim</ext-link>)
  and is compatible with any graph structure that can be described using
  the <monospace>igraph</monospace> package. This package allows the
  simulation of biological pathways from a graph structure based on a
  statistical model of gene expression.</p>
</sec>
<sec id="secU003Aintro">
  <title>Introduction: inference and modelling of biological
  networks</title>
  <p>Network analysis of molecular biological pathways has the potential
  to lead to new insights into biology and medical genetics
  (<xref alt="Barabási &amp; Oltvai, 2004" rid="ref-Barabasi2004" ref-type="bibr">Barabási
  &amp; Oltvai, 2004</xref>;
  <xref alt="Hu et al., 2016" rid="ref-Hu2016" ref-type="bibr">Hu et
  al., 2016</xref>). Since gene expression profiles capture a consistent
  signature of the regulatory state of a cell
  (<xref alt="Ozsolak &amp; Milos, 2011" rid="ref-Ozsolak2011" ref-type="bibr">Ozsolak
  &amp; Milos, 2011</xref>;
  <xref alt="Perou et al., 2000" rid="ref-Perou2000" ref-type="bibr">Perou
  et al., 2000</xref>;
  <xref alt="Svensson et al., 2018" rid="ref-Svensson2018" ref-type="bibr">Svensson
  et al., 2018</xref>), they can be used to analyse complex molecular
  states with genome-scale data. However, biological pathways are often
  analysed in a reductionist paradigm as amorphous sets of genes
  involved in particular functions, despite the fact that the
  relationships defined by pathway structure could further inform gene
  expression analyses. In many cases, the pathway relationships are
  well-defined, experimentally-validated, and are available in public
  databases
  (<xref alt="Croft et al., 2014" rid="ref-Reactome" ref-type="bibr">Croft
  et al., 2014</xref>). As a result, network analysis techniques can
  play an important role in furthering our understanding of biological
  pathways and aiding in the interpretation of genomics studies.</p>
  <p>Gene networks provide insights into how cells are regulated, by
  mapping regulatory interactions between target genes and transcription
  factors, enhancers, and sites of epigenetic marks or chromatin
  structures
  (<xref alt="Barabási &amp; Oltvai, 2004" rid="ref-Barabasi2004" ref-type="bibr">Barabási
  &amp; Oltvai, 2004</xref>;
  <xref alt="Yamaguchi et al., 2007" rid="ref-Yamaguchi2007" ref-type="bibr">Yamaguchi
  et al., 2007</xref>). Inference using these regulatory interactions
  genomic analysis has the potential to radically expand the range of
  candidate biological pathways to be further explored, or to improve
  the accuracy of bioinformatics and functional genomic analysis. A
  number of methods have been developed to utilise timecourse gene
  expression data
  (<xref alt="Arner et al., 2015" rid="ref-Arner2015" ref-type="bibr">Arner
  et al., 2015</xref>;
  <xref alt="Yamaguchi et al., 2007" rid="ref-Yamaguchi2007" ref-type="bibr">Yamaguchi
  et al., 2007</xref>) using gene regulatory modules in state-space
  models and recursive vector autoregressive models
  (<xref alt="Hirose et al., 2008" rid="ref-Hirose2008" ref-type="bibr">Hirose
  et al., 2008</xref>;
  <xref alt="Shimamura et al., 2009" rid="ref-Shimamura2009" ref-type="bibr">Shimamura
  et al., 2009</xref>). Various approaches to gene regulation and
  networks at the genome-wide scale have led to novel biological
  insights
  (<xref alt="Arner et al., 2015" rid="ref-Arner2015" ref-type="bibr">Arner
  et al., 2015</xref>;
  <xref alt="Komatsu et al., 2013" rid="ref-Komatsu2013" ref-type="bibr">Komatsu
  et al., 2013</xref>), however, inference of regulatory networks has
  thus far primarily relied on experimental validation or
  resampling-based approaches to estimate the likelihood of specific
  network modules being predicted
  (<xref alt="Hawe et al., 2019" rid="ref-Hawe2019" ref-type="bibr">Hawe
  et al., 2019</xref>;
  <xref alt="Markowetz &amp; Spang, 2007" rid="ref-Markowetz2007" ref-type="bibr">Markowetz
  &amp; Spang, 2007</xref>).</p>
  <p>Simulating datasets that account for pathway structure are of
  particular interest for benchmarking regulatory network inference
  techniques and methods being developed for genomics data containing
  complex biological interactions
  (<xref alt="Saelens et al., 2019" rid="ref-Saelens2019" ref-type="bibr">Saelens
  et al., 2019</xref>;
  <xref alt="Schaffter et al., 2011" rid="ref-Schaffter2011" ref-type="bibr">Schaffter
  et al., 2011</xref>). Dynamical models using differential equations
  have been employed, such as by GeneNetWeaver
  (<xref alt="Schaffter et al., 2011" rid="ref-Schaffter2011" ref-type="bibr">Schaffter
  et al., 2011</xref>), to generate simulated datasets specifically for
  benchmarking gene regulatory network inference techniques. There is
  also renewed interest in modelling biological pathways and simulating
  data for benchmarking due to the emergence of single-cell genomics
  technologies and the growing number of bioinformatics techniques
  developed to use this data
  (<xref alt="Saelens et al., 2019" rid="ref-Saelens2019" ref-type="bibr">Saelens
  et al., 2019</xref>;
  <xref alt="Zappia et al., 2017" rid="ref-Zappia2017" ref-type="bibr">Zappia
  et al., 2017</xref>). Packages such as ‘splatter’
  (<xref alt="Zappia et al., 2017" rid="ref-Zappia2017" ref-type="bibr">Zappia
  et al., 2017</xref>), which uses the gamma-poisson distribution, have
  been developed to model single-cell data. SERGIO
  (<xref alt="Dibaeinia &amp; Sinha, 2019" rid="ref-Dibaeinia2019" ref-type="bibr">Dibaeinia
  &amp; Sinha, 2019</xref>) and dyngen
  (<xref alt="Cannoodt et al., 2020" rid="ref-Cannoodt2020" ref-type="bibr">Cannoodt
  et al., 2020</xref>) build on this by adding gene regulatory networks
  and multimodality respectively. These methods have been designed based
  on known deterministic relationships or synthetic reaction states, to
  which stochasticity is then added. However, it is
  computationally-intensive to model these reactions at scale or run
  many iterations for benchmarking. In some cases, it is only necessary
  to model the statistical variability and “noise” of RNA-Seq data in
  order to evaluate methods in the presence of multivariate correlation
  structures.</p>
  <p>There is a need, therefore, for a systematic framework for
  statistical modelling and simulation of gene expression data derived
  from hypothetical, inferred or known gene networks. Here we present a
  package to achieve this, where samples from a multivariate normal
  distribution are used to generate normally-distributed log-expression
  data, with correlations between genes derived from the structure of
  the underlying pathway or gene regulatory network. This methodology
  enables simulation of expression profiles that approximate the
  log-transformed and normalised data from microarray studies, as well
  as, bulk or single-cell RNA-Seq experiments. This procedure has been
  released as the <monospace>graphsim</monospace> package to enable the
  generation of simulated gene expression datasets containing pathway
  relationships from a known underlying network. These simulated
  datasets can be used to evaluate various bioinformatics methodologies,
  including statistical and network inference procedures.</p>
</sec>
<sec id="secU003Amethods">
  <title>Methodology and software</title>
  <p>Here we present a procedure to simulate gene expression data with
  correlation structure derived from a known graph structure. This
  procedure assumes that transcriptomic data have been generated and
  follow a log-normal distribution (i.e., <inline-formula><alternatives>
  <tex-math><![CDATA[log(X_{ij}) \sim MVN({\mathbf{\mu}}, \Sigma)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mi>M</mml:mi><mml:mi>V</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>𝛍</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mi>Σ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  where <inline-formula><alternatives>
  <tex-math><![CDATA[{\mathbf{\mu}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mstyle mathvariant="bold"><mml:mi>𝛍</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\Sigma]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Σ</mml:mi></mml:math></alternatives></inline-formula>
  are the mean vector and variance-covariance matrix respectively, for
  gene expression data derived from a biological pathway) after
  appropriate normalisation
  (<xref alt="Law et al., 2014" rid="ref-Law2014" ref-type="bibr">Law et
  al., 2014</xref>;
  <xref alt="Li et al., 2015" rid="ref-Li2015" ref-type="bibr">Li et
  al., 2015</xref>). Log-normality of gene expression matches the
  assumptions of the popular <monospace>limma</monospace> package
  (<xref alt="Matthew E R. et al., 2015" rid="ref-limma" ref-type="bibr">Matthew
  E R. et al., 2015</xref>), which is often used for the analysis of
  intensity-based data from gene expression microarray studies and
  count-based data from RNA-Seq experiments. This approach has also been
  applied for modelling UMI-based count data from single-cell RNA-Seq
  experiments in the <monospace>DESCEND</monospace> R package
  (<xref alt="Wang et al., 2018" rid="ref-Wang2018" ref-type="bibr">Wang
  et al., 2018</xref>).</p>
  <p>In order to simulate transcriptomic data, a pathway is first
  constructed as a graph structure, using the
  <monospace>igraph</monospace> R package
  (<xref alt="Csardi &amp; Nepusz, 2006" rid="ref-igraph" ref-type="bibr">Csardi
  &amp; Nepusz, 2006</xref>), with the status of the edge relationships
  defined (i.e, whether they activate or inhibit downstream pathway
  members). <styled-content style="color: black">This procedure
  uses</styled-content> a graph structure such as that presented in
  Figure <xref alt="1a" rid="figU003Asimple_graphU003Afirst">1a</xref>.
  The graph can be defined by an adjacency matrix,
  <bold><inline-formula><alternatives>
  <tex-math><![CDATA[A]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>A</mml:mi></mml:math></alternatives></inline-formula></bold>
  (with elements <inline-formula><alternatives>
  <tex-math><![CDATA[A_{ij}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>),
  where <disp-formula><alternatives>
  <tex-math><![CDATA[A_{ij} = 
  \begin{cases}
     1   & \mbox{if genes } i \mbox{ and } j \mbox{ are adjacent} \\
     0   & \mbox{otherwise}
  \end{cases}]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext mathvariant="normal">if genes </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mspace width="0.333em"></mml:mspace><mml:mtext mathvariant="normal"> and </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mspace width="0.333em"></mml:mspace><mml:mtext mathvariant="normal"> are adjacent</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mtext mathvariant="normal">otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>A matrix, <bold><inline-formula><alternatives>
  <tex-math><![CDATA[R]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>R</mml:mi></mml:math></alternatives></inline-formula></bold>,
  with elements
  <styled-content style="color: black"><inline-formula><alternatives>
  <tex-math><![CDATA[R_{ij}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula></styled-content>,
  is calculated based on distance (i.e., number of edges contained in
  the shortest path) between nodes, such that closer nodes are given
  more weight than more distant nodes, to define inter-node
  relationships. A geometrically-decreasing (relative) distance
  weighting is used to achieve this:</p>
  <p><styled-content style="color: black"><disp-formula><alternatives>
  <tex-math><![CDATA[R_{ij} = 
  \begin{cases}
     1  & \mbox{if genes } i \mbox{ and } j \mbox{ are adjacent} \\
     (\frac{1}{2})^{d_{ij}}  & \mbox{if a path can be found between genes } i \mbox{ and } j \\
     0  & \mbox{if no path exists between genes } i \mbox{ and } j 
  \end{cases}]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext mathvariant="normal">if genes </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mspace width="0.333em"></mml:mspace><mml:mtext mathvariant="normal"> and </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mspace width="0.333em"></mml:mspace><mml:mtext mathvariant="normal"> are adjacent</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext mathvariant="normal">if a path can be found between genes </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mspace width="0.333em"></mml:mspace><mml:mtext mathvariant="normal"> and </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>j</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext mathvariant="normal">if no path exists between genes </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mspace width="0.333em"></mml:mspace><mml:mtext mathvariant="normal"> and </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>j</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[d_{ij}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  is the length of the shortest path (i.e., minimum number of edges
  traversed) between genes (nodes) <inline-formula><alternatives>
  <tex-math><![CDATA[i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
  in graph <inline-formula><alternatives>
  <tex-math><![CDATA[G]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>G</mml:mi></mml:math></alternatives></inline-formula>.
  Each more distant node is thus related by
  <inline-formula><alternatives>
  <tex-math><![CDATA[\frac{1}{2}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:math></alternatives></inline-formula>
  compared to the next nearest, as shown in
  Figure <xref alt="2b" rid="figU003Asimulation_activatingU003Asecond">2b</xref>.
  An arithmetically-decreasing (absolute) distance weighting is also
  supported in the <monospace>graphsim</monospace> R package which
  implements this procedure:
  <styled-content style="color: black"><disp-formula><alternatives>
  <tex-math><![CDATA[R_{ij} = 
  \begin{cases}
     1  & \mbox{if genes } i \mbox{ and } j \mbox{ are adjacent} \\
     1-\frac{d_{ij}}{diam(G)}   & \mbox{if a path can be found between genes } i \mbox{ and } j \\
     0  & \mbox{if no path exists between genes } i \mbox{ and } j 
  \end{cases}]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext mathvariant="normal">if genes </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mspace width="0.333em"></mml:mspace><mml:mtext mathvariant="normal"> and </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mspace width="0.333em"></mml:mspace><mml:mtext mathvariant="normal"> are adjacent</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext mathvariant="normal">if a path can be found between genes </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mspace width="0.333em"></mml:mspace><mml:mtext mathvariant="normal"> and </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>j</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext mathvariant="normal">if no path exists between genes </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mspace width="0.333em"></mml:mspace><mml:mtext mathvariant="normal"> and </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>j</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
  <p>Assuming a unit variance for each gene, these values can be used to
  derive a <inline-formula><alternatives>
  <tex-math><![CDATA[\Sigma]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Σ</mml:mi></mml:math></alternatives></inline-formula>
  matrix: <disp-formula><alternatives>
  <tex-math><![CDATA[\Sigma_{ij} = 
  \begin{cases}
     1  & \mbox{if } i=j \\
     \rho R_{ij}  & \mbox{otherwise}
  \end{cases}]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext mathvariant="normal">if </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>ρ</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mtext mathvariant="normal">otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[\rho]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ρ</mml:mi></mml:math></alternatives></inline-formula>
  is the correlation between adjacent nodes. Thus covariances between
  adjacent nodes are assigned by a correlation parameter
  (<inline-formula><alternatives>
  <tex-math><![CDATA[\rho]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ρ</mml:mi></mml:math></alternatives></inline-formula>)
  and the remaining off-diagonal values in the matrix are based on
  scaling these correlations by the geometrically weighted relationship
  matrix (or the nearest positive definite matrix for
  <inline-formula><alternatives>
  <tex-math><![CDATA[\Sigma]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Σ</mml:mi></mml:math></alternatives></inline-formula>
  with negative correlations).
  </p>
  <p>Computing the nearest positive definite matrix is necessary to
  ensure that the variance-covariance matrix can be inverted when used
  as a parameter in multivariate normal simulations, particularly when
  negative correlations are included for inhibitions (as shown below).
  Matrices that cannot be inverted occur rarely with biologically
  plausible graph structures but this approach allows for the
  computation of a plausible correlation matrix when the given graph
  structure is incomplete or contains loops. When required, the nearest
  positive definite matrix is computed using the
  <monospace>nearPD</monospace> function of the
  <monospace>Matrix</monospace> R package
  (<xref alt="Bates &amp; Maechler, 2016" rid="ref-Matrix" ref-type="bibr">Bates
  &amp; Maechler, 2016</xref>) to perform Higham’s algorithm
  (<xref alt="Higham, 2002" rid="ref-Higham2002" ref-type="bibr">Higham,
  2002</xref>) on variance-covariance matrices. The
  <monospace>graphsim</monospace> package gives a warning when this
  occurs.</p>
</sec>
<sec id="secU003Aillustrations">
  <title>Illustrations</title>
  <sec id="secU003Aplot_graph">
    <title>Generating a Graph Structure</title>
    <p>The graph structure in
    Figure <xref alt="1a" rid="figU003Asimple_graphU003Afirst">1a</xref>
    was used to simulate correlated gene expression data by sampling
    from a multivariate normal distribution using the
    <monospace>mvtnorm</monospace> R package
    (<xref alt="Genz et al., 2016" rid="ref-mvtnorm" ref-type="bibr">Genz
    et al., 2016</xref>;
    <xref alt="Genz &amp; Bretz, 2009" rid="ref-Genz2009" ref-type="bibr">Genz
    &amp; Bretz, 2009</xref>). The graph structure visualisation in
    Figure <xref alt="1" rid="figU003Asimple_graph">1</xref> was
    specifically developed for (directed) <monospace>igraph</monospace>
    objects in and is available in the <monospace>graphsim</monospace>
    package. The <monospace>plot_directed</monospace> function enables
    customisation of plot parameters for each node or edge, and mixed
    (directed) edge types for indicating activation or inhibition. These
    inhibition links (which occur frequently in biological pathways) are
    demonstrated in
    Figure <xref alt="1b" rid="figU003Asimple_graphU003Asecond">1b</xref>.</p>
    <fig id="figU003Asimple_graph" orientation="portrait">
        <label>Figure 1</label>
        <caption>
            <p><bold>Simulated graph structures</bold>. A constructed graph structure used as an example to demonstrate the simulation procedure in Figures 2 and 3. Activating links are denoted by black arrows and inhibiting links by red edges.</p>
        </caption>
        <graphic mimetype="application" mime-subtype="pdf" xlink:href="Plotsimple_graph-1.pdf" id="figU003Asimple_graphU003Afirst" />
        <graphic mimetype="application" mime-subtype="pdf" xlink:href="Plotsimple_graph-2.pdf" id="figU003Asimple_graphU003Asecond" />
    </fig>
    <p>A graph structure can be generated and plotted using the
    following commands in R:</p>
    <code language="r script">#install packages required (once per computer)
install.packages(&quot;graphsim&quot;)</code>
    <code language="r script">#load required packages (once per R instance)
library(&quot;graphsim&quot;)
#load packages for examples
library(&quot;igraph&quot;); library(&quot;gplots&quot;); library(&quot;scales&quot;)</code>
    <code language="r script">#generate graph structure
graph_edges &lt;- rbind(c(&quot;A&quot;, &quot;C&quot;), c(&quot;B&quot;, &quot;C&quot;), c(&quot;C&quot;, &quot;D&quot;), c(&quot;D&quot;, &quot;E&quot;),
   c(&quot;D&quot;, &quot;F&quot;), c(&quot;F&quot;, &quot;G&quot;), c(&quot;F&quot;, &quot;I&quot;), c(&quot;H&quot;, &quot;I&quot;))
graph &lt;- graph.edgelist(graph_edges, directed = TRUE)

#generate parameters for inhibitions for each edge in E(graph)
state &lt;- c(1, 1, -1, 1, 1, 1, 1, -1)
#plot graph structure with inhibitions
plot_directed(graph, state=state, layout = layout.kamada.kawai,
  cex.node = 2, cex.arrow = 4, arrow_clip = 0.2)</code>
  </sec>
  <sec id="secU003Agraphsim_demo">
    <title>Generating a Simulated Expression Dataset</title>
    <p>The correlation parameter of <inline-formula><alternatives>
    <tex-math><![CDATA[\rho = 0.8]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    is used to demonstrate the inter-correlated datasets using a
    geometrically-generated relationship matrix (as used for the example
    in
    Figure <xref alt="2c" rid="figU003Asimulation_activatingU003Athird">2c</xref>).
    This <inline-formula><alternatives>
    <tex-math><![CDATA[\Sigma]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Σ</mml:mi></mml:math></alternatives></inline-formula>
    matrix was then used to sample from a multivariate normal
    distribution such that each gene had a mean of
    <inline-formula><alternatives>
    <tex-math><![CDATA[0]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>0</mml:mn></mml:math></alternatives></inline-formula>,
    standard deviation <inline-formula><alternatives>
    <tex-math><![CDATA[1]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>,
    and covariance within the range <inline-formula><alternatives>
    <tex-math><![CDATA[[0,1]]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
    so that the off-diagonal elements of <inline-formula><alternatives>
    <tex-math><![CDATA[\Sigma]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Σ</mml:mi></mml:math></alternatives></inline-formula>
    represent correlations. This procedure generated a simulated
    (continuous normally-distributed) log-expression profile for each
    node
    (Figure <xref alt="2e" rid="figU003Asimulation_activatingU003Afourth">2e</xref>)
    with a corresponding correlation structure
    (Figure <xref alt="2d" rid="figU003Asimulation_activatingU003Afifth">2d</xref>).
    The simulated correlation structure closely resembled the expected
    correlation structure (<inline-formula><alternatives>
    <tex-math><![CDATA[\Sigma]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Σ</mml:mi></mml:math></alternatives></inline-formula>
    in
    Figure <xref alt="2c" rid="figU003Asimulation_activatingU003Athird">2c</xref>)
    even for the relatively modest sample size
    (<inline-formula><alternatives>
    <tex-math><![CDATA[N=100]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>)
    illustrated in
    Figure <xref alt="2" rid="figU003Asimulation_activating">2</xref>.
    Once a gene expression dataset comprising multiple pathways has been
    generated (as in
    Figure <xref alt="2e" rid="figU003Asimulation_activatingU003Afourth">2e</xref>),
    it can then be used to test procedures designed for analysis of
    empirical gene expression data (such as those generated by
    microarrays or RNA-Seq) that have been normalised on a
    log-scale.</p>
    <fig id="figU003Asimulation_activating">
        <label>Figure 2</label>
        <caption>
    <p><bold>Simulating expression from a graph structure</bold>. An example
    of a graph structure (a) that has been used to derive a relationship
    matrix (b), <inline-formula><alternatives>
    <tex-math><![CDATA[\Sigma]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Σ</mml:mi></mml:math></alternatives></inline-formula>
    matrix (c) and correlation structure (d) from the relative distances
    between the nodes. Non-negative values are coloured white to red from
    <inline-formula><alternatives>
    <tex-math><![CDATA[0]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>0</mml:mn></mml:math></alternatives></inline-formula>
    to <inline-formula><alternatives>
    <tex-math><![CDATA[1]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>
    (e). The <inline-formula><alternatives>
    <tex-math><![CDATA[\Sigma]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Σ</mml:mi></mml:math></alternatives></inline-formula>
    matrix has been used to generate a simulated expression dataset of 100
    samples (coloured blue to red from low to high) via sampling from the
    multivariate normal distribution. Here genes with closer relationships
    in the pathway structure show a higher correlation between simulated
    values.</p>
        </caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="Plotsimulation_activating-1.pdf" id="figU003Asimulation_activatingU003Afirst" />
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="Plotsimulation_activating-2.pdf" id="figU003Asimulation_activatingU003Asecond" />
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="Plotsimulation_activating-3.pdf" id="figU003Asimulation_activatingU003Athird" />
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="Plotsimulation_activating-4.pdf" id="figU003Asimulation_activatingU003Afourth" />
    <graphic mimetype="image" mime-subtype="" xlink:href="Plotsimulation_activating-5" id="figU003Asimulation_activatingU003Afifth" />
    </fig>
    <p>The simulated dataset can be generated using the following
    code:</p>
    <code language="r script">#plot relationship matrix
heatmap.2(make_distance_graph(graph, absolute = FALSE),
  scale = &quot;none&quot;, trace = &quot;none&quot;, col = colorpanel(50, &quot;white&quot;, &quot;red&quot;),
  colsep = 1:length(V(graph)), rowsep = 1:length(V(graph)))

#plot sigma matrix
heatmap.2(make_sigma_mat_dist_graph(graph, cor = 0.8, absolute = FALSE),
  scale = &quot;none&quot;, trace = &quot;none&quot;, col = colorpanel(50, &quot;white&quot;, &quot;red&quot;),
  colsep = 1:length(V(graph)), rowsep = 1:length(V(graph)))

#simulate data
expr &lt;- generate_expression(100, graph, cor = 0.8, mean = 0,
  comm = FALSE, dist =TRUE, absolute = FALSE, state = state)
#plot simulated correlations
heatmap.2(cor(t(expr)), scale = &quot;none&quot;, trace = &quot;none&quot;,
          col = colorpanel(50, &quot;white&quot;, &quot;red&quot;),
  colsep = 1:length(V(graph)), rowsep = 1:length(V(graph)))
#plot simulated expression data
heatmap.2(expr, scale = &quot;none&quot;, trace = &quot;none&quot;, col = bluered(50),
  colsep = 1:length(V(graph)), rowsep = 1:length(V(graph)), labCol = &quot;&quot;)</code>
    <p>The simulation procedure
    (Figure <xref alt="2" rid="figU003Asimulation_activating">2</xref>)
    can similarly be used for pathways containing inhibitory links
    (Figure <xref alt="3" rid="figU003Asimulation_inhibiting">3</xref>)
    with several refinements. With the inhibitory links
    (Figure <xref alt="3a" rid="figU003Asimulation_inhibitingU003Afirst">3a</xref>),
    distances are calculated in the same manner as before
    (Figure <xref alt="3b" rid="figU003Asimulation_inhibitingU003Asecond">3b</xref>)
    with inhibitions accounted for by iteratively multiplying downstream
    nodes by <inline-formula><alternatives>
    <tex-math><![CDATA[-1]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    to form modules with negative correlations between them
    (Figures <xref alt="3c" rid="figU003Asimulation_inhibitingU003Athird">3c</xref>
    and <xref alt="3d" rid="figU003Asimulation_inhibitingU003Afifth">3d</xref>).
    A multivariate normal distribution with these negative correlations
    can be sampled to generate simulated data
    (Figure <xref alt="3e" rid="figU003Asimulation_inhibitingU003Afourth">3e</xref>).</p>
    <p>The following changes are needed to handle inhibitions:</p>
    <code language="r script">#generate parameters for inhibitions
state &lt;- c(1, 1, -1, 1, 1, 1, 1, -1)
plot_directed(graph, state=state, layout = layout.kamada.kawai,
  cex.node=2, cex.arrow=4, arrow_clip = 0.2)

#plot sigma matrix for inhibitions
heatmap.2(make_sigma_mat_dist_graph(graph, state, cor = 0.8, absolute = FALSE),
  scale = &quot;none&quot;, trace = &quot;none&quot;, col = colorpanel(50, &quot;blue&quot;, &quot;white&quot;, &quot;red&quot;),
  colsep = 1:length(V(graph)), rowsep = 1:length(V(graph)))

#simulate data for inhibitions
expr &lt;- generate_expression(100, graph, state, cor = 0.8, mean = 0,
  comm = FALSE, dist =TRUE, absolute = FALSE)</code>
    <p>The simulation procedure is also demonstrated here
    (Figure <xref alt="4" rid="figU003Asimulation_smad">4</xref>) on a
    pathway structure for a known biological pathway (Reactome pathway
    R-HSA-2173789): “TGF-<inline-formula><alternatives>
    <tex-math><![CDATA[\beta]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>β</mml:mi></mml:math></alternatives></inline-formula>
    receptor signaling activates SMADs”
    (Figure <xref alt="4a" rid="figU003Asimulation_smadU003Afirst">4a</xref>)
    derived from the Reactome database version 52
    (<xref alt="Croft et al., 2014" rid="ref-Reactome" ref-type="bibr">Croft
    et al., 2014</xref>). Distances are calculated in the same manner as
    before
    (Figure <xref alt="4b" rid="figU003Asimulation_smadU003Asecond">4b</xref>)
    producing blocks of correlated genes
    (Figures <xref alt="4c" rid="figU003Asimulation_smadU003Athird">4c</xref>
    and <xref alt="4d" rid="figU003Asimulation_smadU003Afifth">4d</xref>).
    This shows that the multivariate normal distribution can be sampled
    to generate simulated data to represent expression with the
    complexity of a biological pathway
    (Figure <xref alt="4e" rid="figU003Asimulation_smadU003Afourth">4e</xref>).
    Here <italic>SMAD7</italic> exhibits negative correlations with the
    other SMADs consistent with its functions as an “inhibitor SMAD”
    which competitively inhibits <italic>SMAD4</italic>.</p>
    <fig id="figU003Asimulation_inhibiting" orientation="portrait">
        <label>Figure 3</label>
        <caption>
    <p><bold>Simulating expression from graph structure with
    inhibitions</bold>. An example of a graph structure (a), that has been
    used to derive a relationship matrix (b), <inline-formula><alternatives>
    <tex-math><![CDATA[\Sigma]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Σ</mml:mi></mml:math></alternatives></inline-formula>
    matrix (c), and correlation structure (d), from the relative distances
    between the nodes. These values are coloured blue to red from
    <inline-formula><alternatives>
    <tex-math><![CDATA[-1]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    to <inline-formula><alternatives>
    <tex-math><![CDATA[1]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>
    (e). This has been used to generate a simulated expression dataset of
    100 samples (coloured blue to red from low to high) via sampling from
    the multivariate normal distribution. Here the inhibitory relationships
    between genes are reflected in negatively correlated simulated
    values.</p>
        </caption>
        <graphic mimetype="application" mime-subtype="pdf" xlink:href="Plotsimulation_inhibiting-1.pdf" id="figU003Asimulation_inhibitingU003Afirst" />
        <graphic mimetype="application" mime-subtype="pdf" xlink:href="Plotsimulation_inhibiting-2.pdf" id="figU003Asimulation_inhibitingU003Asecond" />
        <graphic mimetype="application" mime-subtype="pdf" xlink:href="Plotsimulation_inhibiting-3.pdf" id="figU003Asimulation_inhibitingU003Athird" />
        <graphic mimetype="application" mime-subtype="pdf" xlink:href="Plotsimulation_inhibiting-4.pdf" id="figU003Asimulation_inhibitingU003Afourth" />
        <graphic mimetype="application" mime-subtype="pdf" xlink:href="Plotsimulation_inhibiting-5.pdf" id="figU003Asimulation_inhibitingU003Afifth" />
    </fig>
    <p>We can import the graph structure into R as follows and run
    simulations as above:</p>
    <code language="r script">#import graph from data
graph &lt;- identity(TGFBeta_Smad_graph)
#generate parameters for inhibitions
state &lt;- E(graph)$state

plot_directed(graph, state = state, layout = layout.kamada.kawai,
  border.node=alpha(&quot;black&quot;, 0.75), fill.node=&quot;lightblue&quot;,
  col.arrow = c(alpha(&quot;navyblue&quot;, 0.25), alpha(&quot;red&quot;, 0.25))[state], 
  cex.node = 1.5, cex.label = 0.8, cex.arrow = 2)</code>
    <p>These simulated datasets can also be used for simulating gene
    expression data within a graph network to test genomic analysis
    techniques. Correlation structure can be included in datasets
    generated for testing whether true positive genes or samples can be
    detected in a sample with the background of complex pathway
    structure.</p>
    <fig id="figU003Asimulation_smad" orientation="portrait">
        <label>Figure 4</label>
        <caption>
    <p><bold>Simulating expression from a biological pathway graph
    structure</bold>. The graph structure (a) of a known biological pathway,
    &quot;TGF-<inline-formula><alternatives>
    <tex-math><![CDATA[\beta]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>β</mml:mi></mml:math></alternatives></inline-formula>
    receptor signaling activates SMADs&quot; (R-HSA-2173789), was used to
    derive a relationship matrix (b), <inline-formula><alternatives>
    <tex-math><![CDATA[\Sigma]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Σ</mml:mi></mml:math></alternatives></inline-formula>
    matrix (c) and correlation structure (d) from the relative distances
    between the nodes. These values are coloured blue to red from
    <inline-formula><alternatives>
    <tex-math><![CDATA[-1]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    to <inline-formula><alternatives>
    <tex-math><![CDATA[1]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>
    (e). This has been used to generate a simulated expression dataset of
    100 samples (coloured blue to red from low to high) via sampling from
    the multivariate normal distribution. Here modules of genes with
    correlated expression can be clearly discerned.</p>
        </caption>
        <graphic mimetype="application" mime-subtype="pdf" xlink:href="Plotsimulation_smad-1.pdf" id="figU003Asimulation_smadU003Afirst" />
        <graphic mimetype="application" mime-subtype="pdf" xlink:href="Plotsimulation_smad-2.pdf" id="figU003Asimulation_smadU003Asecond" />
        <graphic mimetype="application" mime-subtype="pdf" xlink:href="Plotsimulation_smad-3.pdf" id="figU003Asimulation_smadU003Athird" />
        <graphic mimetype="application" mime-subtype="pdf" xlink:href="Plotsimulation_smad-4.pdf" id="figU003Asimulation_smadU003Afourth" />
        <graphic mimetype="application" mime-subtype="pdf" xlink:href="Plotsimulation_smad-5.pdf" id="figU003Asimulation_smadU003Afifth" />
    </fig>
  </sec>
</sec>
<sec id="secU003Asummary">
  <title>Summary and discussion</title>
  <p>Biological pathways are of fundamental importance to understanding
  molecular biology. In order to translate findings from genomics
  studies into real-world applications such as improved healthcare, the
  roles of genes must be studied in the context of molecular pathways.
  Here we present a statistical framework to simulate gene expression
  from biological pathways, and provide the
  <monospace>graphsim</monospace> package in R to generate these
  simulated datasets. This approach is versatile and can be fine-tuned
  for modelling existing biological pathways or for testing whether
  constructed pathways can be detected by other means. In particular,
  methods to infer biological pathways and gene regulatory networks from
  gene expression data can be tested on simulated datasets using this
  framework. The package also enables simulation of complex gene
  expression datasets to test how these pathways impact on statistical
  analysis of gene expression data using existing methods or novel
  statistical methods being developed for gene expression data analysis.
  This approach is intended to be applied to bulk gene expression data
  but could in principle be adapted to modelling single-cell or
  different modalities such as genome-wide epigenetic data.</p>
</sec>
<sec id="computational-details">
  <title>Computational details</title>
  <p>Complete examples of code needed to produce the figures in this
  paper are available in the Rmarkdown version in the package GitHub
  repository
  (<ext-link ext-link-type="uri" xlink:href="https://github.com/TomKellyGenetics/graphsim">https://github.com/TomKellyGenetics/graphsim</ext-link>).
  Further details are available in the vignettes as well.</p>
  <p>The results in this paper were obtained using R 4.0.2 with the
  <monospace>igraph</monospace> 1.2.5 <monospace>Matrix</monospace>
  1.2-17, <monospace>matrixcalc</monospace> 1.0-3, and
  <monospace>mvtnorm</monospace> 1.1-1 packages. R itself and all
  dependent packages used are available from the Comprehensive Archive
  Network (CRAN) at
  <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org">https://CRAN.R-project.org</ext-link>.
  The <monospace>graphsim</monospace> 1.0.0 package can be installed
  from CRAN and the issues can be reported to the development version on
  GitHub. This package is included in the
  <monospace>igraph.extensions</monospace> library on GitHub
  (<ext-link ext-link-type="uri" xlink:href="https://github.com/TomKellyGenetics/igraph.extensions">https://github.com/TomKellyGenetics/igraph.extensions</ext-link>)
  which installs various tools for <monospace>igraph</monospace>
  analysis. This software is cross-platform and compatible with
  installations on Windows, Mac, and Linux operating systems. Updates to
  the package (<monospace>graphsim</monospace> 1.0.0) will be released
  on CRAN.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>This package was developed as part of a PhD research project funded
  by the Postgraduate Tassell Scholarship in Cancer Research Scholarship
  awarded to STK. We thank members of the Laboratory of Professor Satoru
  Miyano at the University of Tokyo, Institute for Medical Science,
  Professor Seiya Imoto, Associate Professor Rui Yamaguchi, and Dr Paul
  Sheridan (Assistant Professor at Hirosaki University, CSO at Tupac
  Bio) for helpful discussions in this field. We also thank Professor
  Parry Guilford at the University of Otago, Professor Cristin Print at
  the University of Auckland, and Dr Erik Arner at the RIKEN Center for
  Integrative Medical Sciences for their excellent advice during this
  project.</p>
</sec>
<sec id="contributions">
  <title>Author Contributions</title>
  <p>S.T.K. and M.A.B. conceived of the presented methodology. S.T.K.
  developed the theory and performed the computations. M.A.B. provided
  guidance throughout the project and gave feedback on the package. All
  authors discussed the package and contributed to the final
  manuscript.</p>
</sec>
</body>
<back>
<ref-list>
  <ref-list>
    <ref id="ref-Arner2015">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Arner</surname><suffix>E.</suffix></name>
          <name><surname>Daub</surname><suffix>C. O.</suffix></name>
          <name><surname>Vitting-Seerup</surname><suffix>K.</suffix></name>
          <name><surname>Andersson</surname><suffix>R.</suffix></name>
          <name><surname>Lilje</surname><suffix>B.</suffix></name>
          <name><surname>Drabløs</surname><given-names>F.</given-names></name>
          <name><surname>Lennartsson</surname><given-names>A.</given-names></name>
          <name><surname>Rönnerblad</surname><given-names>M.</given-names></name>
          <name><surname>Hrydziuszko</surname><given-names>O.</given-names></name>
          <name><surname>Vitezic</surname><given-names>M.</given-names></name>
          <name><surname>Freeman</surname><suffix>T. C.</suffix></name>
          <name><surname>Alhendi</surname><suffix>A. M.</suffix></name>
          <name><surname>Arner</surname><suffix>P.</suffix></name>
          <name><surname>Axton</surname><suffix>R.</suffix></name>
          <name><surname>Baillie</surname><suffix>J. K.</suffix></name>
          <name><surname>Beckhouse</surname><suffix>A.</suffix></name>
          <name><surname>Bodega</surname><given-names>B.</given-names></name>
          <name><surname>Briggs</surname><given-names>J.</given-names></name>
          <name><surname>Brombacher</surname><given-names>F.</given-names></name>
          <name><surname>Davis</surname><given-names>M.</given-names></name>
          <name><surname>Detmar</surname><given-names>M.</given-names></name>
          <name><surname>Ehrlund</surname><given-names>A.</given-names></name>
          <name><surname>Endoh</surname><given-names>M.</given-names></name>
          <name><surname>Eslami</surname><given-names>A.</given-names></name>
          <name><surname>Fagiolini</surname><given-names>M.</given-names></name>
          <name><surname>Fairbairn</surname><given-names>L.</given-names></name>
          <name><surname>Faulkner</surname><given-names>G. J.</given-names></name>
          <name><surname>Ferrai</surname><given-names>C.</given-names></name>
          <name><surname>Fisher</surname><given-names>M. E.</given-names></name>
          <name><surname>Forrester</surname><given-names>L.</given-names></name>
          <name><surname>Goldowitz</surname><given-names>D.</given-names></name>
          <name><surname>Guler</surname><given-names>R.</given-names></name>
          <name><surname>Ha</surname><given-names>T.</given-names></name>
          <name><surname>Hara</surname><given-names>M.</given-names></name>
          <name><surname>Herlyn</surname><given-names>M.</given-names></name>
          <name><surname>Ikawa</surname><given-names>T.</given-names></name>
          <name><surname>Kai</surname><given-names>C.</given-names></name>
          <name><surname>Kawamoto</surname><given-names>H.</given-names></name>
          <name><surname>Khachigian</surname><given-names>L. M.</given-names></name>
          <name><surname>Klinken</surname><given-names>S. P.</given-names></name>
          <name><surname>Kojima</surname><given-names>S.</given-names></name>
          <name><surname>Koseki</surname><given-names>H.</given-names></name>
          <name><surname>Klein</surname><given-names>S.</given-names></name>
          <name><surname>Mejhert</surname><given-names>N.</given-names></name>
          <name><surname>Miyaguchi</surname><given-names>K.</given-names></name>
          <name><surname>Mizuno</surname><given-names>Y.</given-names></name>
          <name><surname>Morimoto</surname><given-names>M.</given-names></name>
          <name><surname>Morris</surname><given-names>K. J.</given-names></name>
          <name><surname>Mummery</surname><given-names>C.</given-names></name>
          <name><surname>Nakachi</surname><given-names>Y.</given-names></name>
          <name><surname>Ogishima</surname><given-names>S.</given-names></name>
          <name><surname>Okada-Hatakeyama</surname><given-names>M.</given-names></name>
          <name><surname>Okazaki</surname><given-names>Y.</given-names></name>
          <name><surname>Orlando</surname><given-names>V.</given-names></name>
          <name><surname>Ovchinnikov</surname><given-names>D.</given-names></name>
          <name><surname>Passier</surname><given-names>R.</given-names></name>
          <name><surname>Patrikakis</surname><given-names>M.</given-names></name>
          <name><surname>Pombo</surname><given-names>A.</given-names></name>
          <name><surname>Qin</surname><given-names>X. Y.</given-names></name>
          <name><surname>Roy</surname><given-names>S.</given-names></name>
          <name><surname>Sato</surname><given-names>H.</given-names></name>
          <name><surname>Savvi</surname><given-names>S.</given-names></name>
          <name><surname>Saxena</surname><given-names>A.</given-names></name>
          <name><surname>Schwegmann</surname><given-names>A.</given-names></name>
          <name><surname>Sugiyama</surname><given-names>D.</given-names></name>
          <name><surname>Swoboda</surname><given-names>R.</given-names></name>
          <name><surname>Tanaka</surname><given-names>H.</given-names></name>
          <name><surname>Tomoiu</surname><given-names>A.</given-names></name>
          <name><surname>Winteringham</surname><given-names>L. N.</given-names></name>
          <name><surname>Wolvetang</surname><given-names>E.</given-names></name>
          <name><surname>Yanagi-Mizuochi</surname><given-names>C.</given-names></name>
          <name><surname>Yoneda</surname><given-names>M.</given-names></name>
          <name><surname>Zabierowski</surname><given-names>S.</given-names></name>
          <name><surname>Zhang</surname><given-names>P.</given-names></name>
          <name><surname>Abugessaisa</surname><given-names>I.</given-names></name>
          <name><surname>Bertin</surname><given-names>N.</given-names></name>
          <name><surname>Diehl</surname><given-names>A. D.</given-names></name>
          <name><surname>Fukuda</surname><given-names>S.</given-names></name>
          <name><surname>Furuno</surname><given-names>M.</given-names></name>
          <name><surname>Harshbarger</surname><given-names>J.</given-names></name>
          <name><surname>Hasegawa</surname><given-names>A.</given-names></name>
          <name><surname>Hori</surname><given-names>F.</given-names></name>
          <name><surname>Ishikawa-Kato</surname><given-names>S.</given-names></name>
          <name><surname>Ishizu</surname><given-names>Y.</given-names></name>
          <name><surname>Itoh</surname><given-names>M.</given-names></name>
          <name><surname>Kawashima</surname><given-names>T.</given-names></name>
          <name><surname>Kojima</surname><given-names>M.</given-names></name>
          <name><surname>Kondo</surname><given-names>N.</given-names></name>
          <name><surname>Lizio</surname><given-names>M.</given-names></name>
          <name><surname>Meehan</surname><given-names>T. F.</given-names></name>
          <name><surname>Mungall</surname><given-names>C. J.</given-names></name>
          <name><surname>Murata</surname><given-names>M.</given-names></name>
          <name><surname>Nishiyori-Sueki</surname><given-names>H.</given-names></name>
          <name><surname>Sahin</surname><given-names>S.</given-names></name>
          <name><surname>Nagao-Sato</surname><given-names>S.</given-names></name>
          <name><surname>Severin</surname><given-names>J.</given-names></name>
          <name><surname>Hoon</surname><given-names>M. J. de</given-names></name>
          <name><surname>Kawai</surname><given-names>J.</given-names></name>
          <name><surname>Kasukawa</surname><given-names>T.</given-names></name>
          <name><surname>Lassmann</surname><given-names>T.</given-names></name>
          <name><surname>Suzuki</surname><given-names>H.</given-names></name>
          <name><surname>Kawaji</surname><given-names>H.</given-names></name>
          <name><surname>Summers</surname><given-names>K. M.</given-names></name>
          <name><surname>Wells</surname><given-names>C.</given-names></name>
          <name><surname>Hume</surname><given-names>D. A.</given-names></name>
          <name><surname>Forrest</surname><given-names>A. R.</given-names></name>
          <name><surname>Sandelin</surname><given-names>A.</given-names></name>
          <name><surname>Carninci</surname><given-names>P.</given-names></name>
          <name><surname>Hayashizaki</surname><given-names>Y.</given-names></name>
        </person-group>
        <article-title>Transcribed enhancers lead waves of coordinated transcription in transitioning mammalian cells</article-title>
        <source>Science</source>
        <year iso-8601-date="2015-02">2015</year><month>02</month>
        <volume>347</volume>
        <issue>6225</issue>
      </element-citation>
    </ref>
    <ref id="ref-Barabasi2004">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Barabási</surname><given-names>A. L.</given-names></name>
          <name><surname>Oltvai</surname><given-names>Z. N.</given-names></name>
        </person-group>
        <article-title>Network biology: Understanding the cell’s functional organization</article-title>
        <source>Nat Rev Genet</source>
        <year iso-8601-date="2004">2004</year>
        <volume>5</volume>
        <issue>2</issue>
        <pub-id pub-id-type="doi">10.1038/nrg1272</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Matrix">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name><surname>Bates</surname><suffix>D.</suffix></name>
          <name><surname>Maechler</surname><suffix>M.</suffix></name>
        </person-group>
        <source>Matrix: Sparse and dense matrix classes and methods</source>
        <year iso-8601-date="2016">2016</year>
        <uri>https://CRAN.R-project.org/package=Matrix</uri>
      </element-citation>
    </ref>
    <ref id="ref-Reactome">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Croft</surname><suffix>D.</suffix></name>
          <name><surname>Mundo</surname><suffix>A. F.</suffix></name>
          <name><surname>Haw</surname><suffix>R.</suffix></name>
          <name><surname>Milacic</surname><suffix>M.</suffix></name>
          <name><surname>Weiser</surname><suffix>J.</suffix></name>
          <name><surname>Wu</surname><suffix>G.</suffix></name>
          <name><surname>Caudy</surname><suffix>M.</suffix></name>
          <name><surname>Garapati</surname><suffix>P.</suffix></name>
          <name><surname>Gillespie</surname><suffix>M.</suffix></name>
          <name><surname>Kamdar</surname><given-names>M R</given-names></name>
          <name><surname>Jassal</surname><given-names>B</given-names></name>
          <name><surname>Jupe</surname><given-names>S</given-names></name>
          <name><surname>Matthews</surname><given-names>L</given-names></name>
          <name><surname>May</surname><given-names>B</given-names></name>
          <name><surname>Palatnik</surname><given-names>S</given-names></name>
          <name><surname>Rothfels</surname><given-names>K</given-names></name>
          <name><surname>Shamovsky</surname><given-names>V</given-names></name>
          <name><surname>Song</surname><given-names>H</given-names></name>
          <name><surname>Williams</surname><given-names>M</given-names></name>
          <name><surname>Birney</surname><given-names>E</given-names></name>
          <name><surname>Hermjakob</surname><given-names>H</given-names></name>
          <name><surname>Stein</surname><given-names>L</given-names></name>
          <name><surname>D’Eustachio</surname><given-names>P</given-names></name>
        </person-group>
        <article-title>The Reactome pathway knowledgebase</article-title>
        <source>Nucleic Acids Res</source>
        <year iso-8601-date="2014">2014</year>
        <volume>42</volume>
        <issue>database issue</issue>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1102</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-igraph">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Csardi</surname><suffix>G.</suffix></name>
          <name><surname>Nepusz</surname><suffix>T.</suffix></name>
        </person-group>
        <article-title>The igraph software package for complex network research</article-title>
        <source>InterJournal</source>
        <year iso-8601-date="2006">2006</year>
        <volume>Complex Systems</volume>
        <uri>http://igraph.org</uri>
      </element-citation>
    </ref>
    <ref id="ref-Genz2009">
      <element-citation publication-type="chapter">
        <person-group person-group-type="author">
          <name><surname>Genz</surname><suffix>A.</suffix></name>
          <name><surname>Bretz</surname><suffix>F.</suffix></name>
        </person-group>
        <article-title>Computation of multivariate normal and t probabilities</article-title>
        <source>Lecture notes in statistics</source>
        <publisher-name>Springer-Verlag</publisher-name>
        <publisher-loc>Heidelberg</publisher-loc>
        <year iso-8601-date="2009">2009</year>
        <volume>195</volume>
        <isbn>978-3-642-01688-2</isbn>
        <pub-id pub-id-type="doi">10.1007/978-3-642-01689-9</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-mvtnorm">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name><surname>Genz</surname><suffix>A.</suffix></name>
          <name><surname>Bretz</surname><suffix>F.</suffix></name>
          <name><surname>Miwa</surname><suffix>T.</suffix></name>
          <name><surname>Mi</surname><suffix>X.</suffix></name>
          <name><surname>Leisch</surname><suffix>F.</suffix></name>
          <name><surname>Scheipl</surname><suffix>F.</suffix></name>
          <name><surname>Hothorn</surname><given-names>T.</given-names></name>
        </person-group>
        <source>Mvtnorm: Multivariate normal and t distributions</source>
        <year iso-8601-date="2016">2016</year>
        <uri>http://CRAN.R-project.org/package=mvtnorm</uri>
      </element-citation>
    </ref>
    <ref id="ref-Hawe2019">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Hawe</surname><suffix>J. S.</suffix></name>
          <name><surname>Theis</surname><suffix>F. J.</suffix></name>
          <name><surname>Heinig</surname><suffix>M.</suffix></name>
        </person-group>
        <article-title>Inferring Interaction Networks From Multi-Omics Data</article-title>
        <source>Front Genet</source>
        <year iso-8601-date="2019">2019</year>
        <volume>10</volume>
        <pub-id pub-id-type="doi">10.3389/fgene.2019.00535</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Higham2002">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Higham</surname><given-names>N. J.</given-names></name>
        </person-group>
        <article-title>Computing the nearest correlation matrix–a problem from finance</article-title>
        <source>IMA Journal of Numerical Analysis</source>
        <publisher-name>Oxford University Press</publisher-name>
        <year iso-8601-date="2002">2002</year>
        <volume>22</volume>
        <issue>3</issue>
        <pub-id pub-id-type="doi">10.1093/imanum/22.3.329</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Hirose2008">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Hirose</surname><suffix>O.</suffix></name>
          <name><surname>Yoshida</surname><suffix>R.</suffix></name>
          <name><surname>Imoto</surname><suffix>S.</suffix></name>
          <name><surname>Yamaguchi</surname><suffix>R.</suffix></name>
          <name><surname>Higuchi</surname><suffix>T.</suffix></name>
          <name><surname>Charnock-Jones</surname><suffix>D. S.</suffix></name>
          <name><surname>Print</surname><suffix>C.</suffix></name>
          <name><surname>Miyano</surname><suffix>S.</suffix></name>
        </person-group>
        <article-title>Statistical inference of transcriptional module-based gene networks from time course gene expression profiles by using state space models</article-title>
        <source>Bioinformatics</source>
        <year iso-8601-date="2008">2008</year>
        <volume>24</volume>
        <issue>7</issue>
        <uri> + http://dx.doi.org/10.1093/bioinformatics/btm639</uri>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm639</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Hu2016">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Hu</surname><given-names>J. X.</given-names></name>
          <name><surname>Thomas</surname><given-names>C. E.</given-names></name>
          <name><surname>Brunak</surname><suffix>S.</suffix></name>
        </person-group>
        <article-title>Network biology concepts in complex disease comorbidities</article-title>
        <source>Nat. Rev. Genet.</source>
        <year iso-8601-date="2016-10">2016</year><month>10</month>
        <volume>17</volume>
        <issue>10</issue>
        <pub-id pub-id-type="doi">10.1038/nrg.2016.87</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Komatsu2013">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Komatsu</surname><given-names>M.</given-names></name>
          <name><surname>Yoshimaru</surname><given-names>T.</given-names></name>
          <name><surname>Matsuo</surname><given-names>T.</given-names></name>
          <name><surname>Kiyotani</surname><given-names>K.</given-names></name>
          <name><surname>Miyoshi</surname><given-names>Y.</given-names></name>
          <name><surname>Tanahashi</surname><given-names>T.</given-names></name>
          <name><surname>Rokutan</surname><suffix>K.</suffix></name>
          <name><surname>Yamaguchi</surname><given-names>R.</given-names></name>
          <name><surname>Saito</surname><given-names>A.</given-names></name>
          <name><surname>Imoto</surname><given-names>S.</given-names></name>
          <name><surname>Miyano</surname><given-names>S.</given-names></name>
          <name><surname>Nakamura</surname><given-names>Y.</given-names></name>
          <name><surname>Sasa</surname><given-names>M.</given-names></name>
          <name><surname>Shimada</surname><given-names>M.</given-names></name>
          <name><surname>Katagiri</surname><suffix>T.</suffix></name>
        </person-group>
        <article-title>Molecular features of triple negative breast cancer cells by genome-wide gene expression profiling analysis</article-title>
        <source>Int. J. Oncol.</source>
        <year iso-8601-date="2013-02">2013</year><month>02</month>
        <volume>42</volume>
        <issue>2</issue>
        <pub-id pub-id-type="doi">10.3892/ijo.2012.1744</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Law2014">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Law</surname><given-names>C. W.</given-names></name>
          <name><surname>Chen</surname><suffix>Y.</suffix></name>
          <name><surname>Shi</surname><suffix>W.</suffix></name>
          <name><surname>Smyth</surname><suffix>G. K.</suffix></name>
        </person-group>
        <article-title>voom: Precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>
        <source>Genome Biol.</source>
        <publisher-name>Springer Nature</publisher-name>
        <year iso-8601-date="2014-02">2014</year><month>02</month>
        <volume>15</volume>
        <issue>2</issue>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-2-r29</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Li2015">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Li</surname><suffix>P.</suffix></name>
          <name><surname>Piao</surname><suffix>Y.</suffix></name>
          <name><surname>Shon</surname><suffix>H. S.</suffix></name>
          <name><surname>Ryu</surname><suffix>K. H.</suffix></name>
        </person-group>
        <article-title>Comparing the normalization methods for the differential analysis of Illumina high-throughput RNA-Seq data</article-title>
        <source>BMC Bioinformatics</source>
        <year iso-8601-date="2015-10">2015</year><month>10</month>
        <volume>16</volume>
        <pub-id pub-id-type="doi">10.1186/s12859-015-0778-7</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Markowetz2007">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Markowetz</surname><suffix>F.</suffix></name>
          <name><surname>Spang</surname><suffix>R.</suffix></name>
        </person-group>
        <article-title>Inferring cellular networks–a review</article-title>
        <source>BMC Bioinformatics</source>
        <year iso-8601-date="2007-09">2007</year><month>09</month>
        <volume>8 Suppl 6</volume>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-s6-s5</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Perou2000">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Perou</surname><suffix>C. M.</suffix></name>
          <name><surname>Sørlie</surname><suffix>T.</suffix></name>
          <name><surname>Eisen</surname><suffix>M. B.</suffix></name>
          <name><surname>Rijn</surname><suffix>M.</suffix></name>
          <name><surname>Jeffrey</surname><suffix>S. S.</suffix></name>
          <name><surname>Rees</surname><suffix>C. A.</suffix></name>
          <name><surname>Pollack</surname><suffix>J. R.</suffix></name>
          <name><surname>Ross</surname><suffix>D. T.</suffix></name>
          <name><surname>Johnsen</surname><suffix>H.</suffix></name>
          <name><surname>Akslen</surname><suffix>L. A.</suffix></name>
          <name><surname>Fluge</surname><given-names>Ø.</given-names></name>
          <name><surname>Pergamenschikov</surname><given-names>A.</given-names></name>
          <name><surname>Williams</surname><given-names>C.</given-names></name>
          <name><surname>Zhu</surname><given-names>S. X.</given-names></name>
          <name><surname>Lønning</surname><given-names>P. E.</given-names></name>
          <name><surname>Børresen-Dale</surname><given-names>A. L.</given-names></name>
          <name><surname>Brown</surname><given-names>P. O.</given-names></name>
          <name><surname>Botstein</surname><suffix>D.</suffix></name>
        </person-group>
        <article-title>Molecular portraits of human breast tumours</article-title>
        <source>Nature</source>
        <year iso-8601-date="2000-08">2000</year><month>08</month>
        <volume>406</volume>
        <issue>6797</issue>
      </element-citation>
    </ref>
    <ref id="ref-limma">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Matthew E R.</surname></name>
          <name><surname>Phipson</surname><given-names>and Wu</given-names><suffix>B.</suffix></name>
          <name><surname>Hu</surname><suffix>Y.</suffix></name>
          <name><surname>Law</surname><suffix>C. W.</suffix></name>
          <name><surname>Shi</surname><suffix>W.</suffix></name>
          <name><surname>Smyth</surname><suffix>G. K.</suffix></name>
        </person-group>
        <article-title>limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>
        <source>Nucleic Acids Research</source>
        <year iso-8601-date="2015">2015</year>
        <volume>43</volume>
        <issue>7</issue>
        <pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Svensson2018">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Svensson</surname><given-names>V.</given-names></name>
          <name><surname>Vento-Tormo</surname><given-names>R.</given-names></name>
          <name><surname>Teichmann</surname><suffix>S. A.</suffix></name>
        </person-group>
        <article-title>Exponential scaling of single-cell RNA-seq in the past decade</article-title>
        <source>Nat Protoc</source>
        <year iso-8601-date="2018-04">2018</year><month>04</month>
        <volume>13</volume>
        <issue>4</issue>
        <pub-id pub-id-type="doi">10.1038/nprot.2017.149</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Ozsolak2011">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Ozsolak</surname><suffix>F.</suffix></name>
          <name><surname>Milos</surname><suffix>P. M.</suffix></name>
        </person-group>
        <article-title>RNA sequencing: advances, challenges and opportunities</article-title>
        <source>Nat. Rev. Genet.</source>
        <year iso-8601-date="2011-02">2011</year><month>02</month>
        <volume>12</volume>
        <issue>2</issue>
        <pub-id pub-id-type="doi">10.1038/nrg2934</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Cannoodt2020">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Cannoodt</surname><suffix>R.</suffix></name>
          <name><surname>Saelens</surname><suffix>W.</suffix></name>
          <name><surname>Deconinck</surname><suffix>L.</suffix></name>
          <name><surname>Saeys</surname><suffix>Y.</suffix></name>
        </person-group>
        <article-title>Dyngen: A multi-modal simulator for spearheading new single-cell omics analyses</article-title>
        <source>bioRxiv</source>
        <publisher-name>Cold Spring Harbor Laboratory</publisher-name>
        <year iso-8601-date="2020">2020</year>
        <uri>https://www.biorxiv.org/content/early/2020/02/27/2020.02.06.936971</uri>
        <pub-id pub-id-type="doi">10.1101/2020.02.06.936971</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Schaffter2011">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Schaffter</surname><suffix>T.</suffix></name>
          <name><surname>Marbach</surname><suffix>D.</suffix></name>
          <name><surname>Floreano</surname><suffix>D.</suffix></name>
        </person-group>
        <article-title>GeneNetWeaver: in silico benchmark generation and performance profiling of network inference methods</article-title>
        <source>Bioinformatics</source>
        <year iso-8601-date="2011-08">2011</year><month>08</month>
        <volume>27</volume>
        <issue>16</issue>
      </element-citation>
    </ref>
    <ref id="ref-Dibaeinia2019">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Dibaeinia</surname><suffix>P.</suffix></name>
          <name><surname>Sinha</surname><suffix>S.</suffix></name>
        </person-group>
        <article-title>A single-cell expression simulator guided by gene regulatory networks</article-title>
        <source>bioRxiv</source>
        <publisher-name>Cold Spring Harbor Laboratory</publisher-name>
        <year iso-8601-date="2019">2019</year>
        <uri>https://www.biorxiv.org/content/early/2019/07/28/716811</uri>
        <pub-id pub-id-type="doi">10.1101/716811</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Saelens2019">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Saelens</surname><suffix>W.</suffix></name>
          <name><surname>Cannoodt</surname><suffix>R.</suffix></name>
          <name><surname>Todorov</surname><suffix>H.</suffix></name>
          <name><surname>Saeys</surname><suffix>Y..</suffix></name>
        </person-group>
        <article-title>A comparison of single-cell trajectory inference methods</article-title>
        <source>Nat. Biotechnol.</source>
        <year iso-8601-date="2019-05">2019</year><month>05</month>
        <volume>37</volume>
        <issue>5</issue>
      </element-citation>
    </ref>
    <ref id="ref-Shimamura2009">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Shimamura</surname><suffix>T.</suffix></name>
          <name><surname>Imoto</surname><given-names>.</given-names><suffix>S</suffix></name>
          <name><surname>Yamaguchi</surname><suffix>R.</suffix></name>
          <name><surname>Fujita</surname><suffix>A.</suffix></name>
          <name><surname>Nagasaki</surname><suffix>M.</suffix></name>
          <name><surname>Miyano</surname><suffix>S.</suffix></name>
        </person-group>
        <article-title>Recursive regularization for inferring gene networks from time-course gene expression profiles</article-title>
        <source>BMC Systems Biology</source>
        <year iso-8601-date="2009-04-22">2009</year><month>04</month><day>22</day>
        <volume>3</volume>
        <issue>1</issue>
        <issn>1752-0509</issn>
        <uri>https://doi.org/10.1186/1752-0509-3-41</uri>
        <pub-id pub-id-type="doi">10.1186/1752-0509-3-41</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Wang2018">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Wang</surname><suffix>J.</suffix></name>
          <name><surname>Huang</surname><suffix>M.</suffix></name>
          <name><surname>Torre</surname><suffix>E.</suffix></name>
          <name><surname>Dueck</surname><suffix>H.</suffix></name>
          <name><surname>Shaffer</surname><suffix>S.</suffix></name>
          <name><surname>Murray</surname><given-names>J.m</given-names></name>
          <name><surname>Raj</surname><suffix>A.</suffix></name>
          <name><surname>Li</surname><suffix>M.</suffix></name>
          <name><surname>Zhang</surname><suffix>N. R.</suffix></name>
        </person-group>
        <article-title>Gene expression distribution deconvolution in single-cell RNA sequencing</article-title>
        <source>Proc. Natl. Acad. Sci. U.S.A.</source>
        <year iso-8601-date="2018-07">2018</year><month>07</month>
        <volume>115</volume>
        <issue>28</issue>
        <pub-id pub-id-type="doi">10.1101/227033</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Yamaguchi2007">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Yamaguchi</surname><suffix>R.</suffix></name>
          <name><surname>Yoshida</surname><suffix>R.</suffix></name>
          <name><surname>Imoto</surname><suffix>S.</suffix></name>
          <name><surname>Higuchi</surname><suffix>T.</suffix></name>
          <name><surname>Miyano</surname><suffix>S.</suffix></name>
        </person-group>
        <article-title>Finding module-based gene networks with state-space models - Mining high-dimensional and short time-course gene expression data</article-title>
        <source>IEEE Signal Processing Magazine</source>
        <year iso-8601-date="2007-01">2007</year><month>01</month>
        <volume>24</volume>
        <issue>1</issue>
        <pub-id pub-id-type="doi">10.1109/msp.2007.273053</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Zappia2017">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Zappia</surname><suffix>L.</suffix></name>
          <name><surname>Phipson</surname><suffix>B.</suffix></name>
          <name><surname>Oshlack</surname><suffix>A.</suffix></name>
        </person-group>
        <article-title>Splatter: Simulation of single-cell RNA sequencing data</article-title>
        <source>Genome Biol.</source>
        <year iso-8601-date="2017-09">2017</year><month>09</month>
        <volume>18</volume>
        <issue>1</issue>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1305-0</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</ref-list>
</back>
</article>
