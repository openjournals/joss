<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">1441</article-id>
<article-id pub-id-type="doi">10.21105/joss.01441</article-id>
<title-group>
<article-title>MoFEM: An open source, parallel finite element
library</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-8468-5435</contrib-id>
<string-name>≈Åukasz Kaczmarczyk</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-1612-9066</contrib-id>
<string-name>Zahur Ullah</string-name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<string-name>Karol Lewandowski</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<string-name>Xuan Meng</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<string-name>Xiao-Yi Zhou</string-name>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<string-name>Ignatios Athanasiadis</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<string-name>Hoang Nguyen</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<string-name>Christophe-Alexandre Chalons-Mouriesse</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<string-name>Euan J. Richardson</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<string-name>Euan Miur</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<string-name>Andrei G. Shvarts</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<string-name>Mebratu Wakeni</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<string-name>Chris J. Pearce</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Glasgow Computational Engineering Centre, James Watt School
of Engineering, University of Glasgow, Glasgow, G12 8QQ,
UK</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>School of Mechanical &amp; Aerospace Engineering, Queen‚Äôs
University, Belfast, BT7 1NN, UK</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Department of Bridge Engineering, Tongji University, 1239
Siping Road, Shanghai, 200092, China</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2020-01-21">
<day>21</day>
<month>1</month>
<year>2020</year>
</pub-date>
<volume>5</volume>
<issue>45</issue>
<fpage>1441</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2021</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Finite element method</kwd>
<kwd>Solid mechanics</kwd>
<kwd>Fluid mechanics</kwd>
<kwd>Fracture mechanics</kwd>
<kwd>Biomechanics</kwd>
<kwd>HPC</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="introduction-and-motivation">
  <title>Introduction and Motivation</title>
  <p><monospace>MoFEM</monospace> (Mesh-oriented Finite Element Method)
  is a C++ library for managing complexities related to the finite
  element method (FEM). FEM is a widely used numerical approach for
  solving partial differential equations (PDEs) arising in various
  physical problems. <monospace>MoFEM</monospace> is developed to
  provide a finite element library incorporating modern approximation
  approaches and data structures for engineers, students and
  academics.</p>
  <p><monospace>MoFEM</monospace> belongs to a class of open source
  finite element libraries, such as <monospace>Deal.II</monospace>
  (<xref alt="Arndt et al., 2019" rid="ref-dealII91" ref-type="bibr">Arndt
  et al., 2019</xref>), <monospace>MFEM</monospace>
  (<xref alt="Kolev &amp; Dobrev, 2010" rid="ref-doecode_1687" ref-type="bibr">Kolev
  &amp; Dobrev, 2010</xref>), <monospace>libMesh</monospace>
  (<xref alt="Kirk et al., 2006" rid="ref-libMeshPaper" ref-type="bibr">Kirk
  et al., 2006</xref>), <monospace>FEniCS</monospace>
  (<xref alt="Aln√¶s et al., 2015" rid="ref-AlnaesBlechta2015a" ref-type="bibr">Aln√¶s
  et al., 2015</xref>) and <monospace>FreeFEM++</monospace>
  (<xref alt="Hecht, 2012" rid="ref-MR3043640" ref-type="bibr">Hecht,
  2012</xref>), which provide users with generic tools for solving PDEs
  and developers with frameworks for implementing bespoke finite
  elements. <monospace>MoFEM</monospace> is specifically designed to
  solve complex engineering problems, enabling seamless integration of
  meshes that comprise multiple element types and element shapes, which
  are typically encountered in industrial applications. The development
  of <monospace>MoFEM</monospace> has been primarily targeting the
  problem of crack propagation for structural integrity assessment of
  safety critical structures (see
  <xref alt="Figure¬†1" rid="figU003Abrick">Figure¬†1</xref>).</p>
  <fig>
    <caption><p>Brittle crack
    propagation.<styled-content id="figU003Abrick"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="paper_brick.png" xlink:title="" />
  </fig>
  <p>The need for solutions to increasingly complex problems demands
  control over numerical errors; otherwise, it would be difficult to
  distinguish discretisation artefacts from the real physical phenomena.
  A brute force approach based on mesh refinement (so-called
  <italic><inline-formula><alternatives>
  <tex-math><![CDATA[h]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>h</mml:mi></mml:math></alternatives></inline-formula>-adaptivity</italic>)
  leads to a low polynomial convergence rate and, therefore, is severely
  limited by the current computing capabilities. A more elegant approach
  was paved by Guo &amp; Babu≈°ka
  (<xref alt="1986" rid="ref-guo1986hp" ref-type="bibr">1986</xref>),
  who showed that if one could simultaneously increase the mesh density
  and the interpolation order, i.e.¬†employ
  <italic><inline-formula><alternatives>
  <tex-math><![CDATA[hp]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>h</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>-adaptivity</italic>,
  exponential convergence is achievable. This has been seen as the ‚ÄòHoly
  Grail‚Äô of numerical methods.</p>
  <p>However, raising the order of approximation comes with a
  computational cost: the algebraic solver time and the matrix assembly
  time are increased. Unfortunately, there is no universal solution to
  tackle these two difficulties simultaneously. To reduce the solver
  time, properties of hierarchical and heterogeneous approximation
  bases, constructed using Legendre
  (<xref alt="Ainsworth &amp; Coyle, 2003" rid="ref-ainsworth2003hierarchic" ref-type="bibr">Ainsworth
  &amp; Coyle, 2003</xref>) or Jacobi
  (<xref alt="Fuentes et al., 2015" rid="ref-fuentes2015orientation" ref-type="bibr">Fuentes
  et al., 2015</xref>) polynomials, can be exploited. Such bases permit
  to increase approximation order locally and produce sparse and
  well-conditioned systems of equations. Moreover, algebraic systems
  constructed with hierarchical bases can be naturally restricted to
  lower dimensions for use as a preconditioner, e.g.¬†with multi-grid
  solvers. This approach is ideal for elliptic problems such as solid
  elasticity; however, for hyperbolic problems the efficiency bottleneck
  could be in the assembly time, e.g.¬†for acoustic wave propagation. In
  the latter case, different approximation bases, such as the
  Bernstein-B√©zier basis
  (<xref alt="Ainsworth et al., 2011" rid="ref-ainsworth2011bernstein" ref-type="bibr">Ainsworth
  et al., 2011</xref>), allowing for fast numerical integration, could
  be an optimal solution. Finally, the adaptive choice of the mesh
  density and the approximation order is driven by numerical errors,
  which can be effectively estimated if error evaluators are embedded
  into the FE formulation. This leads to a family of mixed or
  mixed-hybrid finite elements that are stable if combinations of
  different approximation spaces (<inline-formula><alternatives>
  <tex-math><![CDATA[\mathit{H}^1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mstyle mathvariant="italic"><mml:mi>ùêª</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msup></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[{\mathbf{H}}({\textbf{curl}})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>ùêá</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mtext mathvariant="bold">ùêúùêÆùê´ùê•</mml:mtext><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[{\mathbf{H}}({\textbf{div}})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>ùêá</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mtext mathvariant="bold">ùêùùê¢ùêØ</mml:mtext><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\mathit{L}^2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mstyle mathvariant="italic"><mml:mi>ùêø</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula>)
  are used.</p>
  <p><monospace>MoFEM</monospace> incorporates all solutions discussed
  above for <inline-formula><alternatives>
  <tex-math><![CDATA[hp]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>h</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>-adaptivity,
  enabling rapid implementation of the finite element method,
  i.e.¬†relieving the user from programming complexities related to
  bookkeeping of degrees of freedom (DOFs), finite elements, matrix
  assembly, etc. Therefore, <monospace>MoFEM</monospace> provides
  efficient tools for solving a wide range of complex
  engineering-related problems: multi-dimensional (involving solid,
  shell and beam elements), multi-domain (e.g.¬†interaction between solid
  and fluid), multi-scale (e.g.¬†homogenisation with
  FE<inline-formula><alternatives>
  <tex-math><![CDATA[^2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi></mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula>)
  and multi-physics (e.g.¬†thermo-elasticity). Moreover,
  <monospace>MoFEM</monospace> supports mixed meshes, consisting of
  different element types, for example, tetrahedra and prisms.</p>
</sec>
<sec id="design">
  <title>Design</title>
  <p>Modern finite element software is an ecosystem that manages various
  complexities related to mesh and topology, sparse algebra and
  approximation, numerical integration and dense tensor algebra at the
  integration point level. However, <monospace>MoFEM</monospace> has not
  developed all these capabilities from scratch. Instead,
  <monospace>MoFEM</monospace> integrates advanced scientific computing
  tools for sparse algebra from
  <ext-link ext-link-type="uri" xlink:href="https://www.mcs.anl.gov/petsc/"><monospace>PETSc</monospace></ext-link>
  (Portable, Extensible Toolkit for Scientific Computation)
  (<xref alt="Balay et al., 2019" rid="ref-petsc-user-ref" ref-type="bibr">Balay
  et al., 2019</xref>), components for handling mesh and topology from
  <ext-link ext-link-type="uri" xlink:href="https://press3.mcs.anl.gov/sigma/moab-library/"><monospace>MOAB</monospace></ext-link>
  (Mesh-Oriented Database)
  (<xref alt="Tautges et al., 2004" rid="ref-tautges_moabU003A2004" ref-type="bibr">Tautges
  et al., 2004</xref>) and data structures from
  <ext-link ext-link-type="uri" xlink:href="https://www.boost.org"><monospace>Boost</monospace>
  libraries</ext-link>
  (<xref alt="Boost Web Page, 2020" rid="ref-boost-web-page" ref-type="bibr"><italic>Boost
  Web Page</italic>, 2020</xref>). An illustration of how these packages
  are utilised in <monospace>MoFEM</monospace> is shown in
  <xref alt="Figure¬†2" rid="figU003Adesign">Figure¬†2</xref>. Moreover,
  <monospace>MoFEM</monospace>‚Äôs core library is developed to manage
  complexities directly related to the finite element method. Therefore,
  each part of this ecosystem has its own design objectives, and
  appropriate programming tools can be selected from a spectrum of
  solutions. Resilience of the <monospace>MoFEM</monospace> ecosystem is
  ensured since the underpinning components have dynamic and established
  groups of developers and a significant number of users. Different
  components employed in the ecosystem are illustrated in
  <xref alt="Figure¬†3" rid="figU003Aecosystem">Figure¬†3</xref>,
  including popular pre- and post-processing software.</p>
  <fig>
    <caption><p>Basic design of <monospace>MoFEM</monospace>. Adopted
    from <italic>MoFEM Web Page</italic>
    (<xref alt="2020" rid="ref-MoFEMWebPage" ref-type="bibr">2020</xref>).<styled-content id="figU003Adesign"></styled-content></p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="basic_design.pdf" xlink:title="" />
  </fig>
  <fig>
    <caption><p>Ecosystem of <monospace>MoFEM</monospace>. Adopted from
    <italic>MOAB Web Page</italic>
    (<xref alt="2020" rid="ref-MOABWebPage" ref-type="bibr">2020</xref>).<styled-content id="figU003Aecosystem"></styled-content></p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="ecosystem.pdf" xlink:title="" />
  </fig>
  <p>Traditional finite element codes are element-centric, i.e.¬†the type
  of an element defines the approximation space and basis. Therefore,
  they are not able to fully exploit the potential of emerging
  approximation methods. On the contrary, the design of data structures
  for approximation of field variables in <monospace>MoFEM</monospace>
  is independent of the specific finite element formulation,
  e.g.¬†Lagrangian, Ndlec or Raviart-Thomas, since each finite element is
  constructed by a set of lower dimension entities on which the
  approximation fields are defined. Consequently, different
  approximation spaces (<inline-formula><alternatives>
  <tex-math><![CDATA[\mathit{H}^1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mstyle mathvariant="italic"><mml:mi>ùêª</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msup></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[{\mathbf{H}}({\textbf{curl}})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>ùêá</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mtext mathvariant="bold">ùêúùêÆùê´ùê•</mml:mtext><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[{\mathbf{H}}({\textbf{div}})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>ùêá</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mtext mathvariant="bold">ùêùùê¢ùêØ</mml:mtext><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\mathit{L}^2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mstyle mathvariant="italic"><mml:mi>ùêø</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula>)
  can be suitably combined in a finite element to create new stable
  mixed formulations for solving complex problems efficiently.</p>
  <p><monospace>MoFEM</monospace> data structures enable easy enrichment
  of approximation fields and modification of basis functions, for
  example, for resolution of singularity at a crack front. Applying such
  technique, it is almost effortless to construct transition elements
  between domains with different problem formulation and physics,
  e.g.¬†from two-field mixed formulation to a single-field. One can
  easily implement elements with an anisotropic approximation order,
  which depends on direction in curvilinear basis, e.g. solid shells
  with arbitrary higher approximation order on the surface and arbitrary
  lower order through the thickness of the shell. This approach also
  sets a benchmark on how finite element codes could be implemented,
  introducing a concept of pipelines of <italic>user-defined data
  operators</italic> acting on fields that are associated with entities
  (vertices, edges, faces and volumes). Such an approach simplifies code
  writing, testing and validation, making the code more resilient to
  bugs.</p>
  <p>Furthermore, <monospace>MoFEM</monospace>‚Äôs core library provides
  functionality for developing <italic>user modules</italic> (see
  <xref alt="Figure¬†2" rid="figU003Adesign">Figure¬†2</xref>) where
  applications for particular problems can be implemented. This
  toolkit-like structure allows for independent development of modules
  with different repositories, owners and licences, being suitable for
  both open-access academic research and private industrial sensitive
  projects. At the same time, the <monospace>MoFEM</monospace> core
  library is licensed under the
  <ext-link ext-link-type="uri" xlink:href="https://www.gnu.org/licenses/lgpl.html">GNU
  Lesser General Public License</ext-link> and it can be deployed and
  developed using the package manager
  <ext-link ext-link-type="uri" xlink:href="https://spack.io">Spack</ext-link>;
  see the
  <ext-link ext-link-type="uri" xlink:href="http://mofem.eng.gla.ac.uk/mofem/html/installation.html">MoFEM
  installation instructions</ext-link> for more details.</p>
</sec>
<sec id="examples-and-capabilities">
  <title>Examples and Capabilities</title>
  <p><monospace>MoFEM</monospace> was initially created to solve the
  problem of brittle crack propagation using thermodynamically
  consistent framework
  (<xref alt="Kaczmarczyk et al., 2017" rid="ref-kaczmarczyk2017energy" ref-type="bibr">Kaczmarczyk
  et al., 2017</xref>). Over time, the domain of applications expanded
  to include computational homogenisation
  (<xref alt="Ullah et al., 2019" rid="ref-ullah2019unified" ref-type="bibr">Ullah
  et al., 2019</xref>), bone remodelling and fracture
  (<xref alt="Lewandowski et al., 2020" rid="ref-lew2020numerical" ref-type="bibr">Lewandowski
  et al., 2020</xref>), modelling of gel rheology
  (<xref alt="Richardson, 2018" rid="ref-richardson2018multiphysics" ref-type="bibr">Richardson,
  2018</xref>) and acoustics problems. Moreover,
  <monospace>MoFEM</monospace> includes an extensive library of example
  applications such as soap film, solid shell, topology optimisation,
  phase field fracture, Navier-Stokes flow, cell traction microscopy,
  bone remodelling, configurational fracture, plasticity, mortar
  contact, magnetostatics and acoustic wave propagation as shown in
  <xref alt="Figure¬†4" rid="figU003Aexamples">Figure¬†4</xref>.</p>
  <fig>
    <caption><p>Examples of user modules implemented using
    <monospace>MoFEM</monospace>.<styled-content id="figU003Aexamples"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="mofem_modules_examples.png" xlink:title="" />
  </fig>
  <p><monospace>MoFEM</monospace> is designed to provide efficient tools
  for solving a wide variety of user-defined problems. In
  <xref alt="Figure¬†5" rid="figU003Ashell">Figure¬†5</xref> an example of
  error-driven <inline-formula><alternatives>
  <tex-math><![CDATA[p]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>p</mml:mi></mml:math></alternatives></inline-formula>-adaptivity
  is presented, where a hierarchical approximation basis with a
  multi-grid solver is applied to the perforated Scordelis-Lo Roof
  problem
  (<xref alt="Kaczmarczyk et al., 2016" rid="ref-kaczmarczyk2016prism" ref-type="bibr">Kaczmarczyk
  et al., 2016</xref>).</p>
  <fig>
    <caption><p>Example of <inline-formula><alternatives>
    <tex-math><![CDATA[p]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>p</mml:mi></mml:math></alternatives></inline-formula>-adaptivity
    for hierarchical and heterogeneous approximation with multi-grid
    solver applied to the perforated Scordelis-Lo roof problem using a
    solid shell
    element.<styled-content id="figU003Ashell"></styled-content></p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="paper_shell.pdf" xlink:title="" />
  </fig>
  <p><monospace>MoFEM</monospace> provides a convenient application
  programming interface allowing user to freely choose the approximation
  basis (e.g.¬†Legrende or Jacobi polynomials) independently of the
  approximation space, and type and dimension of the field. A user can
  approximate scalar and vectorial fields on scalar basis functions, or
  vectorial and tensorial fields on vectorial bases. Moreover,
  <monospace>MoFEM</monospace> permits the construction of tensorial
  fields on tensorial bases, e.g.¬†bubble basis of zero normal and
  divergence-free basis functions; see Gopalakrishnan &amp; Guzm√°n
  (<xref alt="2012" rid="ref-gopalakrishnan2012second" ref-type="bibr">2012</xref>)
  for an example of such a space. A <monospace>MoFEM</monospace> user
  can also freely set the approximation order on each entity of an
  element separately, e.g.¬†edge, face, volume, or define a field on the
  skeleton.
  <xref alt="Figure¬†6" rid="figU003Aconvergence">Figure¬†6</xref>
  presents a convergence study for the mixed formulation of a
  transport/heat conduction problem; the code snippet below outlines the
  definition of approximation space, basis and order for each field in
  this example.</p>
  <code language="c++">// add fields of fluxes and values to the mesh
// define approximation space, basis and number of coefficients
mField.add_field(fluxes, HDIV, DEMKOWICZ_JACOBI_BASE, 1); 
mField.add_field(values, L2, AINSWORTH_LEGENDRE_BASE, 1); 
// get meshset consisting of all entities in the mesh
EntityHandle mesh_set = mField.get_moab().get_root_set();
// add mesh entities of different type to each field
// adding tetrahedra implies adding lower dimension entities
mField.add_ents_to_field_by_type(mesh_set, MBTET, fluxes); 
mField.add_ents_to_field_by_type(mesh_set, MBTET, values); 
// define approximation order for each field 
// separately for each entity
mField.set_field_order(mesh_set, MBTET, fluxes, order+1); 
mField.set_field_order(mesh_set, MBTRI, fluxes, order+1); 
mField.set_field_order(mesh_set, MBTET, values, order);</code>
  <fig>
    <caption><p>A convergence study of <inline-formula><alternatives>
    <tex-math><![CDATA[h]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>h</mml:mi></mml:math></alternatives></inline-formula>-adaptivity
    for the mixed formulation of the stationary transport/heat
    conduction problem (see inset of the figure for the geometry) with
    comparison of different polynomial orders, denoted as
    <inline-formula><alternatives>
    <tex-math><![CDATA[\text{P}n\text{-}\text{P}m]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">P</mml:mtext><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">-</mml:mtext><mml:mtext mathvariant="normal">P</mml:mtext><mml:mi>m</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
    where <inline-formula><alternatives>
    <tex-math><![CDATA[n]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>
    is the order of approximation for the flux and
    <inline-formula><alternatives>
    <tex-math><![CDATA[m]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>m</mml:mi></mml:math></alternatives></inline-formula>
    is the order for the field values (temperature or density). Note
    that the flux is approximated in a subspace of
    <inline-formula><alternatives>
    <tex-math><![CDATA[{\mathbf{H}}(\textbf{div})]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>ùêá</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mtext mathvariant="bold">ùêùùê¢ùêØ</mml:mtext><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    while the field values are in a subspace of
    <inline-formula><alternatives>
    <tex-math><![CDATA[\mathit{L}^2]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mstyle mathvariant="italic"><mml:mi>ùêø</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula>
    <styled-content id="figU003Aconvergence"></styled-content>. For more
    details, see the <italic>‚ÄúMixed formulation and integration on
    skeleton‚Äù</italic> tutorial on
    (<xref alt="MoFEM Web Page, 2020" rid="ref-MoFEMWebPage" ref-type="bibr"><italic>MoFEM
    Web Page</italic>, 2020</xref>).</p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="LShape.pdf" xlink:title="" />
  </fig>
</sec>
<sec id="conclusions">
  <title>Conclusions</title>
  <p><monospace>MoFEM</monospace> introduces a novel architecture of FEM
  software, designed to exploit advantages of emerging finite element
  technologies and to enable rapid implementation of numerical models
  for complex engineering problems involving multi-physics and
  multi-scale processes.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p><monospace>MoFEM</monospace> development has been supported by EDF
  Energy Nuclear Generation Ltd., EPSRC (grants EP/R008531/1 and
  EP/K026925/1), The Royal Academy of Engineering (grant no.
  RCSRF1516\2\18) and Lord Kelvin Adam Smith programme at University of
  Glasgow.</p>
</sec>
</body>
<back>
<ref-list>
  <ref-list>
    <ref id="ref-tautges_moabU003A2004">
      <element-citation publication-type="report">
        <person-group person-group-type="author">
          <name><surname>Tautges</surname><given-names>T. J.</given-names></name>
          <name><surname>Meyers</surname><given-names>R.</given-names></name>
          <name><surname>Merkley</surname><given-names>K.</given-names></name>
          <name><surname>Stimpson</surname><given-names>C.</given-names></name>
          <name><surname>Ernst</surname><given-names>C.</given-names></name>
        </person-group>
        <article-title>MOAB: A mesh-oriented database</article-title>
        <publisher-name>Sandia National Laboratories</publisher-name>
        <year iso-8601-date="2004-04">2004</year><month>04</month>
        <pub-id pub-id-type="doi">10.2172/970174</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-ainsworth2003hierarchic">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Ainsworth</surname><given-names>Mark</given-names></name>
          <name><surname>Coyle</surname><given-names>Joe</given-names></name>
        </person-group>
        <article-title>Hierarchic finite element bases on unstructured tetrahedral meshes</article-title>
        <source>International Journal for Numerical Methods in Engineering</source>
        <publisher-name>John Wiley &amp; Sons, Ltd.</publisher-name>
        <year iso-8601-date="2003">2003</year>
        <volume>58</volume>
        <issue>14</issue>
        <issn>1097-0207</issn>
        <pub-id pub-id-type="doi">10.1002/nme.847</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-petsc-user-ref">
      <element-citation publication-type="report">
        <person-group person-group-type="author">
          <name><surname>Balay</surname><given-names>Satish</given-names></name>
          <name><surname>Abhyankar</surname><given-names>Shrirang</given-names></name>
          <name><surname>Adams</surname><given-names>Mark F.</given-names></name>
          <name><surname>Brown</surname><given-names>Jed</given-names></name>
          <name><surname>Brune</surname><given-names>Peter</given-names></name>
          <name><surname>Buschelman</surname><given-names>Kris</given-names></name>
          <name><surname>Dalcin</surname><given-names>Lisandro</given-names></name>
          <name><surname>Dener</surname><given-names>Alp</given-names></name>
          <name><surname>Eijkhout</surname><given-names>Victor</given-names></name>
          <name><surname>Gropp</surname><given-names>William D.</given-names></name>
          <name><surname>Karpeyev</surname><given-names>Dmitry</given-names></name>
          <name><surname>Kaushik</surname><given-names>Dinesh</given-names></name>
          <name><surname>Knepley</surname><given-names>Matthew G.</given-names></name>
          <name><surname>May</surname><given-names>Dave A.</given-names></name>
          <name><surname>McInnes</surname><given-names>Lois Curfman</given-names></name>
          <name><surname>Mills</surname><given-names>Richard Tran</given-names></name>
          <name><surname>Munson</surname><given-names>Todd</given-names></name>
          <name><surname>Rupp</surname><given-names>Karl</given-names></name>
          <name><surname>Sanan</surname><given-names>Patrick</given-names></name>
          <name><surname>Smith</surname><given-names>Barry F.</given-names></name>
          <name><surname>Zampini</surname><given-names>Stefano</given-names></name>
          <name><surname>Zhang</surname><given-names>Hong</given-names></name>
          <name><surname>Zhang</surname><given-names>Hong</given-names></name>
        </person-group>
        <article-title>PETSc users manual</article-title>
        <publisher-name>Argonne National Laboratory</publisher-name>
        <year iso-8601-date="2019">2019</year>
      </element-citation>
    </ref>
    <ref id="ref-boost-web-page">
      <element-citation>
        <article-title>Boost Web page</article-title>
        <year iso-8601-date="2020">2020</year>
        <uri>https://www.boost.org</uri>
      </element-citation>
    </ref>
    <ref id="ref-MoFEMWebPage">
      <element-citation>
        <article-title>MoFEM Web page</article-title>
        <year iso-8601-date="2020">2020</year>
        <uri>http://mofem.eng.gla.ac.uk</uri>
      </element-citation>
    </ref>
    <ref id="ref-MOABWebPage">
      <element-citation>
        <article-title>MOAB Web page</article-title>
        <year iso-8601-date="2020">2020</year>
        <uri>https://press3.mcs.anl.gov/sigma/</uri>
      </element-citation>
    </ref>
    <ref id="ref-ainsworth2011bernstein">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Ainsworth</surname><given-names>Mark</given-names></name>
          <name><surname>Andriamaro</surname><given-names>Gaelle</given-names></name>
          <name><surname>Davydov</surname><given-names>Oleg</given-names></name>
        </person-group>
        <article-title>Bernstein-B√©zier finite elements of arbitrary order and optimal assembly procedures</article-title>
        <source>SIAM Journal on Scientific Computing</source>
        <publisher-name>SIAM</publisher-name>
        <year iso-8601-date="2011">2011</year>
        <volume>33</volume>
        <issue>6</issue>
        <pub-id pub-id-type="doi">10.1137/11082539x</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-fuentes2015orientation">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Fuentes</surname><given-names>Federico</given-names></name>
          <name><surname>Keith</surname><given-names>Brendan</given-names></name>
          <name><surname>Demkowicz</surname><given-names>Leszek</given-names></name>
          <name><surname>Nagaraj</surname><given-names>Sriram</given-names></name>
        </person-group>
        <article-title>Orientation embedded high order shape functions for the exact sequence elements of all shapes</article-title>
        <source>Computers &amp; Mathematics with applications</source>
        <publisher-name>Elsevier</publisher-name>
        <year iso-8601-date="2015">2015</year>
        <volume>70</volume>
        <issue>4</issue>
        <pub-id pub-id-type="doi">10.1016/j.camwa.2015.04.027</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-kaczmarczyk2017energy">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Kaczmarczyk</surname><given-names>Lukasz</given-names></name>
          <name><surname>Ullah</surname><given-names>Zahur</given-names></name>
          <name><surname>Pearce</surname><given-names>Chris J</given-names></name>
        </person-group>
        <article-title>Energy consistent framework for continuously evolving 3D crack propagation</article-title>
        <source>Computer Methods in Applied Mechanics and Engineering</source>
        <publisher-name>Elsevier</publisher-name>
        <year iso-8601-date="2017">2017</year>
        <volume>324</volume>
        <pub-id pub-id-type="doi">10.1016/j.cma.2017.06.001</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-ullah2019unified">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Ullah</surname><given-names>Zahur</given-names></name>
          <name><surname>Zhou</surname><given-names>Xiao-Yi</given-names></name>
          <name><surname>Kaczmarczyk</surname><given-names>Lukasz</given-names></name>
          <name><surname>Archer</surname><given-names>E</given-names></name>
          <name><surname>McIlhagger</surname><given-names>A</given-names></name>
          <name><surname>Harkin-Jones</surname><given-names>E</given-names></name>
        </person-group>
        <article-title>A unified framework for the multi-scale computational homogenisation 3D-textile composites</article-title>
        <source>Composites Part B: Engineering</source>
        <publisher-name>Elsevier</publisher-name>
        <year iso-8601-date="2019">2019</year>
        <pub-id pub-id-type="doi">10.1016/j.compositesb.2019.03.027</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-guo1986hp">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Guo</surname><given-names>B</given-names></name>
          <name><surname>Babu≈°ka</surname><given-names>I</given-names></name>
        </person-group>
        <article-title>The h-p version of the finite element method</article-title>
        <source>Computational Mechanics</source>
        <publisher-name>Springer</publisher-name>
        <year iso-8601-date="1986">1986</year>
        <volume>1</volume>
        <issue>1</issue>
        <pub-id pub-id-type="doi">10.1007/BF00298636</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-kaczmarczyk2016prism">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Kaczmarczyk</surname><given-names>Lukasz</given-names></name>
          <name><surname>Ullah</surname><given-names>Zahur</given-names></name>
          <name><surname>Pearce</surname><given-names>Chris</given-names></name>
        </person-group>
        <article-title>Prism solid-shell with heterogonous and hierarchical approximation basis</article-title>
        <source>UKACM Cardiff, UK</source>
        <year iso-8601-date="2016-04">2016</year><month>04</month>
        <uri>http://doi.org/10.5281/zenodo.583683</uri>
        <pub-id pub-id-type="doi">10.5281/zenodo.789521</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-gopalakrishnan2012second">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Gopalakrishnan</surname><given-names>Jayadeep</given-names></name>
          <name><surname>Guzm√°n</surname><given-names>Johnny</given-names></name>
        </person-group>
        <article-title>A second elasticity element using the matrix bubble</article-title>
        <source>IMA Journal of Numerical Analysis</source>
        <publisher-name>OUP</publisher-name>
        <year iso-8601-date="2012">2012</year>
        <volume>32</volume>
        <issue>1</issue>
        <pub-id pub-id-type="doi">10.1093/imanum/drq047</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-richardson2018multiphysics">
      <element-citation publication-type="thesis">
        <person-group person-group-type="author">
          <name><surname>Richardson</surname><given-names>Euan J</given-names></name>
        </person-group>
        <article-title>A multiphysics finite element model of the wood cell wall</article-title>
        <publisher-name>University of Glasgow</publisher-name>
        <year iso-8601-date="2018">2018</year>
        <uri>http://theses.gla.ac.uk/9150/</uri>
      </element-citation>
    </ref>
    <ref id="ref-lew2020numerical">
      <element-citation>
        <person-group person-group-type="author">
          <name><surname>Lewandowski</surname><given-names>Karol</given-names></name>
          <name><surname>Kaczmarczyk</surname><given-names>≈Åukasz</given-names></name>
          <name><surname>Athanasiadis</surname><given-names>Ignatios</given-names></name>
          <name><surname>Marshall</surname><given-names>John F.</given-names></name>
          <name><surname>Pearce</surname><given-names>Chris J.</given-names></name>
        </person-group>
        <article-title>Numerical investigation into fracture resistance of bone following adaptation</article-title>
        <year iso-8601-date="2020">2020</year>
        <uri>https://arxiv.org/abs/2001.00647</uri>
      </element-citation>
    </ref>
    <ref id="ref-dealII91">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Arndt</surname><given-names>D.</given-names></name>
          <name><surname>Bangerth</surname><given-names>W.</given-names></name>
          <name><surname>Clevenger</surname><given-names>T. C.</given-names></name>
          <name><surname>Davydov</surname><given-names>D.</given-names></name>
          <name><surname>Fehling</surname><given-names>M.</given-names></name>
          <name><surname>Garcia-Sanchez</surname><given-names>D.</given-names></name>
          <name><surname>Harper</surname><given-names>G.</given-names></name>
          <name><surname>Heister</surname><given-names>T.</given-names></name>
          <name><surname>Heltai</surname><given-names>L.</given-names></name>
          <name><surname>Kronbichler</surname><given-names>M.</given-names></name>
          <name><surname>Kynch</surname><given-names>R. M.</given-names></name>
          <name><surname>Maier</surname><given-names>M.</given-names></name>
          <name><surname>Pelteret</surname><given-names>J.-P.</given-names></name>
          <name><surname>Turcksin</surname><given-names>B.</given-names></name>
          <name><surname>Wells</surname><given-names>D.</given-names></name>
        </person-group>
        <article-title>The deal.II library, version 9.1</article-title>
        <source>Journal of Numerical Mathematics</source>
        <year iso-8601-date="2019">2019</year>
        <uri>https://dealii.org/deal91-preprint.pdf</uri>
        <pub-id pub-id-type="doi">10.1515/jnma-2019-0064</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-doecode_1687">
      <element-citation>
        <person-group person-group-type="author">
          <name><surname>Kolev</surname><given-names>Tzanio</given-names></name>
          <name><surname>Dobrev</surname><given-names>Veselin</given-names></name>
        </person-group>
        <article-title>MFEM: Modular Finite Element Methods Library</article-title>
        <year iso-8601-date="2010">2010</year>
        <uri>http://mfem.org/</uri>
        <pub-id pub-id-type="doi">10.11578/dc.20171025.1248</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-libMeshPaper">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Kirk</surname><given-names>B. S.</given-names></name>
          <name><surname>Peterson</surname><given-names>J. W.</given-names></name>
          <name><surname>Stogner</surname><given-names>R. H.</given-names></name>
          <name><surname>Carey</surname><given-names>G. F.</given-names></name>
        </person-group>
        <article-title>libMesh: A C++ Library for Parallel Adaptive Mesh Refinement/Coarsening Simulations</article-title>
        <source>Engineering with Computers</source>
        <year iso-8601-date="2006">2006</year>
        <volume>22</volume>
        <issue>3‚Äì4</issue>
        <pub-id pub-id-type="doi">10.1007/s00366-006-0049-3</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-AlnaesBlechta2015a">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Aln√¶s</surname><given-names>Martin S.</given-names></name>
          <name><surname>Blechta</surname><given-names>Jan</given-names></name>
          <name><surname>Hake</surname><given-names>Johan</given-names></name>
          <name><surname>Johansson</surname><given-names>August</given-names></name>
          <name><surname>Kehlet</surname><given-names>Benjamin</given-names></name>
          <name><surname>Logg</surname><given-names>Anders</given-names></name>
          <name><surname>Richardson</surname><given-names>Chris</given-names></name>
          <name><surname>Ring</surname><given-names>Johannes</given-names></name>
          <name><surname>Rognes</surname><given-names>Marie E.</given-names></name>
          <name><surname>Wells</surname><given-names>Garth N.</given-names></name>
        </person-group>
        <article-title>The FEniCS project version 1.5</article-title>
        <source>Archive of Numerical Software</source>
        <year iso-8601-date="2015">2015</year>
        <volume>3</volume>
        <issue>100</issue>
        <pub-id pub-id-type="doi">10.11588/ans.2015.100.20553</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-MR3043640">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Hecht</surname><given-names>F.</given-names></name>
        </person-group>
        <article-title>New development in FreeFem++</article-title>
        <source>J. Numer. Math.</source>
        <year iso-8601-date="2012">2012</year>
        <volume>20</volume>
        <issue>3-4</issue>
        <issn>1570-2820</issn>
        <uri>https://freefem.org/</uri>
        <pub-id pub-id-type="doi">10.1515/jnum-2012-0013</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</ref-list>
</back>
</article>
