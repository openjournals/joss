<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">1236</article-id>
<article-id pub-id-type="doi">10.21105/joss.01236</article-id>
<title-group>
<article-title>pycoQC, interactive quality control for Oxford Nanopore
Sequencing</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0001-8772-6776</contrib-id>
<string-name>Adrien Leger</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-4449-1863</contrib-id>
<string-name>Tommaso Leonardi</string-name>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>European Molecular Biology Laboratory, European
Bioinformatics Institute, Hinxton, Cambridgeshire, UK</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Gurdon Institute, Cambridge, Cambridgeshire,
UK</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Center for Genomic Science IIT@SEMM, Istituto Italiano di
Tecnologia (IIT), Milan, Italy</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2018-11-08">
<day>8</day>
<month>11</month>
<year>2018</year>
</pub-date>
<volume>4</volume>
<issue>34</issue>
<fpage>1236</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2021</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>python3</kwd>
<kwd>plots</kwd>
<kwd>metrics</kwd>
<kwd>nanopore sequencing</kwd>
<kwd>interactive</kwd>
<kwd>quality control</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Nanopore sequencing of nucleic acids took nearly 30 years to
  develop and is now firmly established as an alternative to sequencing
  by synthesis methods
  (<xref alt="Deamer et al., 2016" rid="ref-deamer_three_2016" ref-type="bibr">Deamer
  et al., 2016</xref>). Oxford Nanopore Technologies (ONT) released the
  first commercial nanopore device for DNA sequencing in 2014 and has
  continually improved the technology since then
  (<xref alt="Jain et al., 2016" rid="ref-jain_oxford_2016" ref-type="bibr">Jain
  et al., 2016</xref>). Although the read accuracy is only around 90%,
  ONT technology can sequence very long molecules and generates data in
  real time. In addition, RNA can be sequenced directly and modified
  bases can be detected
  (<xref alt="Garalde et al., 2018" rid="ref-garalde_highly_2018" ref-type="bibr">Garalde
  et al., 2018</xref>).</p>
  <p>The electrical signal acquired by the array of nanopores is stored
  in HDF5 format, with one file (called FAST5) per molecule sequenced.
  The signal is then converted into a nucleic acid sequence using
  basecalling software. There are several alternatives, but the best
  performers for read accuracy are Albacore or Guppy developed and
  maintained by ONT
  (<xref alt="Wick et al., 2018" rid="ref-ryan_wick_comparison_2018" ref-type="bibr">Wick
  et al., 2018</xref>). Both can generate FASTQ files, FAST5 files
  containing basecalling information and a text summary file. Although
  ONT recently released best-practice guidelines for quality control
  analysis of sequencing runs
  (<xref alt="Oxford Nanopore Technologies, 2019" rid="ref-oxford_nanopore_technologies_bioinformatics_2019" ref-type="bibr">Oxford
  Nanopore Technologies, 2019</xref>), it did not provide a turnkey
  solution to explore the sequencing data quality in depth.</p>
  <p>Here we present pycoQC, a new tool to generate interactive quality
  control metrics and plots from basecalled nanopore reads or summary
  files generated by Albacore and Guppy. Although there are other
  open-source alternatives such as Nanoplot
  (<xref alt="De Coster et al., 2018" rid="ref-de_coster_nanopack_2018" ref-type="bibr">De
  Coster et al., 2018</xref>), MinionQC
  (<xref alt="Lanfear et al., 2018" rid="ref-lanfear_minionqc_2018" ref-type="bibr">Lanfear
  et al., 2018</xref>) and toulligQC
  (<xref alt="Laffay et al., 2018" rid="ref-berengere_laffay_toulligqc_2018" ref-type="bibr">Laffay
  et al., 2018</xref>), pycoQC has several novel features:</p>
  <list list-type="bullet">
    <list-item>
      <p>Integration with the plotly Python charting library to create
      dynamic D3.js visualizations
      (<xref alt="Plotly Technologies, 2015" rid="ref-plotly_technologies_inc_plotly_2015" ref-type="bibr">Plotly
      Technologies, 2015</xref>).</p>
    </list-item>
    <list-item>
      <p>Extensive Python API developed for interactive data exploration
      in Jupyter Notebooks
      (<xref alt="Jupyter Project, 2019" rid="ref-jupyter_project_and_community_jupyter_2019" ref-type="bibr">Jupyter
      Project, 2019</xref>)
      (<ext-link ext-link-type="uri" xlink:href="https://a-slide.github.io/pycoQC/pycoQC_usage.html">example
      notebook</ext-link>).</p>
    </list-item>
    <list-item>
      <p>Simple command line interface to generate customizable
      interactive HTML reports
      (<ext-link ext-link-type="uri" xlink:href="https://a-slide.github.io/pycoQC/data/output/Albacore-2.3.1_basecall-1D-RNA_pycoQC.html">example
      report</ext-link>).</p>
    </list-item>
    <list-item>
      <p>Multiprocessing FAST5 feature extraction program to generate a
      summary file directly from FAST5 files.</p>
    </list-item>
    <list-item>
      <p>Support for data generated by ONT MinION, GridION and
      PromethION devices, basecalled by Albacore 1.3+, Guppy 2.1.3+ or
      MinKNOW 18.12+.</p>
    </list-item>
  </list>
</sec>
<sec id="principle-and-example-output">
  <title>Principle and example output</title>
  <p>Briefly, pycoQC imports, filters and preprocesses one or several
  summary files generated with one of the previously mentioned
  basecallers. Alternatively, the input file can also be generated with
  the companion program <monospace>Fast5_to_seq_summary</monospace>
  included with the package. If available, calibration strand and
  barcoding information are also extracted either from the summary file
  (Albacore) or from a separate barcoding summary file (Guppy). Then, a
  range of plots and tables can be generated to explore the data. pycoQC
  plots are interactive, allowing users to display all the reads or only
  those above the quality threshold, to zoom in and to hide legend
  labels. The command line interface offers a simple and straightforward
  experience. On the other hand, the Python API for Jupyter notebook
  gives more flexibility to users who can easily customise and share
  their analyses. Example static versions of a selection of the tables
  and plots produced by pycoQC are presented in Figures 1 to 4.</p>
  <graphic mimetype="image" mime-subtype="png" xlink:href="pictures/summary.png" />
  <p><italic>Figure 1) Sequencing run summary statistics obtained with
  the <monospace>summary</monospace> function. On top of the overall run
  results, a breakdown per run ID is also displayed. pycoQC counts the
  number of bases and reads sequenced as well as the number of active
  channels and the run duration. In addition, the median read length,
  median read quality and the
  <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/N50,_L50,_and_related_statistics#N50">N50
  score</ext-link> are also computed.</italic></p>
  <graphic mimetype="image" mime-subtype="png" xlink:href="pictures/reads_qual_len_2D_example.png" />
  <p><italic>Figure 2) 2D density plot of the read length compared with
  the mean read PHRED quality generated with the
  <monospace>reads_len_qual_2D</monospace> function. This visualisation
  offers a quick overview of reads quality/length and allows the easy
  identification of read subpopulations. Read length and mean quality
  can also be explored independently using the 1D density plot functions
  <monospace>reads_len_1D</monospace> and
  <monospace>reads_qual_1D</monospace></italic>.</p>
  <graphic mimetype="image" mime-subtype="png" xlink:href="pictures/output_over_time.png" />
  <p><italic>Figure 3) Read and base output over experiment time
  obtained with the <monospace>output_over_time</monospace> function.
  Both the cumulative and interval yields are displayed together with
  time points at which 50%, 75%, 90%, 99% and 100% of the reads/bases
  were sequenced. Users can also follow the evolution of read length and
  read quality with the <monospace>len_over_time</monospace> and
  <monospace>qual_over_time</monospace> functions.</italic></p>
  <graphic mimetype="image" mime-subtype="png" xlink:href="pictures/channels_activity.png" />
  <p><italic>Figure 4) Yield over time per individual channel generated
  with the <monospace>channels_activity</monospace> function. Although
  the visualisation does not directly provide information about the
  flowcell layout, it gives a good overview of the heterogeneity of
  channels activity at runtime</italic></p>
</sec>
<sec id="availability">
  <title>Availability</title>
  <p>pycoQC is available at https://github.com/a-slide/pycoQC together
  with extensive documentation and some example Jupyter notebooks. The
  source code has been archived on Zenodo with the linked DOI:
  <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.1116396">10.5281/zenodo.1116396</ext-link></p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>The authors would like to thank Paulo Amaral, who generated most of
  the datasets provided as example data with pycoQC as well as Tomas
  Fitzgerald, Jack Monahan and Michael Clark who beta-tested the package
  and suggested new features. In addition we would also like to thank
  Kim Judge, Daan Verhagen and Jon Sanders for providing us with summary
  sequencing files used to develop and test the package. Finally, we
  thank Ewan Birney for reviewing the paper draft and Tony Kouzarides
  for providing funding for Tommaso Leonardi. Adrien Leger is supported
  by a fellowship co-funded by EMBL and the ERC Marie Curie Actions
  program.</p>
</sec>
</body>
<back>
<ref-list>
  <ref-list>
    <ref id="ref-jain_oxford_2016">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Jain</surname><given-names>Miten</given-names></name>
          <name><surname>Olsen</surname><given-names>Hugh E.</given-names></name>
          <name><surname>Paten</surname><given-names>Benedict</given-names></name>
          <name><surname>Akeson</surname><given-names>Mark</given-names></name>
        </person-group>
        <article-title>The Oxford Nanopore MinION: Delivery of nanopore sequencing to the genomics community</article-title>
        <source>Genome Biology</source>
        <year iso-8601-date="2016-11">2016</year><month>11</month>
        <date-in-citation content-type="access-date"><year iso-8601-date="2019-01-18">2019</year><month>01</month><day>18</day></date-in-citation>
        <volume>17</volume>
        <issue>1</issue>
        <issn>1474-760X</issn>
        <uri>https://doi.org/10.1186/s13059-016-1103-0</uri>
        <pub-id pub-id-type="doi">10.1186/s13059-016-1103-0</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-deamer_three_2016">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Deamer</surname><given-names>David</given-names></name>
          <name><surname>Akeson</surname><given-names>Mark</given-names></name>
          <name><surname>Branton</surname><given-names>Daniel</given-names></name>
        </person-group>
        <article-title>Three decades of nanopore sequencing</article-title>
        <source>Nature Biotechnology</source>
        <year iso-8601-date="2016-05">2016</year><month>05</month>
        <date-in-citation content-type="access-date"><year iso-8601-date="2019-01-18">2019</year><month>01</month><day>18</day></date-in-citation>
        <volume>34</volume>
        <issue>5</issue>
        <issn>1546-1696</issn>
        <uri>https://www.nature.com/articles/nbt.3423</uri>
        <pub-id pub-id-type="doi">10.1038/nbt.3423</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-ryan_wick_comparison_2018">
      <element-citation publication-type="report">
        <person-group person-group-type="author">
          <name><surname>Wick</surname><given-names>Ryan</given-names></name>
          <name><surname>Judd</surname><given-names>Louise M</given-names></name>
          <name><surname>Holt</surname><given-names>Kathryn E</given-names></name>
        </person-group>
        <article-title>Comparison of Oxford Nanopore basecalling tools</article-title>
        <publisher-name>Zenodo</publisher-name>
        <year iso-8601-date="2018-03">2018</year><month>03</month>
        <date-in-citation content-type="access-date"><year iso-8601-date="2019-01-18">2019</year><month>01</month><day>18</day></date-in-citation>
        <uri>https://zenodo.org/record/1188469</uri>
        <pub-id pub-id-type="doi">10.5281/zenodo.1188469</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-lanfear_minionqc_2018">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Lanfear</surname><given-names>R.</given-names></name>
          <name><surname>Schalamun</surname><given-names>M.</given-names></name>
          <name><surname>Kainer</surname><given-names>D.</given-names></name>
          <name><surname>Wang</surname><given-names>W.</given-names></name>
          <name><surname>Schwessinger</surname><given-names>B.</given-names></name>
        </person-group>
        <article-title>MinIONQC fast and simple quality control for MinION sequencing data</article-title>
        <source>Bioinformatics</source>
        <year iso-8601-date="2018">2018</year>
        <date-in-citation content-type="access-date"><year iso-8601-date="2019-01-18">2019</year><month>01</month><day>18</day></date-in-citation>
        <uri>https://academic.oup.com/bioinformatics/advance-article/doi/10.1093/bioinformatics/bty654/5057155</uri>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty654</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-de_coster_nanopack_2018">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>De Coster</surname><given-names>Wouter</given-names></name>
          <name><surname>D’Hert</surname><given-names>Svenn</given-names></name>
          <name><surname>Schultz</surname><given-names>Darrin T.</given-names></name>
          <name><surname>Cruts</surname><given-names>Marc</given-names></name>
          <name><surname>Van Broeckhoven</surname><given-names>Christine</given-names></name>
        </person-group>
        <article-title>NanoPack visualizing and processing long-read sequencing data</article-title>
        <source>Bioinformatics</source>
        <year iso-8601-date="2018-08">2018</year><month>08</month>
        <date-in-citation content-type="access-date"><year iso-8601-date="2019-01-18">2019</year><month>01</month><day>18</day></date-in-citation>
        <volume>34</volume>
        <issue>15</issue>
        <issn>1367-4803</issn>
        <uri>https://academic.oup.com/bioinformatics/article/34/15/2666/4934939</uri>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty149</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-berengere_laffay_toulligqc_2018">
      <element-citation>
        <person-group person-group-type="author">
          <name><surname>Laffay</surname><given-names>Bérengère</given-names></name>
          <name><surname>Ferrato-Berberian</surname><given-names>Lionel</given-names></name>
          <name><surname>Jourdren</surname><given-names>Laurent</given-names></name>
          <name><surname>Lemoine</surname><given-names>Sophie</given-names></name>
          <name><surname>Le Crom</surname><given-names>Stéphane</given-names></name>
        </person-group>
        <article-title>toulligQC, a post sequencing QC tool for Oxford Nanopore sequencers</article-title>
        <publisher-name>GenomicParisCentre</publisher-name>
        <year iso-8601-date="2018-10">2018</year><month>10</month>
        <date-in-citation content-type="access-date"><year iso-8601-date="2019-01-18">2019</year><month>01</month><day>18</day></date-in-citation>
        <uri>https://github.com/GenomicParisCentre/toulligQC</uri>
      </element-citation>
    </ref>
    <ref id="ref-jupyter_project_and_community_jupyter_2019">
      <element-citation>
        <person-group person-group-type="author">
          <string-name>Jupyter Project</string-name>
        </person-group>
        <article-title>The Jupyter Notebook</article-title>
        <year iso-8601-date="2019-01">2019</year><month>01</month>
        <date-in-citation content-type="access-date"><year iso-8601-date="2019-01-18">2019</year><month>01</month><day>18</day></date-in-citation>
        <uri>https://jupyter-notebook.readthedocs.io/en/stable/</uri>
      </element-citation>
    </ref>
    <ref id="ref-oxford_nanopore_technologies_bioinformatics_2019">
      <element-citation>
        <person-group person-group-type="author">
          <string-name>Oxford Nanopore Technologies</string-name>
        </person-group>
        <article-title>A bioinformatics tutorial demonstrating a best-practice workflow to review a flowcell’s sequence_summary.txt : Nanoporetech/ont_tutorial_basicqc</article-title>
        <publisher-name>Oxford Nanopore Technologies</publisher-name>
        <year iso-8601-date="2019-01">2019</year><month>01</month>
        <date-in-citation content-type="access-date"><year iso-8601-date="2019-01-25">2019</year><month>01</month><day>25</day></date-in-citation>
        <uri>https://github.com/nanoporetech/ont_tutorial_basicqc</uri>
      </element-citation>
    </ref>
    <ref id="ref-plotly_technologies_inc_plotly_2015">
      <element-citation>
        <person-group person-group-type="author">
          <string-name>Plotly Technologies</string-name>
        </person-group>
        <article-title>Plotly, charting tool for online collaborative data science</article-title>
        <year iso-8601-date="2015">2015</year>
        <uri>https://plot.ly</uri>
      </element-citation>
    </ref>
    <ref id="ref-garalde_highly_2018">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Garalde</surname><given-names>Daniel R.</given-names></name>
          <name><surname>Snell</surname><given-names>Elizabeth A.</given-names></name>
          <name><surname>Jachimowicz</surname><given-names>Daniel</given-names></name>
          <name><surname>Sipos</surname><given-names>Botond</given-names></name>
          <name><surname>Lloyd</surname><given-names>Joseph H.</given-names></name>
          <name><surname>Bruce</surname><given-names>Mark</given-names></name>
          <name><surname>Pantic</surname><given-names>Nadia</given-names></name>
          <name><surname>Admassu</surname><given-names>Tigist</given-names></name>
          <name><surname>James</surname><given-names>Phillip</given-names></name>
          <name><surname>Warland</surname><given-names>Anthony</given-names></name>
          <name><surname>Jordan</surname><given-names>Michael</given-names></name>
          <name><surname>Ciccone</surname><given-names>Jonah</given-names></name>
          <name><surname>Serra</surname><given-names>Sabrina</given-names></name>
          <name><surname>Keenan</surname><given-names>Jemma</given-names></name>
          <name><surname>Martin</surname><given-names>Samuel</given-names></name>
          <name><surname>McNeill</surname><given-names>Luke</given-names></name>
          <name><surname>Wallace</surname><given-names>E. Jayne</given-names></name>
          <name><surname>Jayasinghe</surname><given-names>Lakmal</given-names></name>
          <name><surname>Wright</surname><given-names>Chris</given-names></name>
          <name><surname>Blasco</surname><given-names>Javier</given-names></name>
          <name><surname>Young</surname><given-names>Stephen</given-names></name>
          <name><surname>Brocklebank</surname><given-names>Denise</given-names></name>
          <name><surname>Juul</surname><given-names>Sissel</given-names></name>
          <name><surname>Clarke</surname><given-names>James</given-names></name>
          <name><surname>Heron</surname><given-names>Andrew J.</given-names></name>
          <name><surname>Turner</surname><given-names>Daniel J.</given-names></name>
        </person-group>
        <article-title>Highly parallel direct RNA sequencing on an array of nanopores</article-title>
        <source>Nature Methods</source>
        <year iso-8601-date="2018-03">2018</year><month>03</month>
        <date-in-citation content-type="access-date"><year iso-8601-date="2019-01-25">2019</year><month>01</month><day>25</day></date-in-citation>
        <volume>15</volume>
        <issue>3</issue>
        <issn>1548-7105</issn>
        <uri>https://www.nature.com/articles/nmeth.4577</uri>
        <pub-id pub-id-type="doi">10.1038/nmeth.4577</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</ref-list>
</back>
</article>
