<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">2818</article-id>
<article-id pub-id-type="doi">10.21105/joss.02818</article-id>
<title-group>
<article-title>Cellocity: A Python package for analysis of confluent
cell layer dynamics</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-8945-2665</contrib-id>
<string-name>Jens Eriksson</string-name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<string-name>Daniel Styrström</string-name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-8355-0803</contrib-id>
<string-name>Mikael E. Sellin</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Science for Life Laboratory, Department of Medical
Biochemistry and Microbiology, Uppsala University</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Daniel Styrström Consulting</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2020-08-24">
<day>24</day>
<month>8</month>
<year>2020</year>
</pub-date>
<volume>6</volume>
<issue>57</issue>
<fpage>2818</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2021</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>microscopy</kwd>
<kwd>dynamics</kwd>
<kwd>confluent cell layer</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Studying the coordinated cell and tissue movements within confluent
  cell layers can give insights into diverse biological phenomena, such
  as wound healing, cancer cell metastasis, and host cell responses to
  infection. Cellular dynamics studies typically rely on analysis of
  time lapse images, generated by live cell microscopy. As a result of
  recent progress in stem cell and developmental biology, it is now
  often possible to generate confluent cell layers of primary cells that
  recapitulate central features of intact tissues
  (<xref alt="Dutton et al., 2019" rid="ref-Dutton2019" ref-type="bibr">Dutton
  et al., 2019</xref>). However, one disadvantage of such primary cell
  model systems is that it remains technically challenging to generate
  and image fluorescently labeled live samples. This complicates the use
  of segmentation and single-particle tracking as a means to study
  cellular movements
  (<xref alt="Danuser &amp; Waterman-Storer, 2006" rid="ref-Danuser2006" ref-type="bibr">Danuser
  &amp; Waterman-Storer, 2006</xref>). Consequently, optical flow-based
  analysis of bright field (black and white) microscopy images provides
  a competitive method to extract cell dynamics information from such
  sensitive and low-contrast experimental model systems
  (<xref alt="Vig et al., 2016" rid="ref-Vig2016" ref-type="bibr">Vig et
  al., 2016</xref>). Because the study of confluent cell layer dynamics
  lies at the intersection of biophysics and cell biology, two research
  communities with different emphasis on mathematics, there is a need
  for a simple and easy-to-use framework that performs and visualizes
  Optical Flow analysis of microscopy data. We here present Cellocity, a
  Python package for Optical Flow and Particle Image Velocimetry (PIV)
  analysis, specifically catering to the bioimaging community.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>To date, Optical Flow and PIV analysis of microscopy data has
  primarily relied on different plugins for ImageJ, such as
  <ext-link ext-link-type="uri" xlink:href="https://imagej.net/PIV_analyser">PIV
  analyser</ext-link>, or on MATLAB scripts
  (<xref alt="Vig et al., 2016" rid="ref-Vig2016" ref-type="bibr">Vig et
  al., 2016</xref>). However, these methods are limited in their
  accessibility, analysis capacity, metadata handling, and data
  visualization capabilities. Optical Flow and PIV are commonly used in
  the fields of fluid dynamics
  (<xref alt="Taylor et al., 2010" rid="ref-Taylor2010" ref-type="bibr">Taylor
  et al., 2010</xref>) and computer vision
  (<xref alt="Bradski, 2000" rid="ref-Bradski2000" ref-type="bibr">Bradski,
  2000</xref>), and several open source frameworks exist to service
  these communities, e.g.,
  <ext-link ext-link-type="uri" xlink:href="http://www.openpiv.net/">openPIV</ext-link>,
  <ext-link ext-link-type="uri" xlink:href="https://eguvep.github.io/jpiv/index.html">JPIV</ext-link>
  and
  <ext-link ext-link-type="uri" xlink:href="https://opencv.org/">OpenCV</ext-link>
  (<xref alt="Bradski, 2000" rid="ref-Bradski2000" ref-type="bibr">Bradski,
  2000</xref>). A corresponding framework for bioimaging and cell
  biology applications has so far been lacking.</p>
  <p>Cellocity is an Python-based bioimage analysis tool for quantifying
  cell and tissue dynamics. It has been developed as a flexible
  framework for researchers interested in investigating dynamic
  behaviors within confluent cell layers, and to address the Optical
  Flow/PIV needs unique to the microscopy community. Cellocity allows
  users to test and evaluate a diverse set of preprocessing steps,
  analysis algorithms, packages, and parameters on their experimental
  data. It provides a uniform programming interface to work with the
  many aspects in a cell dynamics analysis pipeline, from reading and
  preprocessing raw microscopy data, to creating flow visualizations and
  figures with the help of
  <ext-link ext-link-type="uri" xlink:href="https://matplotlib.org/">Matplotlib</ext-link>
  (<xref alt="Hunter, 2007" rid="ref-Hunter2007" ref-type="bibr">Hunter,
  2007</xref>).
  <ext-link ext-link-type="uri" xlink:href="https://numpy.org/">Numpy</ext-link>
  (<xref alt="van der Walt et al., 2011" rid="ref-vanderWalt2011" ref-type="bibr">van
  der Walt et al., 2011</xref>) is used extensively by Cellocity for
  array processing,
  <ext-link ext-link-type="uri" xlink:href="http://www.openpiv.net/openpiv-python/">OpenPIV-python</ext-link>
  (<xref alt="Liberzon et al., 2020" rid="ref-Liberzon2020" ref-type="bibr">Liberzon
  et al., 2020</xref>) provides the PIV analysis backbone, and the
  OpenCV implementation of Gunnar Farenbäck’s optical flow algorithm
  (<xref alt="Farnebäck, 2003" rid="ref-farneback03" ref-type="bibr">Farnebäck,
  2003</xref>) is the basis of the optical flow analysis.</p>
  <p>One unique feature of microscopy data is that the spatial
  resolution (pixel size) can be known to a high degree of accuracy, and
  together with frame time-stamps this can be used to calculate accurate
  flow velocities. A major problem when performing preprocessing of time
  lapse microscopy data, for example through temporal median filtering,
  is that such operations sometimes can change the time interval between
  frames and/or the pixel size. Cellocity is by design keeping track of
  and recalculating time and space units during operations, so as to not
  report back erroneous output data to the user. It is possible to
  configure Cellocity to give output in different units, such as µm/min
  or µm/h, depending on the time scale of the experiment being analyzed.
  Moreover, Cellocity can calculate derived parameters, including the i)
  Instantaneous Order Parameter
  (<xref alt="Malinverno et al., 2017" rid="ref-Malinverno2017" ref-type="bibr">Malinverno
  et al., 2017</xref>), ii) Alignment Index
  (<xref alt="Malinverno et al., 2017" rid="ref-Malinverno2017" ref-type="bibr">Malinverno
  et al., 2017</xref>), and/or iii) 5-sigma correlation length
  (<xref alt="Lång et al., 2018" rid="ref-Laang2018" ref-type="bibr">Lång
  et al., 2018</xref>), and thereby provides the user with a
  comprehensive tool box to describe confluent cell layer dynamics
  phenomena.</p>
</sec>
<sec id="validation-of-the-software">
  <title>Validation of the software</title>
  <p>To validate and test the different modules and components of
  Cellocity, a validation dataset has been constructed. The dataset has
  been deposited in the BioStudies database under the accession number
  <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/biostudies/studies/S-BSST461">S-BSST461</ext-link>.
  It is comprised of a collection of files that were generated by
  translating and imaging a fixed monolayer of murine primary gut
  epithelium on a high-precision linear microscope stage, using a wide
  selection of magnifications. 10 images were acquired with the stage
  translated 1um in either the X, Y, or both directions simultaneously
  between frames. The dataset is described in detail in the
  <ext-link ext-link-type="uri" xlink:href="https://cellocity.readthedocs.io/en/latest/validation.html">validation
  section</ext-link> of the Cellocity documentation. Downloading this
  dataset allows users and contributors (to Cellocity and other
  software) to validate and test their installations and custom modules
  against a standard, comprised of real-world data where the flow is
  known and uniform, and the data has not been synthetically generated,
  but has passed through the optical transfer function (OTF) of an
  actual microscope setup.</p>
  <p>The main advantages of Cellocity is its ability work on unlabeled
  Bright field time lapse microscopy data, and to both quantify and
  visualize abstract Optical Flow analyses to the user. Cellocity aims
  to make Optical Flow-based analysis of microscopy data easily
  accessible, by providing a framework that keeps track of image
  metadata, performs common pre-processing steps, and implements
  previously published analysis algorithms
  (<xref alt="Lång et al., 2018" rid="ref-Laang2018" ref-type="bibr">Lång
  et al., 2018</xref>;
  <xref alt="Malinverno et al., 2017" rid="ref-Malinverno2017" ref-type="bibr">Malinverno
  et al., 2017</xref>). The architecture of Cellocity is designed with
  extensibility and modularity in mind. Implementing new analysis
  modules, image readers, and visualizations is straight forward with
  the help of Cellocity’s
  <ext-link ext-link-type="uri" xlink:href="https://cellocity.readthedocs.io/en/latest/developer.html">developer
  guide</ext-link> and
  <ext-link ext-link-type="uri" xlink:href="https://cellocity.readthedocs.io/en/latest/api.html">API</ext-link>.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We thank Pilar Samperio Ventayol for preparing the fixed murine
  intestinal epithelial monolayer used to generate the validation
  dataset. This work was financed by the SciLifeLab Fellows program and
  the Swedish Foundation for Strategic Research (ICA16-0031). We also
  acknowledge support from the Knut and Alice Wallenberg Foundation
  (2016.0063) and the Malin and Lennart Philipson Foundation (L.P. Award
  2018) that enabled development of the imaging technology used in this
  study.</p>
</sec>
</body>
<back>
<ref-list>
  <ref-list>
    <ref id="ref-Laang2018">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Lång</surname><given-names>Emma</given-names></name>
          <name><surname>Połeć</surname><given-names>Anna</given-names></name>
          <name><surname>Lång</surname><given-names>Anna</given-names></name>
          <name><surname>Valk</surname><given-names>Marijke</given-names></name>
          <name><surname>Blicher</surname><given-names>Pernille</given-names></name>
          <name><surname>Rowe</surname><given-names>Alexander D.</given-names></name>
          <name><surname>Tønseth</surname><given-names>Kim A.</given-names></name>
          <name><surname>Jackson</surname><given-names>Catherine J.</given-names></name>
          <name><surname>Utheim</surname><given-names>Tor P.</given-names></name>
          <name><surname>Janssen</surname><given-names>Liesbeth M. C.</given-names></name>
          <name><surname>Eriksson</surname><given-names>Jens</given-names></name>
          <name><surname>Bøe</surname><given-names>Stig Ove</given-names></name>
        </person-group>
        <article-title>Coordinated collective migration and asymmetric cell division in confluent human keratinocytes without wounding</article-title>
        <source>Nature communications</source>
        <year iso-8601-date="2018">2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <issn>2041-1723</issn>
        <pub-id pub-id-type="doi">10.1038/s41467-018-05578-7</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Malinverno2017">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Malinverno</surname><given-names>Chiara</given-names></name>
          <name><surname>Corallino</surname><given-names>Salvatore</given-names></name>
          <name><surname>Giavazzi</surname><given-names>Fabio</given-names></name>
          <name><surname>Bergert</surname><given-names>Martin</given-names></name>
          <name><surname>Li</surname><given-names>Qingsen</given-names></name>
          <name><surname>Leoni</surname><given-names>Marco</given-names></name>
          <name><surname>Disanza</surname><given-names>Andrea</given-names></name>
          <name><surname>Frittoli</surname><given-names>Emanuela</given-names></name>
          <name><surname>Oldani</surname><given-names>Amanda</given-names></name>
          <name><surname>Martini</surname><given-names>Emanuele</given-names></name>
          <name><surname>Lendenmann</surname><given-names>Tobias</given-names></name>
          <name><surname>Deflorian</surname><given-names>Gianluca</given-names></name>
          <name><surname>Beznoussenko</surname><given-names>Galina V.</given-names></name>
          <name><surname>Poulikakos</surname><given-names>Dimos</given-names></name>
          <name><surname>Haur</surname><given-names>Ong Kok</given-names></name>
          <name><surname>Uroz</surname><given-names>Marina</given-names></name>
          <name><surname>Trepat</surname><given-names>Xavier</given-names></name>
          <name><surname>Parazzoli</surname><given-names>Dario</given-names></name>
          <name><surname>Maiuri</surname><given-names>Paolo</given-names></name>
          <name><surname>Yu</surname><given-names>Weimiao</given-names></name>
          <name><surname>Ferrari</surname><given-names>Aldo</given-names></name>
          <name><surname>Cerbino</surname><given-names>Roberto</given-names></name>
          <name><surname>Scita</surname><given-names>Giorgio</given-names></name>
        </person-group>
        <article-title>Endocytic reawakening of motility in jammed epithelia</article-title>
        <source>Nature materials</source>
        <year iso-8601-date="2017">2017</year>
        <volume>16</volume>
        <issue>5</issue>
        <issn>1476-1122</issn>
        <pub-id pub-id-type="doi">10.1038/nmat4848</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-vanderWalt2011">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>van der Walt</surname><given-names>Stefan</given-names></name>
          <name><surname>Colbert</surname><given-names>S Chris</given-names></name>
          <name><surname>Varoquaux</surname><given-names>Gael</given-names></name>
        </person-group>
        <article-title>The NumPy array: A structure for efficient numerical computation</article-title>
        <source>Computing in Science Engineering</source>
        <year iso-8601-date="2011">2011</year>
        <volume>13</volume>
        <issue>2</issue>
        <pub-id pub-id-type="doi">10.1109/MCSE.2011.37</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Taylor2010">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Taylor</surname><given-names>Zachary J.</given-names></name>
          <name><surname>Gurka</surname><given-names>Roi</given-names></name>
          <name><surname>Kopp</surname><given-names>Gregory A.</given-names></name>
          <name><surname>Liberzon</surname><given-names>Alex</given-names></name>
        </person-group>
        <article-title>Long-duration time-resolved PIV to study unsteady aerodynamics</article-title>
        <source>IEEE Transactions on Instrumentation and Measurement</source>
        <year iso-8601-date="2010">2010</year>
        <volume>59</volume>
        <issue>12</issue>
        <pub-id pub-id-type="doi">10.1109/TIM.2010.2047149</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Bradski2000">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Bradski</surname><given-names>Gary</given-names></name>
        </person-group>
        <article-title>The OpenCV Library</article-title>
        <source>Dr. Dobb’s Journal of Software Tools</source>
        <year iso-8601-date="2000">2000</year>
        <volume>25</volume>
      </element-citation>
    </ref>
    <ref id="ref-Hunter2007">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Hunter</surname><given-names>John D.</given-names></name>
        </person-group>
        <article-title>Matplotlib: A 2D graphics environment</article-title>
        <source>Computing in Science &amp; Engineering</source>
        <publisher-name>IEEE COMPUTER SOC</publisher-name>
        <year iso-8601-date="2007">2007</year>
        <volume>9</volume>
        <issue>3</issue>
        <pub-id pub-id-type="doi">10.1109/MCSE.2007.55</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Vig2016">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Vig</surname><given-names>Dhruv K.</given-names></name>
          <name><surname>Hamby</surname><given-names>Alex E.</given-names></name>
          <name><surname>Wolgemuth</surname><given-names>Charles W.</given-names></name>
        </person-group>
        <article-title>On the quantification of cellular velocity fields</article-title>
        <source>Biophysical Journal</source>
        <year iso-8601-date="2016">2016</year>
        <volume>110</volume>
        <issn>0006-3495</issn>
        <pub-id pub-id-type="doi">10.1016/j.bpj.2016.02.032</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Dutton2019">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Dutton</surname><given-names>Johanna S.</given-names></name>
          <name><surname>Hinman</surname><given-names>Samuel S.</given-names></name>
          <name><surname>Kim</surname><given-names>Raehyun</given-names></name>
          <name><surname>Wang</surname><given-names>Yuli</given-names></name>
          <name><surname>Allbritton</surname><given-names>Nancy L.</given-names></name>
        </person-group>
        <article-title>Primary cell-derived intestinal models: Recapitulating physiology.</article-title>
        <source>Trends in biotechnology</source>
        <year iso-8601-date="2019-07">2019</year><month>07</month>
        <volume>37</volume>
        <issn>1879-3096</issn>
        <pub-id pub-id-type="doi">10.1016/j.tibtech.2018.12.001</pub-id>
        <pub-id pub-id-type="pmid">30591184</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Danuser2006">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Danuser</surname><given-names>Gaudenz</given-names></name>
          <name><surname>Waterman-Storer</surname><given-names>Clare M.</given-names></name>
        </person-group>
        <article-title>Quantitative fluorescent speckle microscopy of cytoskeleton dynamics.</article-title>
        <source>Annual review of biophysics and biomolecular structure</source>
        <year iso-8601-date="2006">2006</year>
        <volume>35</volume>
        <issn>1056-8700</issn>
        <pub-id pub-id-type="doi">10.1146/annurev.biophys.35.040405.102114</pub-id>
        <pub-id pub-id-type="pmid">16689641</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-farneback03">
      <element-citation publication-type="paper-conference">
        <person-group person-group-type="author">
          <name><surname>Farnebäck</surname><given-names>Gunnar</given-names></name>
        </person-group>
        <article-title>Two-frame motion estimation based on polynomial expansion</article-title>
        <source>Proceedings of the 13th scandinavian conference on image analysis</source>
        <publisher-loc>Gothenburg, Sweden</publisher-loc>
        <year iso-8601-date="2003">2003</year>
        <pub-id pub-id-type="doi">10.1007/3-540-45103-x_50</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Liberzon2020">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Liberzon</surname><given-names>Alex</given-names></name>
          <name><surname>Lasagna</surname><given-names>Davide</given-names></name>
          <name><surname>Aubert</surname><given-names>Mathias</given-names></name>
          <name><surname>Bachant</surname><given-names>Pete</given-names></name>
          <name><surname>Käufer</surname><given-names>Theo</given-names></name>
          <name><surname>jakirkham</surname></name>
          <name><surname>Bauer</surname><given-names>Andreas</given-names></name>
          <name><surname>Vodenicharski</surname><given-names>Boyko</given-names></name>
          <name><surname>Dallas</surname><given-names>Cameron</given-names></name>
          <name><surname>Borg</surname><given-names>Joe</given-names></name>
          <name><surname>al.</surname></name>
        </person-group>
        <article-title>OpenPIV/openpiv-python: OpenPIV - python (v0.22.2) with a new extended search PIV grid option</article-title>
        <publisher-name>Zenodo</publisher-name>
        <year iso-8601-date="2020-07">2020</year><month>07</month>
        <pub-id pub-id-type="doi">10.5281/zenodo.3930343</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</ref-list>
</back>
</article>
