<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">142</article-id>
<article-id pub-id-type="doi">10.21105/joss.00142</article-id>
<title-group>
<article-title>shmlast: An improved implementation of Conditional
Reciprocal Best Hits with LAST and Python</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0001-8822-8779</contrib-id>
<string-name>Camille Scott</string-name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>University of California, Davis</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2016-11-21">
<day>21</day>
<month>11</month>
<year>2016</year>
</pub-date>
<volume>2</volume>
<issue>9</issue>
<fpage>142</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2021</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>bioinformatics</kwd>
<kwd>orthology</kwd>
<kwd>alignment</kwd>
<kwd>LAST</kwd>
<kwd>BLAST</kwd>
<kwd>python</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Conditional Reciprocal Best Hits (CRBH) was originally described by
  Aubry et
  al.(<xref alt="Aubry et al., 2014" rid="ref-aubry_deep_2014" ref-type="bibr">Aubry
  et al., 2014</xref>) and implemented in the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/cboursnell/crb-blast">crb-blast</ext-link>
  package. CRBH is a method for finding orthologs between two sets of
  sequences which builds on the traditional Reciprocal Best Hits (RBH)
  method; it improves RBH by finding an expect-value cutoff per
  alignment length, and then selecting non-reciprocal alignments which
  meet the minimum threshold.</p>
  <p>Unfortunately, the original implementation uses the relatively slow
  NCBI BLAST+
  (<xref alt="Altschul et al., 1990" rid="ref-altschul_basic_1990" ref-type="bibr">Altschul
  et al., 1990</xref>), and is implemented in Ruby, which requires users
  to leave the Python-dominated bioinformatics ecosystem. shmlast makes
  CRBH available to users in Python, while also greatly improving
  performance by using the LAST aligner
  (<xref alt="Kiełbasa et al., 2011" rid="ref-kielbasa_adaptive_2011" ref-type="bibr">Kiełbasa
  et al., 2011</xref>) for initial homology searches. Other improvements
  include outputting the list of cutoffs generated by its model along
  with a plot of the decision boundary to aid in quality control, as
  well as using gnu-parallel
  (<xref alt="Tange, 2011" rid="ref-tange_gnu_2011" ref-type="bibr">Tange,
  2011</xref>) to parallelize execution across multiple cores or nodes
  in a cluster environment.</p>
</sec>
<sec id="methods">
  <title>Methods</title>
  <p>RBH is a relatively old method for determining orthologs between
  two sequence databases. Orthology is distinguished from sequence
  similarity by descent; while two sequences with high similarity are
  likely to have structural of functional homology, they are orthologous
  if they share a common ancestor sequence. It is difficult to know for
  sure whether two sequences are orthologs, but orthologous groups of
  sequences are critical for a variety of analyses surrounding
  structure, function, and evolution, and particularly, for annotation.
  As such, many methods have been developed for separating
  high-similarity alignments from their orthologous counterparts. RBH is
  the regal elder of these methods, and although it is simplistic
  compared to newer clustering and graph-based methods, it remains in
  wide use due to its low false-positive rate and ease of
  implementation. It is performed as follows: given two sets of
  sequences <inline-formula><alternatives>
  <tex-math><![CDATA[A]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>A</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[B]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>B</mml:mi></mml:math></alternatives></inline-formula>,
  sequences <inline-formula><alternatives>
  <tex-math><![CDATA[a_i \in A]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[b_j \in B]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  are Reciprocal Best Hits if <inline-formula><alternatives>
  <tex-math><![CDATA[b_j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  has the highest scoring sequence alignment in
  <inline-formula><alternatives>
  <tex-math><![CDATA[B]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>B</mml:mi></mml:math></alternatives></inline-formula>
  for <inline-formula><alternatives>
  <tex-math><![CDATA[a_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[a_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  has the highest scoring sequence alignment in
  <inline-formula><alternatives>
  <tex-math><![CDATA[A]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>A</mml:mi></mml:math></alternatives></inline-formula>
  for <inline-formula><alternatives>
  <tex-math><![CDATA[b_j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.
  <inline-formula><alternatives>
  <tex-math><![CDATA[a_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[b_j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  then have a high probability of being orthologs.</p>
  <p>While this method works well for finding orthologs between two sets
  of proteins from different species, it is less effective for
  annotating newly assembled transcriptomes from existing protein
  databases. Transcriptomes are confounded by alternative splicing,
  causing several transcripts to share subsequences, which may prevent
  RBH detection between a translated transcript and its protein, even
  when an orthology relationship exists. Aubry et al., and this
  implementation, circumvent that problem by first using the reciprocals
  to establish a score cutoff for each alignment length, and then
  keeping <italic>any</italic> alignment which passes that cutoff. This
  prevents alignments with high-likelihood of being orthologs based on
  sequence identity from being discarded due to the high specificity of
  RBH.</p>
</sec>
<sec id="performance">
  <title>Performance</title>
  <p>shmlast benefits immensely from the use of LAST over BLAST. It
  scales well by using gnu-parallel, and can be distributed across
  clusters for particularly large runs.</p>
  <fig>
    <caption><p>Performance comparison with
    <ext-link ext-link-type="uri" xlink:href="ftp://ftp.ebi.ac.uk/pub/databases/pombase/FASTA/cdna_nointrons_utrs.fa.gz"><italic>Schizosaccharomyces
    pombe</italic></ext-link>
    (<xref alt="Wood et al., 2012" rid="ref-wood_pombaseU003A_2012" ref-type="bibr">Wood
    et al., 2012</xref>) as the query transcriptome and
    <ext-link ext-link-type="uri" xlink:href="ftp://ftp.ebi.ac.uk/pub/databases/reference_proteomes/QfO/Eukaryota/UP000001593_45351.fasta.gz"><italic>Nematostella
    vectensis</italic></ext-link>
    (<xref alt="Apweiler et al., 2004" rid="ref-apweiler_protein_2004" ref-type="bibr">Apweiler
    et al., 2004</xref>) as the target proteome.</p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="../perf/results.pdf" xlink:title="" />
  </fig>
  <fig>
    <caption><p>CRBH model generated from the performance comparison.
    Hits with scores above the blue dotted line will be
    kept.</p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="sacPom.cdna.fa.x.Nematostella_vectensis.uniprot.pep.fa.crbl.model.plot.pdf" xlink:title="" />
  </fig>
</sec>
</body>
<back>
<ref-list>
  <ref-list>
    <ref id="ref-kielbasa_adaptive_2011">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Kiełbasa</surname><given-names>Szymon M.</given-names></name>
          <name><surname>Wan</surname><given-names>Raymond</given-names></name>
          <name><surname>Sato</surname><given-names>Kengo</given-names></name>
          <name><surname>Horton</surname><given-names>Paul</given-names></name>
          <name><surname>Frith</surname><given-names>Martin C.</given-names></name>
        </person-group>
        <article-title>Adaptive seeds tame genomic sequence comparison</article-title>
        <source>Genome Research</source>
        <year iso-8601-date="2011-03">2011</year><month>03</month>
        <date-in-citation content-type="access-date"><year iso-8601-date="2015-10-02">2015</year><month>10</month><day>02</day></date-in-citation>
        <volume>21</volume>
        <issue>3</issue>
        <issn>1088-9051, 1549-5469</issn>
        <uri>http://genome.cshlp.org/content/21/3/487</uri>
        <pub-id pub-id-type="doi">10.1101/gr.113985.110</pub-id>
        <pub-id pub-id-type="pmid">21209072</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-aubry_deep_2014">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Aubry</surname><given-names>Sylvain</given-names></name>
          <name><surname>Kelly</surname><given-names>Steven</given-names></name>
          <name><surname>Kümpers</surname><given-names>Britta M. C.</given-names></name>
          <name><surname>Smith-Unna</surname><given-names>Richard D.</given-names></name>
          <name><surname>Hibberd</surname><given-names>Julian M.</given-names></name>
        </person-group>
        <article-title>Deep Evolutionary Comparison of Gene Expression Identifies Parallel Recruitment of Trans -Factors in Two Independent Origins of C 4 Photosynthesis</article-title>
        <source>PLOS Genet</source>
        <year iso-8601-date="2014-06">2014</year><month>06</month>
        <date-in-citation content-type="access-date"><year iso-8601-date="2016-05-11">2016</year><month>05</month><day>11</day></date-in-citation>
        <volume>10</volume>
        <issue>6</issue>
        <issn>1553-7404</issn>
        <uri>http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1004365</uri>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1004365</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-altschul_basic_1990">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Altschul</surname><given-names>S. F.</given-names></name>
          <name><surname>Gish</surname><given-names>W.</given-names></name>
          <name><surname>Miller</surname><given-names>W.</given-names></name>
          <name><surname>Myers</surname><given-names>E. W.</given-names></name>
          <name><surname>Lipman</surname><given-names>D. J.</given-names></name>
        </person-group>
        <article-title>Basic local alignment search tool</article-title>
        <source>Journal of Molecular Biology</source>
        <year iso-8601-date="1990-10">1990</year><month>10</month>
        <volume>215</volume>
        <issue>3</issue>
        <issn>0022-2836</issn>
        <pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-tange_gnu_2011">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Tange</surname><given-names>O.</given-names></name>
        </person-group>
        <article-title>GNU Parallel - The Command-Line Power Tool</article-title>
        <source>;login: The USENIX Magazine</source>
        <year iso-8601-date="2011-02">2011</year><month>02</month>
        <volume>36</volume>
        <issue>1</issue>
        <uri>http://www.gnu.org/s/parallel</uri>
        <pub-id pub-id-type="doi">10.5281/zenodo.16303</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-apweiler_protein_2004">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Apweiler</surname><given-names>Rolf</given-names></name>
          <name><surname>Bairoch</surname><given-names>Amos</given-names></name>
          <name><surname>Wu</surname><given-names>Cathy H</given-names></name>
        </person-group>
        <article-title>Protein sequence databases</article-title>
        <source>Current Opinion in Chemical Biology</source>
        <year iso-8601-date="2004-02">2004</year><month>02</month>
        <date-in-citation content-type="access-date"><year iso-8601-date="2017-01-10">2017</year><month>01</month><day>10</day></date-in-citation>
        <volume>8</volume>
        <issue>1</issue>
        <issn>1367-5931</issn>
        <uri>http://www.sciencedirect.com/science/article/pii/S136759310300173X</uri>
        <pub-id pub-id-type="doi">10.1016/j.cbpa.2003.12.004</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-wood_pombaseU003A_2012">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Wood</surname><given-names>Valerie</given-names></name>
          <name><surname>Harris</surname><given-names>Midori A.</given-names></name>
          <name><surname>McDowall</surname><given-names>Mark D.</given-names></name>
          <name><surname>Rutherford</surname><given-names>Kim</given-names></name>
          <name><surname>Vaughan</surname><given-names>Brendan W.</given-names></name>
          <name><surname>Staines</surname><given-names>Daniel M.</given-names></name>
          <name><surname>Aslett</surname><given-names>Martin</given-names></name>
          <name><surname>Lock</surname><given-names>Antonia</given-names></name>
          <name><surname>Bähler</surname><given-names>Jürg</given-names></name>
          <name><surname>Kersey</surname><given-names>Paul J.</given-names></name>
          <name><surname>Oliver</surname><given-names>Stephen G.</given-names></name>
        </person-group>
        <article-title>PomBase: A comprehensive online resource for fission yeast</article-title>
        <source>Nucleic Acids Research</source>
        <year iso-8601-date="2012-01">2012</year><month>01</month>
        <date-in-citation content-type="access-date"><year iso-8601-date="2017-01-10">2017</year><month>01</month><day>10</day></date-in-citation>
        <volume>40</volume>
        <issue>D1</issue>
        <issn>0305-1048, 1362-4962</issn>
        <uri>http://nar.oxfordjournals.org/content/40/D1/D695</uri>
        <pub-id pub-id-type="doi">10.1093/nar/gkr853</pub-id>
        <pub-id pub-id-type="pmid">22039153</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</ref-list>
</back>
</article>
