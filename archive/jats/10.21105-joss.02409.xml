<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">2409</article-id>
<article-id pub-id-type="doi">10.21105/joss.02409</article-id>
<title-group>
<article-title>Vizumap: an R package for visualising uncertainty in
spatial data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<string-name>Lydia R. Lucchesi</string-name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<string-name>Petra M. Kuhnert</string-name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<string-name>Christopher K. Wikle</string-name>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Australian National University, Canberra,
Australia</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>CSIRO Data61, Canberra, Australia</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>University of Missouri, Columbia, USA</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2020-06-03">
<day>3</day>
<month>6</month>
<year>2020</year>
</pub-date>
<volume>6</volume>
<issue>59</issue>
<fpage>2409</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2021</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>spatial statistics</kwd>
<kwd>visualisation</kwd>
<kwd>uncertainty</kwd>
<kwd>maps</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>To make a sound data-driven decision, it is necessary to consider
  the quality and strength of the evidence. Therefore, it is important
  that the uncertainty of statistical estimates be effectively
  communicated to decision makers to ensure it is properly considered in
  the decision-making process. Generally, this uncertainty information
  is shared through visualisation (e.g., error bars). However, in
  spatial applications, finding methods that can communicate additional
  information, about the spatial estimates, in an understandable and
  meaningful way can be challenging. To address this visualisation
  shortcoming in spatial statistics, we developed the
  <monospace>Vizumap</monospace> R package. It is a toolkit designed for
  statisticians, scientists, data journalists, etc., discussing
  uncertainty in spatial data.</p>
  <p><monospace>Vizumap</monospace> contains a series of straightforward
  functions that can be used to create four different types of maps,
  which are discussed in detail in Lucchesi &amp; Wikle
  (<xref alt="2017" rid="ref-vizMethod" ref-type="bibr">2017</xref>) and
  Kuhnert et al.
  (<xref alt="2018" rid="ref-gbrData" ref-type="bibr">2018</xref>). The
  visualisation methods include the bivariate choropleth map, pixel map,
  glyph map, and exceedance probability map. Following is a brief
  description of each method.</p>
  <list list-type="bullet">
    <list-item>
      <p>For the bivariate choropleth map, two colour scales are merged
      to create a bivariate grid that can encode the estimates and
      errors at once, making it possible to fill each region with a
      single colour that represents both values.</p>
    </list-item>
    <list-item>
      <p>The pixel map is generated by dividing each region into small
      pixels, which are then filled with a colour value sampled from the
      colour gradient range. The method for assigning colours to pixels
      depends on the type of distribution specified. Areas of greater
      uncertainty appear pixelated while areas of less uncertainty
      appear smooth, as though filled by only a single colour. These
      pixel maps can be animated so that areas of high uncertainty
      flicker while areas of low uncertainty appear static to the
      eye.</p>
    </list-item>
    <list-item>
      <p>The glyph map is intended to address the issue of unequal
      region sizes on a choropleth map. Glyphs of equal size are placed
      at the centroid of each region, filled with a colour that
      represents the estimate, and rotated depending on the degree of
      uncertainty.</p>
    </list-item>
    <list-item>
      <p>Exceedance probability maps show the probability of exceeding a
      nominated threshold of concern. These probabilities can be
      pre-calculated and passed to the exceedance probability map
      function or calculated within the function given a prescribed
      probability distribution function, estimate, and error. For
      example, let <inline-formula><alternatives>
      <tex-math><![CDATA[X]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>X</mml:mi></mml:math></alternatives></inline-formula>
      denote a random variable, and <inline-formula><alternatives>
      <tex-math><![CDATA[x]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
      is a possible value of that random variable,
      <inline-formula><alternatives>
      <tex-math><![CDATA[X]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>X</mml:mi></mml:math></alternatives></inline-formula>.
      <inline-formula><alternatives>
      <tex-math><![CDATA[F_x(x)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      is the cumulative distribution function and equals the probability
      that the value of <inline-formula><alternatives>
      <tex-math><![CDATA[X]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>X</mml:mi></mml:math></alternatives></inline-formula>
      is less than or equal to a specific value or threshold,
      <inline-formula><alternatives>
      <tex-math><![CDATA[x]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>,
      so
      <named-content id="eqU003Aeq1" content-type="equation"><disp-formula><alternatives>
      <tex-math><![CDATA[\label{eq:eq1}
      {F_x(x) = Pr[X {\leq} x].}]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>X</mml:mi><mml:mo>≤</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></named-content>
      The probability that the value <inline-formula><alternatives>
      <tex-math><![CDATA[X]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>X</mml:mi></mml:math></alternatives></inline-formula>
      is greater than the specific threshold
      <inline-formula><alternatives>
      <tex-math><![CDATA[x]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
      can then be written as
      <named-content id="eqU003Aeq2" content-type="equation"><disp-formula><alternatives>
      <tex-math><![CDATA[\label{eq:eq2}
      {Pr[X > x] = 1 - F_x(x) = 1 - Pr[X {\leq} x].}]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>X</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>X</mml:mi><mml:mo>≤</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></named-content>
      In R, assuming an exponential distribution, this can be evaluated
      through the following expressions:
      <monospace>1 - pexp(q, rate)</monospace> or
      <monospace>pexp(q, rate, lower.tail = FALSE)</monospace>.</p>
    </list-item>
  </list>
  <p>Other related R packages include <monospace>pixelate</monospace>
  and <monospace>biscale</monospace>. The
  <monospace>pixelate</monospace> package explores the use of pixelation
  for uncertainty visualisation on isopleth maps
  (<xref alt="Taylor et al., 2020" rid="ref-pixelatePackage" ref-type="bibr">Taylor
  et al., 2020</xref>), and the <monospace>biscale</monospace> package
  can be used to generate bivariate maps for two variables
  (<xref alt="Prener et al., 2020" rid="ref-biscalePackage" ref-type="bibr">Prener
  et al., 2020</xref>).</p>
  <p>A comprehensive vignette that demonstrates how to use
  <monospace>Vizumap</monospace> is available after package
  installation. The functions are divided into three categories:
  formatting, building, and viewing. Formatting functions prepare data
  for use in the building functions, which are used to build the colour
  palettes, maps, and map keys. Viewing functions are used to check and
  combine the different graphical objects designed with the building
  functions. Previous applications of the <monospace>Vizumap</monospace>
  R package include visualising American Community Survey estimates with
  their corresponding margins of error. We believe
  <monospace>Vizumap</monospace> is useful in a wide range of
  applications, and we will continue to improve the toolkit to enhance
  its utility.</p>
  <p>As an illustration below, we use <monospace>Vizumap</monospace> to
  visualise estimated pollutant loads of sediment from the upper
  Burdekin catchment in Queensland, Australia, into the Great Barrier
  Reef (GBR). The predictions and uncertainties, published in Kuhnert et
  al. (<xref alt="2018" rid="ref-gbrData" ref-type="bibr">2018</xref>),
  were developed from a Bayesian Hierarchical Model (BHM) that
  assimilated estimates of sediment concentration and flow with modelled
  output from a catchment model developed on the upper Burdekin
  catchment. Development of this modelling strategy is discussed in
  Gladish et al.
  (<xref alt="2016" rid="ref-gbrMethod" ref-type="bibr">2016</xref>).
  Here we just focus on total suspended sediment (TSS). The export of
  pollutants from coastal catchments within Australia has important
  implications for the health of the GBR lagoon, and
  <monospace>Vizumap</monospace> offers a variety of methods for
  communicating these predictions and uncertainties to catchment
  managers and policy makers.</p>
  <sec id="bivariate-map">
    <title>Bivariate map</title>
    <p>Figure <xref alt="1" rid="bivMap">1</xref> is a bivariate map of
    the upper Burdekin catchment in Queensland, Australia. It visualises
    predicted total suspended sediment (TSS) concentrations and
    prediction uncertainty. In this example, a custom colour palette is
    created and then used to build the bivariate map and colour key. The
    bivariate bins are defined using terciles.</p>
    <fig>
      <caption><p>Bivariate map and bivariate key for the upper Burdekin
      catchment in Queensland, Australia, showing the total suspended
      sediment (TSS) concentration in
      mg/L.<styled-content id="bivMap"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="bivariateMap.png" xlink:title="" />
    </fig>
  </sec>
  <sec id="pixel-map">
    <title>Pixel map</title>
    <p>Figure <xref alt="2" rid="pixMap">2</xref> visualises the
    uncertainty of TSS predictions, while giving a general idea of
    estimated TSS concentrations. For a closer look at the pixelation, a
    subset of regions is included to the right of the map (Figure
    <xref alt="2" rid="pixMap">2</xref>(B)). The colours filling the
    pixels in each region were sampled from the estimate’s relative
    frequency distribution. This pixel map can be animated so that the
    pixels flicker between sampled values. If the map below were to be
    animated, the areas that appear most pixelated in the static map
    would, correspondingly, have the most visible movement among pixels
    in the animated map. Movement among pixels in areas of low
    uncertainty would be hard to detect due to the minimal differences
    between the sampled values of orange. An example of an animated
    pixel map can be found in Lucchesi &amp; Wikle
    (<xref alt="2017" rid="ref-vizMethod" ref-type="bibr">2017</xref>).</p>
    <fig>
      <caption><p>Pixel map showing the TSS concentrations for the upper
      Burdekin catchment in Queensland, Australia. Figure
      <xref alt="2" rid="pixMap">2</xref>(B) provides a closer look at
      the pixelation in five regions from Figure
      <xref alt="2" rid="pixMap">2</xref>(A).
      <styled-content id="pixMap"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="pixelMap.png" xlink:title="" />
    </fig>
  </sec>
  <sec id="glyph-map">
    <title>Glyph map</title>
    <p>Figure <xref alt="3" rid="glyphMap">3</xref> depicts estimated
    TSS concentrations and the uncertainty of these predictions. The
    colour filling each glyph (located at the region centroid)
    represents the estimate, and the rotation of the glyph represents
    the uncertainty.</p>
    <fig>
      <caption><p>Glyph map and glyph key showing the TSS predictions
      and uncertainties for the upper Burdekin catchment in Queensland,
      Australia.<styled-content id="glyphMap"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="glyphMap.png" xlink:title="" />
    </fig>
  </sec>
  <sec id="exceedance-probability-map">
    <title>Exceedance probability map</title>
    <p>In Figure <xref alt="4" rid="exceedMap">4</xref>, the calculated
    probability of exceeding a sediment concentration greater than 837
    mg/L (a threshold of concern discussed in Kuhnert et al.
    (<xref alt="2018" rid="ref-gbrData" ref-type="bibr">2018</xref>)) is
    plotted in order to draw attention to the high-risk regions on the
    map. These probabilities were calculated from the posterior
    distributions of a BHM as outlined in Kuhnert et al.
    (<xref alt="2018" rid="ref-gbrData" ref-type="bibr">2018</xref>).</p>
    <fig>
      <caption><p>Exceedance probability map showing the probability of
      exceeding the nominated guideline of 837 mg/L for TSS in the upper
      Burdekin catchment in Queensland,
      Australia.<styled-content id="exceedMap"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="exceedMap.png" xlink:title="" />
    </fig>
  </sec>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We would like to acknowledge the support and funding from the CSIRO
  Digiscape Future Science Platform for the second author.</p>
  <p><monospace>Vizumap</monospace> was built using the following R
  packages: <monospace>ggplot2</monospace>,
  <monospace>animation</monospace>, <monospace>broom</monospace>,
  <monospace>dplyr</monospace>, <monospace>geoaxe</monospace>,
  <monospace>ggmap</monospace>, <monospace>grDevices</monospace>,
  <monospace>gridExtra</monospace>, <monospace>maps</monospace>,
  <monospace>maptools</monospace>, <monospace>plyr</monospace>,
  <monospace>reshape2</monospace>, <monospace>rgdal</monospace>,
  <monospace>rgeos</monospace>, <monospace>roxygen2</monospace>,
  <monospace>sp</monospace>, <monospace>spbabel</monospace>,
  <monospace>testthat</monospace>, <monospace>usethis</monospace>, and
  <monospace>utils</monospace>.</p>
</sec>
</body>
<back>
<ref-list>
  <ref-list>
    <ref id="ref-vizMethod">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Lucchesi</surname><given-names>Lydia R.</given-names></name>
          <name><surname>Wikle</surname><given-names>Christopher K.</given-names></name>
        </person-group>
        <article-title>Visualizing uncertainty in areal data with bivariate choropleth maps, map pixelation and glyph rotation</article-title>
        <source>Stat</source>
        <year iso-8601-date="2017">2017</year>
        <volume>6</volume>
        <issue>1</issue>
        <pub-id pub-id-type="doi">10.1002/sta4.150</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-gbrData">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Kuhnert</surname><given-names>PM</given-names></name>
          <name><surname>Pagendam</surname><given-names>DE</given-names></name>
          <name><surname>Bartley</surname><given-names>R</given-names></name>
          <name><surname>Gladish</surname><given-names>DW</given-names></name>
          <name><surname>Lewis</surname><given-names>SE</given-names></name>
          <name><surname>Bainbridge</surname><given-names>ZT</given-names></name>
        </person-group>
        <article-title>Making management decisions in the face of uncertainty: A case study using the burdekin catchment in the great barrier reef</article-title>
        <source>Marine and Freshwater Research</source>
        <publisher-name>CSIRO</publisher-name>
        <year iso-8601-date="2018">2018</year>
        <volume>69</volume>
        <issue>8</issue>
        <pub-id pub-id-type="doi">10.1071/MF17237</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-gbrMethod">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Gladish</surname><given-names>Daniel W.</given-names></name>
          <name><surname>Kuhnert</surname><given-names>Petra M.</given-names></name>
          <name><surname>Pagendam</surname><given-names>Daniel E.</given-names></name>
          <name><surname>Wikle</surname><given-names>Christopher K.</given-names></name>
          <name><surname>Bartley</surname><given-names>Rebecca</given-names></name>
          <name><surname>Searle</surname><given-names>Ross D.</given-names></name>
          <name><surname>Ellis</surname><given-names>Robin J.</given-names></name>
          <name><surname>Dougall</surname><given-names>Cameron</given-names></name>
          <name><surname>Turner</surname><given-names>Ryan D. R.</given-names></name>
          <name><surname>Lewis</surname><given-names>Stephen E.</given-names></name>
          <name><surname>Bainbridge</surname><given-names>Zoë T.</given-names></name>
          <name><surname>Brodie</surname><given-names>Jon E.</given-names></name>
        </person-group>
        <article-title>Spatio-temporal assimilation of modelled catchment loads with monitoring data in the great barrier reef</article-title>
        <source>The Annals of Applied Statistics</source>
        <publisher-name>Institute of Mathematical Statistics</publisher-name>
        <year iso-8601-date="2016">2016</year>
        <volume>10</volume>
        <issue>3</issue>
        <pub-id pub-id-type="doi">10.1214/16-AOAS950</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-biscalePackage">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name><surname>Prener</surname><given-names>Christopher</given-names></name>
          <name><surname>Grossenbacher</surname><given-names>Timo</given-names></name>
          <name><surname>Zehr</surname><given-names>Angelo</given-names></name>
        </person-group>
        <source>Biscale: Tools and palettes for bivariate thematic mapping</source>
        <year iso-8601-date="2020">2020</year>
        <uri>https://CRAN.R-project.org/package=biscale</uri>
      </element-citation>
    </ref>
    <ref id="ref-pixelatePackage">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name><surname>Taylor</surname><given-names>Aimee R</given-names></name>
          <name><surname>Watson</surname><given-names>James A</given-names></name>
          <name><surname>Buckee</surname><given-names>Caroline O</given-names></name>
        </person-group>
        <source>Pixelate: Pixelate spatial predictions as per their average uncertainty</source>
        <year iso-8601-date="2020">2020</year>
        <uri>https://github.com/artaylor85/pixelate</uri>
      </element-citation>
    </ref>
  </ref-list>
</ref-list>
</back>
</article>
