<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">2474</article-id>
<article-id pub-id-type="doi">10.21105/joss.02474</article-id>
<title-group>
<article-title>DetectorChecker: analyzing patterns of defects in
detector screens</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0003-1763-466X</contrib-id>
<string-name>Julia A. Brettschneider</string-name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<string-name>Oscar T. Giles</string-name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0001-9799-3480</contrib-id>
<string-name>Wilfrid S. Kendall</string-name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<string-name>Tomas Lazauskas</string-name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Statistics, University of Warwick, Coventry,
United Kingdom</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>The Alan Turing Institute, London, United
Kingdom</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2020-06-30">
<day>30</day>
<month>6</month>
<year>2020</year>
</pub-date>
<volume>5</volume>
<issue>56</issue>
<fpage>2474</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2021</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>XCT</kwd>
<kwd>bad pixel map</kwd>
<kwd>defective pixels</kwd>
<kwd>spatial statistics</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<p><ext-link ext-link-type="uri" xlink:href="https://github.com/alan-turing-institute/DetectorChecker"><italic>DetectorChecker</italic></ext-link>
refers to an R package and an associated web application environment
<ext-link ext-link-type="uri" xlink:href="https://github.com/alan-turing-institute/DetectorCheckerWebApp"><italic>DetectorCheckerWebApp</italic></ext-link>,
intended to help users who need to analyze spatial patterns of defects
in images. These images can be <italic>panel-structured</italic>, which
is to say, composed of sub-panels arranged in an architecture which the
user can specify in the package or in the web application. Primary
beneficiaries are intended to be individuals responsible for high-value
digital detector screens used in X-ray computerised tomography (XCT),
where defects arise due to high radiation flux. More generally the
software can be used to analyse defects in other panel-structured
arrays, for example solar panels or very large display screens. To
maximize accessibility, and to avoid any issues arising from specific
software environments, we have created a web application which provides
the principal features of the software in standalone form. The web
application also affords the possibility of engaging with our team in
the analysis of time-evolving defect patterns. To the best of our
knowledge, this is the first and presently the only web application and
R package facilitating spatial analysis of panel-structured images.</p>
<p>Digital detector screens are crucial high-value components of imaging
systems used throughout modern science, medicine, and engineering
systems, particularly in XCT. The US FDA
(<xref alt="2018" rid="ref-FDA" ref-type="bibr">2018</xref>) provides
information for industry on X-ray imaging devices and lists some common
laboratory tests for evaluation of general-use X-ray imaging devices. It
also notes the applicable standard for each modality, thus forming the
basis for a maintenance schedule. Additionally a scheduled testing
framework has been proposed by the Institute of Physics and Engineering
in Medicine
(<xref alt="IPEM, 2019" rid="ref-IPEM2" ref-type="bibr">IPEM,
2019</xref>). In September 2019 the UK National Health Service (NHS)
announced a major investment of £200m to overcome outdated equipment,
noting that a significant proportion of CT, MRI and general X-ray
equipment more than 10 years old
(<xref alt="NHS, 2019" rid="ref-UK-NHS" ref-type="bibr">NHS,
2019</xref>). Thus XCT system quality concerns are very topical.</p>
<p>Yaffe and Rowlands
(<xref alt="1997" rid="ref-YaffeRowlands-1997" ref-type="bibr">1997</xref>,
especially section 3.8) point out that XCT screen quality is linked to
system performance.
<ext-link ext-link-type="uri" xlink:href="https://github.com/alan-turing-institute/DetectorChecker"><italic>DetectorChecker</italic></ext-link>
facilitates the inclusion of screen pixel assessment in a testing
framework. Note that screen replacement or refurbishment is expensive;
regular checks of screen pixels are needed (a) to quantify screen
quality and (b) to assess possible <italic>special causes</italic> of
defective pixels, using Shewhart’s
(<xref alt="1986" rid="ref-Shewhart-1939" ref-type="bibr">1986</xref>)
terminology from classic quality control. This is best done using
spatial statistics, both in order to determine the extent to which
spatial patterns of defective pixels can be accounted for by
quantifiable independent random variation and also by describing
departures from spatial randomness in ways which are suggestive of
possible explanations (for example, stress due to screen attachment, or
failure at pixel level of data readout). Theoretical spatial statistics
methodology is crucial: foundations are discussed in Chiu et al.
(<xref alt="2013" rid="ref-ChiuStoyanKendallMecke-2013" ref-type="bibr">2013</xref>)
while Baddeley et al.
(<xref alt="2015" rid="ref-BaddeleyRubakTurner-2015" ref-type="bibr">2015</xref>)
describe the
<ext-link ext-link-type="uri" xlink:href="https://spatstat.org/"><italic>spatstat</italic></ext-link>
package, an implementation of spatial statistics methods in the R
statistical computing environment
(<xref alt="R Core Team, 2019" rid="ref-RFoundation-2019" ref-type="bibr">R
Core Team, 2019</xref>).
<ext-link ext-link-type="uri" xlink:href="https://github.com/alan-turing-institute/DetectorChecker"><italic>DetectorChecker</italic></ext-link>
(<xref alt="Lazauskas et al., 2020a" rid="ref-tomas_lazauskas_2020_3662233" ref-type="bibr">Lazauskas
et al., 2020a</xref>) is an R package which adapts methods from
<ext-link ext-link-type="uri" xlink:href="https://spatstat.org/"><italic>spatstat</italic></ext-link>
to the case of panel-structured images, and analyses point patterns
arising either from individual defects or from “clumps” of defects
(determined in a manner specified by the user). The associated
<ext-link ext-link-type="uri" xlink:href="https://detectorchecker.azurewebsites.net/">web
application</ext-link>
(<xref alt="Lazauskas et al., 2020b" rid="ref-tomas_lazauskas_2020_3662235" ref-type="bibr">Lazauskas
et al., 2020b</xref>) is based on a self-contained R environment
<ext-link ext-link-type="uri" xlink:href="https://github.com/alan-turing-institute/DetectorCheckerWebApp"><italic>DetectorCheckerWebApp</italic></ext-link>
together with a
<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/shiny/index.html"><italic>Shiny</italic></ext-link>(<xref alt="Chang et al., 2020" rid="ref-shiny" ref-type="bibr">Chang
et al., 2020</xref>) gui, implemented and made available
<italic>via</italic> <italic>Azure</italic> at
<ext-link ext-link-type="uri" xlink:href="https://detectorchecker.azurewebsites.net/">https://detectorchecker.azurewebsites.net/</ext-link>.
The web application exposes the basic functionality of the
<ext-link ext-link-type="uri" xlink:href="https://github.com/alan-turing-institute/DetectorChecker"><italic>DetectorChecker</italic></ext-link>
package without the need for users to install R. In particular the web
application can be used to define the geometry of the sub-panels of the
detector screen (which is to say, the arrangement and size of the
component sub-panels), to upload the spatial arrangement of the
defective pixels (either directly by means of “bad pixel maps” in XML
format or inferred from test images in formats including TIFF), and then
to inspect the results using the facilities offered by the package. The
software is freely available under MIT licence, accessible
<italic>via</italic> the Github repositories in the above references. To
the best of our knowledge, there is no comparable package or web
application making methods of spatial statistics available for
panel-structured image data of arbitrary structure architecture.</p>
<p>Defects are modelled as points in an image rectangle based on overall
screen dimensions. The pattern of defects can be modelled using the web
application (workflow is summarised in Figure
<xref alt="[fig:figure1]" rid="figU003Afigure1">[fig:figure1]</xref>).</p>
<fig id="figU003Afigure1">
  <caption><p>Work flow for DetectorChecker web application.
  Feedback/skip paths illustrate various options: refocussing attention
  on subsets of the point pattern (isolated pixels, small clusters,
  linear clusters, ); working through various graphical analyses;
  optionally emailing data to the DetectorChecker team; and
  statistically fitting a variety of models of damage
  intensity.</p></caption>
  <graphic mimetype="application" mime-subtype="pdf" xlink:href="image/flowchartDCshort.pdf" xlink:title="" />
</fig>
<p>We now discuss selected steps of the workflow using data derived from
a Pilatus detector screen and supplied to us by Diamond Lightsource,
UK.</p>
<p>A. The user specifies the exact architecture of the sub-panels of the
panel-structured image. This can be done either by using a drop-down
menu to specify a predetermined option, or by uploading a file giving
the specific structure of sub-panels. The data can then be uploaded.</p>
<p>B. Intensity maps can be produced <italic>via</italic> kernel
smoothing applied to the point pattern (replacing each defect point by
the corresponding translate of a fixed kernel function and then
summing). For example, the point pattern in Figure
<xref alt="[fig:figure2]" rid="figU003Afigure2">[fig:figure2]</xref>(a)
yields the intensity map given in Figure
<xref alt="[fig:figure2]" rid="figU003Afigure2">[fig:figure2]</xref>(b).</p>
<fig id="figU003Afigure2">
    <label>Figure 2</label>
    <caption>
<p>Pilatus detector screen: (a) Example of point pattern of defects. (b)
Intensity map resulting from point pattern of defects. The intensity map
draws attention to the higher intensity of defects in the corners, which
is born out by inspection of the point pattern.</p>
    </caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="image/fig2-a.pdf" />
    <graphic mimetype="image" mime-subtype="png" xlink:href="image/fig2-b-trim.png" />
</fig>
<p>C. Measuring possible departures from <italic>complete spatial
randomness</italic> (CSR). CSR is what would be expected if the point
pattern was in fact generated by a homogeneous Poisson point process of
constant intensity <inline-formula><alternatives>
<tex-math><![CDATA[\lambda]]></tex-math>
<mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>,
can be assessed using visual inspection of graphs of empirical estimates
of <inline-formula><alternatives>
<tex-math><![CDATA[F]]></tex-math>
<mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>F</mml:mi></mml:math></alternatives></inline-formula>,
<inline-formula><alternatives>
<tex-math><![CDATA[G]]></tex-math>
<mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>G</mml:mi></mml:math></alternatives></inline-formula>
and <inline-formula><alternatives>
<tex-math><![CDATA[K]]></tex-math>
<mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>K</mml:mi></mml:math></alternatives></inline-formula>
functions as described in Chiu et al.
(<xref alt="2013" rid="ref-ChiuStoyanKendallMecke-2013" ref-type="bibr">2013</xref>).
It is clear that the point pattern of Figure
<xref alt="[fig:figure2]" rid="figU003Afigure2">[fig:figure2]</xref>(a)
is strongly inhomogeneous and therefore it is not surprising that the
corresponding graphical plots indicate clear evidence of deviation from
CSR:</p>
<list list-type="bullet">
  <list-item>
    <p>The <inline-formula><alternatives>
    <tex-math><![CDATA[F]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>F</mml:mi></mml:math></alternatives></inline-formula>
    function or “empty space function” computes the distribution of the
    nearest distance to a defect point from a typical location chosen
    from the image rectangle uniformly at random (and independently of
    the point pattern). If the point pattern did in fact satisfy CSR
    then one could consider an empirical estimate of the
    <inline-formula><alternatives>
    <tex-math><![CDATA[F]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>F</mml:mi></mml:math></alternatives></inline-formula>
    function to be a random perturbation of the theoretical
    <inline-formula><alternatives>
    <tex-math><![CDATA[F]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>F</mml:mi></mml:math></alternatives></inline-formula>
    function under CSR, namely <inline-formula><alternatives>
    <tex-math><![CDATA[F_\text{pois}(r)=1-\exp(-\lambda \pi r^2)]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mtext mathvariant="normal">pois</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mi>π</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
    Figure
    <xref alt="[fig:figure3]" rid="figU003Afigure3">[fig:figure3]</xref>(a)
    graphs different variants of <inline-formula><alternatives>
    <tex-math><![CDATA[\hat{F}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mover><mml:mi>F</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula>,
    accounting in various ways for edge-effects. Note the clear
    deviation of the <inline-formula><alternatives>
    <tex-math><![CDATA[\hat{F}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mover><mml:mi>F</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
    empirical estimates from what would be expected under CSR, namely
    the theoretical <inline-formula><alternatives>
    <tex-math><![CDATA[F_\text{pois}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>F</mml:mi><mml:mtext mathvariant="normal">pois</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>.</p>
  </list-item>
  <list-item>
    <p>The <inline-formula><alternatives>
    <tex-math><![CDATA[G]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>G</mml:mi></mml:math></alternatives></inline-formula>
    function computes the distribution of nearest-neighbour distances
    between defect points; if the point pattern did in fact satisfy CSR
    then one could view an empirical estimate of the
    <inline-formula><alternatives>
    <tex-math><![CDATA[G]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>G</mml:mi></mml:math></alternatives></inline-formula>
    function as a random perturbation of the theoretical
    <inline-formula><alternatives>
    <tex-math><![CDATA[G]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>G</mml:mi></mml:math></alternatives></inline-formula>
    function under CSR, namely (by a conditional probability argument)
    <inline-formula><alternatives>
    <tex-math><![CDATA[G_\text{pois}(r)=1-\exp(-\lambda \pi r^2)]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mtext mathvariant="normal">pois</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mi>π</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    (actually equal to <inline-formula><alternatives>
    <tex-math><![CDATA[F_\text{pois}(r)]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mtext mathvariant="normal">pois</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>).
    See Figure
    <xref alt="[fig:figure3]" rid="figU003Afigure3">[fig:figure3]</xref>(b),
    and note the clear deviation from the theoretical
    <inline-formula><alternatives>
    <tex-math><![CDATA[G_\text{pois}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>G</mml:mi><mml:mtext mathvariant="normal">pois</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>
    of the <inline-formula><alternatives>
    <tex-math><![CDATA[\hat{G}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mover><mml:mi>G</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
    empirical estimates (which again account in various ways for
    edge-effects), hence again suggesting deviation from CSR.</p>
  </list-item>
</list>
<fig id="figU003Afigure3">
    <label>Figure 3</label>
    <caption>
<p>Pilatus detector screen: (a) <inline-formula><alternatives>
<tex-math><![CDATA[F]]></tex-math>
<mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>F</mml:mi></mml:math></alternatives></inline-formula>
plot resulting from point pattern of defects. (b)
<inline-formula><alternatives>
<tex-math><![CDATA[G]]></tex-math>
<mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>G</mml:mi></mml:math></alternatives></inline-formula>
plot resulting from point pattern of defects. The graphs contrast the
theoretical curve arising from CSR (blue dotted curve) with several
empirical curves involving different edge corrections. The different
edge-corrected empirical curves agree with each other but indicate clear
divergence from the CSR curve. Here and in the following figures the
graphs correspond to output from the application: graph axes have not
been harmonized.</p>
    </caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="image/fig3-a.pdf" />
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="image/fig3-b.pdf" />
</fig>
<list list-type="bullet">
  <list-item>
    <p>The <inline-formula><alternatives>
    <tex-math><![CDATA[K]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>K</mml:mi></mml:math></alternatives></inline-formula>
    function (Ripley’s <inline-formula><alternatives>
    <tex-math><![CDATA[K]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>K</mml:mi></mml:math></alternatives></inline-formula>
    function) computes the mean number of defect points within a
    distance <inline-formula><alternatives>
    <tex-math><![CDATA[r]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>r</mml:mi></mml:math></alternatives></inline-formula>
    of a typical defect point, viewed as a function of
    <inline-formula><alternatives>
    <tex-math><![CDATA[r]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>r</mml:mi></mml:math></alternatives></inline-formula>;
    if the point pattern did in fact satisfy CSR then one could view an
    empirical estimate of the <inline-formula><alternatives>
    <tex-math><![CDATA[K]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>K</mml:mi></mml:math></alternatives></inline-formula>
    function as a random perturbation of the theoretical
    <inline-formula><alternatives>
    <tex-math><![CDATA[K]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>K</mml:mi></mml:math></alternatives></inline-formula>
    function under CSR, namely <inline-formula><alternatives>
    <tex-math><![CDATA[K_\text{pois}(r)=\pi r^2]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mtext mathvariant="normal">pois</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>π</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.
    See Figure
    <xref alt="[fig:figure4]" rid="figU003Afigure4">[fig:figure4]</xref>(a),
    and note the deviation from <inline-formula><alternatives>
    <tex-math><![CDATA[K_\text{pois}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>K</mml:mi><mml:mtext mathvariant="normal">pois</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>
    of the <inline-formula><alternatives>
    <tex-math><![CDATA[\hat{K}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mover><mml:mi>K</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
    empirical estimates (once more accounting for edge-effects in
    different ways), especially at short distances, once more suggesting
    deviation from CSR. Note that for geometrical reasons the
    <inline-formula><alternatives>
    <tex-math><![CDATA[\hat{K}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mover><mml:mi>K</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
    empirical estimates will exhibit substantially greater variation at
    large distances; it is therefore appropriate to confine attention to
    the left-hand third of the <inline-formula><alternatives>
    <tex-math><![CDATA[x]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>-axis.
    The excess over the theoretical <inline-formula><alternatives>
    <tex-math><![CDATA[K_\text{pois}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>K</mml:mi><mml:mtext mathvariant="normal">pois</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>
    at short distances, particularly for the estimate
    <inline-formula><alternatives>
    <tex-math><![CDATA[\hat{K}_\text{iso}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mover><mml:mi>K</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mtext mathvariant="normal">iso</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>,
    indicates that defects are more clustered than would be expected
    from CSR.</p>
  </list-item>
</list>
<fig id="figU003Afigure4">
    <label>Figure 4</label>
    <caption>
        <p>
            Pilatus detector screen: (a) <italic>K</italic> plot resulting
            from point pattern of defects. (b) <italic>K</italic> plot
            resulting from point pattern of defects, corrected for
            inhomogeneity. For geometrical reasons it is appropriate to focus
            attention on small distances. There is more variation between
            different edge-corrections of empirical curves than for
            <italic>F</italic> and <italic>G</italic> curves. Empirical curves
            are closer at short distances (200 pixels or less) to the
            theoretical curve based on CSR (left panel, blue dotted curve) but
            still exhibit some discrepancy hinting at possibly greater
            clustering relative to CSR. However all curves agree closely for
            short distances in the right panel, in which a correction has been
            made for inhomogeneity (which has already been noted when
            considering the intensity map). This suggests that an
            inhomogeneous Poisson process provides a good fit for the data.
        </p>
    </caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="image/fig4-a.pdf" />
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="image/fig4-b.pdf" />
</fig>
<list list-type="bullet">
  <list-item>
    <p>Plots are also available which take account of inhomogeneity and
    compare these estimates to theoretical functions computed for
    inhomogeneous Poisson point processes: Figure
    <xref alt="[fig:figure4]" rid="figU003Afigure4">[fig:figure4]</xref>(b)
    gives an example of this in the case of the
    <inline-formula><alternatives>
    <tex-math><![CDATA[K]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>K</mml:mi></mml:math></alternatives></inline-formula>
    function. The plots of the <inline-formula><alternatives>
    <tex-math><![CDATA[\hat{K}_\text{inhom}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mover><mml:mi>K</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mtext mathvariant="normal">inhom</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>
    empirical inhomogeneity-adjusted estimates agree much more closely
    with the theoretical <inline-formula><alternatives>
    <tex-math><![CDATA[K^\text{pois}_\text{inhom}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>K</mml:mi><mml:mtext mathvariant="normal">inhom</mml:mtext><mml:mtext mathvariant="normal">pois</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>
    function at short distances, supporting the hypothesis that the
    pattern of defects is what might be expected to arise from an
    <italic>inhomogeneous</italic> Poisson process of defects.</p>
  </list-item>
</list>
<p>D. Finally the relationship of the defect points to sub-panel
boundaries can be studied by means of various logistic regression
options, which assess whether damage intensity appears to depend on
distance from the centre of the image or horizontal or vertical distance
from sub-panel edges. When this data set is modelled in terms of
Euclidean distance from the centre, the web application reports
substantial evidence for positive dependence of defect intensity on
distance from the centre (see the highly significant coefficient for
<monospace>as.vector(dist)</monospace> in the following web application
output), conforming with the visual impression given by Figure
<xref alt="[fig:figure2]" rid="figU003Afigure2">[fig:figure2]</xref>(a),
and further explaining the nature of the spatial inhomogeneity indicated
by Figure
<xref alt="[fig:figure4]" rid="figU003Afigure4">[fig:figure4]</xref>. In
fact this positive dependence reflects manufacturing details of this
particular screen design: Diamond reports that Pilatus detector screen
panels are tested before installation, and better panels are placed in
the centre of the structured display.</p>
<p>Here follows output from the web application after performing the
above logistic regression:</p>
<preformat>Call:
glm(formula = as.vector(pix_matrix) ~ as.vector(dist),
family = binomial(link = logit))

Deviance Residuals:
    Min       1Q   Median       3Q      Max
-0.0262  -0.0211  -0.0193  -0.0171   4.3297  

Coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)     -9.392e+00  9.628e-02 -97.545   &lt;2e-16 ***
as.vector(dist)  8.021e-04  8.726e-05   9.192   &lt;2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 22261  on 6224000  degrees of freedom
Residual deviance: 22173  on 6223999  degrees of freedom
AIC: 22177

Number of Fisher Scoring iterations: 11</preformat>
<p>The web application also provides for further graphical options, such
as the study of direction from a typical defect point to its nearest
neighbour within the relevant sub-panel, analysis at the level of
“events” (appropriately defined grouping of clumps of defect pixels)
rather than individual defect points, and exclusion of regions of the
image rectangle for which the defect intensity is clearly different
(this often arises in XCT, where corners of the image exhibit high
defect intensity, presumably deriving from mechanical stress due to
supports of the screen).</p>
<p>An extended example of use of the R package, paralleled by
corresponding use of the web application, is available as a vignette in
the Github repository
<ext-link ext-link-type="uri" xlink:href="https://github.com/alan-turing-institute/DetectorChecker"><italic>DetectorChecker</italic></ext-link>.</p>
<p>The R package and web application together offer significant
opportunities to address interesting and important challenges for the
data analysis of defective pixel patterns. The web application offers
the possibility of uploading users’ data to a data repository, thus
permitting the possibility of organizing cooperative statistical
investigations comparing patterns across different machines and
different modes of usage. In particular we envisage its use to collect
time sequences of images, to permit statistical investigation by the
Warwick team of deterioration over time, using latent Markov models of
the life and death of defective pixels which are currently being
developed. Such analysis requires sustained and regular monitoring of a
diversity of screens from various devices, together with recording of
relevant metadata such as detector usage. Interested users are
encouraged to make contact to discuss these possibilities, which will
permit evidence-based analysis to support decisions on refurbishment
and/or replacement strategies.</p>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We gratefully acknowledge support from the UK EPSRC (grant
  EP/K031066/1) and the Alan Turing Institute (under the EPSRC grant
  EP/N510129/1) during this project.</p>
  <p>We also wish to thank Martin O’Reilly (The Alan Turing Institute),
  Nicola Tartoni and Ian Horswell (Diamond Lightsource, UK) for guidance
  on detector types and sample data sets, and Tristan Lowe (Henry
  Moseley X-ray Imaging Facility, University of Manchester) and Martin
  Turner (ITS Research IT, University of Manchester) for discussions and
  feedback.</p>
</sec>
</body>
<back>
<ref-list>
  <ref-list>
    <ref id="ref-FDA">
      <element-citation>
        <person-group person-group-type="author">
          <name><surname>FDA</surname></name>
        </person-group>
        <article-title>Information for industry: X-ray imaging devices</article-title>
        <year iso-8601-date="2018">2018</year>
        <uri>https://www.fda.gov/radiation-emitting-products/medical-x-ray-imaging/information-industry-x-ray-imaging-devices</uri>
      </element-citation>
    </ref>
    <ref id="ref-IPEM2">
      <element-citation>
        <person-group person-group-type="author">
          <name><surname>IPEM</surname></name>
        </person-group>
        <article-title>Quality assurance</article-title>
        <year iso-8601-date="2019">2019</year>
        <uri>https://www.radiologycafe.com/radiology-trainees/frcr-physics-notes/quality-assurance</uri>
      </element-citation>
    </ref>
    <ref id="ref-UK-NHS">
      <element-citation>
        <person-group person-group-type="author">
          <name><surname>NHS</surname></name>
        </person-group>
        <article-title>Transforming imaging services in england: A national strategy for imaging networks</article-title>
        <year iso-8601-date="2019">2019</year>
        <uri>https://improvement.nhs.uk/documents/6119/Transforming_imaging_services.pdf</uri>
      </element-citation>
    </ref>
    <ref id="ref-YaffeRowlands-1997">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Yaffe</surname><given-names>M. J.</given-names></name>
          <name><surname>Rowlands</surname><given-names>J. A.</given-names></name>
        </person-group>
        <article-title>X-ray detectors for digital radiography</article-title>
        <source>Physics in Medicine and Biology</source>
        <publisher-name>IOP Publishing</publisher-name>
        <year iso-8601-date="1997-01">1997</year><month>01</month>
        <volume>42</volume>
        <issue>1</issue>
        <pub-id pub-id-type="doi">10.1088/0031-9155/42/1/001</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-Shewhart-1939">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name><surname>Shewhart</surname><given-names>W. A.</given-names></name>
        </person-group>
        <source>Statistical method from the viewpoint of quality control</source>
        <publisher-name>Dover Publications, Inc., New York</publisher-name>
        <year iso-8601-date="1986">1986</year>
        <isbn>0-486-65232-7</isbn>
        <uri>https://store.doverpublications.com/0486652327.html</uri>
      </element-citation>
    </ref>
    <ref id="ref-ChiuStoyanKendallMecke-2013">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name><surname>Chiu</surname><given-names>S. N.</given-names></name>
          <name><surname>Stoyan</surname><given-names>D.</given-names></name>
          <name><surname>Kendall</surname><given-names>W. S.</given-names></name>
          <name><surname>Mecke</surname><given-names>J.</given-names></name>
        </person-group>
        <source>Stochastic Geometry and Its Applications</source>
        <publisher-name>John Wiley; Sons</publisher-name>
        <year iso-8601-date="2013-06">2013</year><month>06</month>
        <isbn>9781118658253</isbn>
        <pub-id pub-id-type="doi">10.1002/9781118658222</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-BaddeleyRubakTurner-2015">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name><surname>Baddeley</surname><given-names>A.</given-names></name>
          <name><surname>Rubak</surname><given-names>E.</given-names></name>
          <name><surname>Turner</surname><given-names>R.</given-names></name>
        </person-group>
        <source>Spatial point patterns: Methodology and applications with R</source>
        <publisher-name>Chapman; Hall/CRC</publisher-name>
        <publisher-loc>London</publisher-loc>
        <year iso-8601-date="2015">2015</year>
        <pub-id pub-id-type="doi">10.1002/bimj.201600178</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-RFoundation-2019">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <string-name>R Core Team</string-name>
        </person-group>
        <source>R: A language and environment for statistical computing</source>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
        <publisher-loc>Vienna, Austria</publisher-loc>
        <year iso-8601-date="2019">2019</year>
        <uri>https://www.R-project.org</uri>
      </element-citation>
    </ref>
    <ref id="ref-tomas_lazauskas_2020_3662233">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name><surname>Lazauskas</surname><given-names>T.</given-names></name>
          <name><surname>Giles</surname><given-names>O T</given-names></name>
          <name><surname>Kendall</surname><given-names>W. S.</given-names></name>
          <name><surname>Brettschneider</surname><given-names>J. A.</given-names></name>
        </person-group>
        <source>https://github.com/alan-turing-institute/DetectorChecker</source>
        <year iso-8601-date="2020-02">2020</year><month>02</month>
      </element-citation>
    </ref>
    <ref id="ref-shiny">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name><surname>Chang</surname><given-names>Winston</given-names></name>
          <name><surname>Cheng</surname><given-names>Joe</given-names></name>
          <name><surname>Allaire</surname><given-names>JJ</given-names></name>
          <name><surname>Xie</surname><given-names>Yihui</given-names></name>
          <name><surname>McPherson</surname><given-names>Jonathan</given-names></name>
        </person-group>
        <source>Shiny: Web application framework for r</source>
        <year iso-8601-date="2020">2020</year>
        <uri>https://CRAN.R-project.org/package=shiny</uri>
      </element-citation>
    </ref>
    <ref id="ref-tomas_lazauskas_2020_3662235">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name><surname>Lazauskas</surname><given-names>T.</given-names></name>
          <name><surname>Giles</surname><given-names>O. T.</given-names></name>
          <name><surname>Kendall</surname><given-names>W. S.</given-names></name>
          <name><surname>Brettschneider</surname><given-names>J. A.</given-names></name>
        </person-group>
        <source>https://github.com/alan-turing-institute/DetectorCheckerWebApp</source>
        <year iso-8601-date="2020-02">2020</year><month>02</month>
      </element-citation>
    </ref>
  </ref-list>
</ref-list>
</back>
</article>
